(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    328524,       8661]
NotebookOptionsPosition[    327761,       8639]
NotebookOutlinePosition[    328198,       8656]
CellTagsIndexPosition[    328155,       8653]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\<\
(* A Das Nov 2022: Calculation of TDMs for Stokes transition at 181p5 G *)\
\>", "Section",
 CellChangeTimes->{{3.8705106823145604`*^9, 3.8705106989579163`*^9}, 
   3.8705111139145*^9, {3.8705111786608562`*^9, 3.870511255450698*^9}, {
   3.8705144779714317`*^9, 3.87051451364209*^9}, {3.8705145856668425`*^9, 
   3.870514589362107*^9}, {3.870927897448503*^9, 3.870927922461501*^9}, {
   3.8709279810735674`*^9, 3.8709279919564276`*^9}, 3.870928069283157*^9, 
   3.871116071894576*^9, 3.8711368054384036`*^9, {3.8711370628938665`*^9, 
   3.8711370751903057`*^9}, {3.8711378581752453`*^9, 
   3.8711379309918194`*^9}, {3.871138003253318*^9, 3.871138107998437*^9}, {
   3.8711381559999056`*^9, 3.8711382516782565`*^9}, {3.8711383024446225`*^9, 
   3.8711383278307705`*^9}, {3.871138378947694*^9, 3.871138479380617*^9}, {
   3.871138595277232*^9, 3.8711386006499615`*^9}, {3.871138723586886*^9, 
   3.8711387338613696`*^9}, {3.871138972321042*^9, 3.871138997598448*^9}, {
   3.871139080931043*^9, 3.871139096614005*^9}, {3.871139204477915*^9, 
   3.8711392467466726`*^9}, {3.8711394031401625`*^9, 3.871139415465063*^9}, {
   3.8711395314667215`*^9, 3.8711395390118694`*^9}, {3.871139850606797*^9, 
   3.871139909532261*^9}, 3.87113998889883*^9, 3.8711400780249295`*^9, {
   3.871144366988204*^9, 3.8711443750847387`*^9}, {3.8711444216665726`*^9, 
   3.871144561706081*^9}, {3.871439122498387*^9, 3.8714391336174*^9}, {
   3.8714397561171904`*^9, 3.871439792146626*^9}, {3.871440095269646*^9, 
   3.8714400983788147`*^9}, {3.8714419166670732`*^9, 
   3.8714419218073883`*^9}, {3.8764676492105584`*^9, 
   3.8764676508823338`*^9}, {3.876468097892173*^9, 3.876468160468707*^9}, {
   3.8764682381522617`*^9, 3.8764682813054457`*^9}, {3.876469925404197*^9, 
   3.876469948636669*^9}, 3.8764701190968676`*^9, {3.8764702213930826`*^9, 
   3.8764702610014606`*^9}, {3.876470298457709*^9, 3.876470305051832*^9}, {
   3.876470393558408*^9, 3.876470398447113*^9}, 3.8764704338944397`*^9, {
   3.876471674462902*^9, 3.876471684084369*^9}, {3.8764718767033615`*^9, 
   3.876471882296749*^9}, {3.876474520625727*^9, 3.8764745317209597`*^9}, {
   3.876474610754493*^9, 3.8764746187121115`*^9}, {3.877509812137291*^9, 
   3.8775098490837374`*^9}, {3.8775099552916207`*^9, 
   3.8775099771294236`*^9}, {3.877510007132639*^9, 3.8775100522266817`*^9}, {
   3.877510223911361*^9, 3.877510252358178*^9}, {3.8775104638242407`*^9, 
   3.877510498344037*^9}, {3.8775105745400343`*^9, 3.8775106965650344`*^9}, {
   3.877510752448393*^9, 3.8775108502583704`*^9}, {3.877515933744178*^9, 
   3.8775159437776117`*^9}, {3.877516016251019*^9, 3.877516023769556*^9}, {
   3.8775161532474747`*^9, 3.877516163463621*^9}, {3.886234473013073*^9, 
   3.8862346033513007`*^9}, {3.886234845617175*^9, 3.8862349062893233`*^9}, {
   3.8862349475549445`*^9, 3.8862351006498413`*^9}, {3.8862351847559137`*^9, 
   3.886235267955227*^9}, {3.886235300353842*^9, 3.8862353251335006`*^9}, {
   3.8862364670799417`*^9, 3.8862364856181297`*^9}, {3.886236790694195*^9, 
   3.8862367942979426`*^9}, {3.8862368354325733`*^9, 3.886236935258665*^9}, {
   3.8862372464760046`*^9, 3.88623727608191*^9}, {3.8862373905636544`*^9, 
   3.8862373918408175`*^9}, {3.886237532108982*^9, 3.886237617739126*^9}, {
   3.88623833418522*^9, 3.8862383768248596`*^9}, 3.8862393084634914`*^9, {
   3.8862398828085504`*^9, 3.886239923786508*^9}, {3.8862400144091997`*^9, 
   3.886240023291636*^9}, {3.8862401535195103`*^9, 3.8862401878445*^9}, 
   3.887268290340684*^9, {3.8901135945657997`*^9, 3.890113628455295*^9}, 
   3.890113691397598*^9, {3.9024541134860077`*^9, 3.902454114112424*^9}, 
   3.904087368223692*^9, {3.9040874227745543`*^9, 3.904087428246716*^9}, {
   3.9040880596660433`*^9, 3.9040880627277393`*^9}, {3.904088179699273*^9, 
   3.904088188330207*^9}, 3.904200796239612*^9, {3.904200853334508*^9, 
   3.904200861006509*^9}, {3.9046141883177767`*^9, 3.904614217432329*^9}, {
   3.904614274724485*^9, 3.904614311265967*^9}, {3.904614343233508*^9, 
   3.90461446498883*^9}, {3.9046145038445*^9, 3.9046145163340683`*^9}, {
   3.9046146144408503`*^9, 3.9046146617777767`*^9}, 3.904614695528571*^9, {
   3.904614727417923*^9, 3.9046147467417793`*^9}, 3.904614783876287*^9, {
   3.904615046703445*^9, 3.904615057658741*^9}, {3.9046152818204813`*^9, 
   3.904615321303071*^9}, {3.90461541210198*^9, 3.904615444400936*^9}, {
   3.904615505336876*^9, 3.90461551093896*^9}, {3.904615553113496*^9, 
   3.904615566637239*^9}, {3.904615667747727*^9, 3.9046156936693373`*^9}, {
   3.904866869047104*^9, 3.90486689537328*^9}, {3.9048669365017557`*^9, 
   3.904866938587695*^9}, {3.904866972005845*^9, 3.9048670167218513`*^9}, {
   3.9048671322004843`*^9, 3.904867155650156*^9}, {3.9048671933231077`*^9, 
   3.90486719625585*^9}, {3.904870005405939*^9, 3.904870079742064*^9}, {
   3.904870123822847*^9, 3.90487019438056*^9}, {3.904870474552492*^9, 
   3.904870492282267*^9}, {3.90495310083674*^9, 3.904953101294941*^9}, {
   3.904953142629387*^9, 3.9049531429970512`*^9}, {3.904956664057723*^9, 
   3.9049566650749903`*^9}, {3.904956719258141*^9, 3.9049567203765507`*^9}, {
   3.9049624171013937`*^9, 3.904962497173534*^9}, {3.904965535637928*^9, 
   3.904965536239534*^9}, {3.904968149593644*^9, 3.9049681626675367`*^9}, 
   3.904969149094696*^9, {3.905300295475389*^9, 3.9053003417351933`*^9}, {
   3.905300377277796*^9, 3.905300378678866*^9}, {3.905328689085623*^9, 
   3.905328694961362*^9}},
 Background->RGBColor[
  1, 0.925, 0.925],ExpressionUUID->"98aea7be-657c-4623-9520-6a1320fad11a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Stark", " ", "shift", " ", 
      RowBox[{"convergence", ":", " ", 
       RowBox[{
       "change", " ", "in", " ", "ground", " ", "state", " ", "level", " ", 
        "with", " ", "additional", " ", "rotational", " ", "level", " ", "to",
         " ", "N"}]}]}], "=", 
     RowBox[{"7", " ", "2", "kHz"}]}], ",", " ", 
    RowBox[{
     RowBox[{"to", " ", "N"}], "=", 
     RowBox[{"8", " ", "7", "Hz"}]}], ",", " ", 
    RowBox[{
     RowBox[{"to", " ", "N"}], "=", 
     RowBox[{"9", " ", "<", 
      RowBox[{"1", "Hz"}]}]}]}], "  ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "estimated", " ", "effect", " ", "of", " ", "diagmagnetic", " ", "shift", 
    " ", 
    RowBox[{"(", "omitted", ")"}], " ", "is", " ", "about", " ", "50", "Hz"}],
    "  ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Before", " ", "run", " ", "copy", " ", 
    "\"\<stirap1_down_state_vector.nb\>\"", " ", "and", " ", 
    "\"\<stirap2_down_state_vector.nb\>\"", " ", "from", " ", "RbCsb3Pi1", 
    " ", "to", " ", "RbCsX1SigmaN0", " ", "floder"}], " ", "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Off", "[", 
     RowBox[{"ClebschGordan", "::", "\"\<phy\>\""}], "]"}], " ", ";"}], "\n", 
   RowBox[{
    RowBox[{"Off", "[", 
     RowBox[{"ClebschGordan", "::", "\"\<tri\>\""}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BasePath", " ", "=", " ", 
     RowBox[{"NotebookDirectory", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"libPath", " ", "=", " ", 
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], "<>", "\"\</lib/\>\""}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"outputPath", " ", "=", " ", 
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], "<>", "\"\</data/\>\""}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SetDirectory", "[", "BasePath", "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"**", "**", "**", "**", "**", "**", "**"}], "**", "**"}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"physical", " ", "constants"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"**", "**", "**", "**", "**", "**", "**", "**", "**"}], " ", 
    "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"e", "=", 
     RowBox[{"4.803207", "/", 
      RowBox[{"10", "^", "10"}]}]}], ";"}], " ", 
   RowBox[{"(*", " ", "esu", " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"c", "=", 
     RowBox[{"2.99792458", "*", 
      RowBox[{"10", "^", "10"}]}]}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{"cm", "/", "s"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[HBar]", "=", 
     RowBox[{"1.05457163", " ", 
      SuperscriptBox["10", 
       RowBox[{"-", "27"}]]}]}], ";"}], "  ", 
   RowBox[{"(*", " ", 
    RowBox[{"in", " ", "erg", " ", "s", " ", "2006", " ", "CODATA"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"h", "=", 
     RowBox[{"2", "*", "Pi", "*", "\[HBar]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"g", "=", "980.553"}], " ", ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"http", ":"}], "//", 
     RowBox[{
      RowBox[{"bgi", ".", "cnes", ".", "fr"}], "/"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ao", "=", 
     RowBox[{"5.2917721092", "*", 
      RowBox[{"10", "^", 
       RowBox[{"-", "9"}]}]}]}], ";"}], "   ", 
   RowBox[{"(*", " ", 
    RowBox[{"Bohr", " ", "radius", " ", "cm"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["\[Mu]", "Bohr"], "=", 
     RowBox[{"9.27400915", " ", 
      SuperscriptBox["10", 
       RowBox[{"-", "21"}]]}]}], " ", ";"}], 
   RowBox[{"(*", " ", 
    RowBox[{"in", " ", 
     RowBox[{"erg", "/", "G"}], " ", "2006", " ", "CODATA"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["\[Mu]", "Nuc"], "=", 
     RowBox[{"5.05078353", " ", 
      SuperscriptBox["10", 
       RowBox[{"-", "24"}]]}]}], ";"}], 
   RowBox[{"(*", " ", 
    RowBox[{"in", " ", 
     RowBox[{"erg", "/", "G"}], " ", "2010", " ", "CODATA"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["m", "Cs"], "=", 
     RowBox[{"2.20694657", " ", 
      SuperscriptBox["10", 
       RowBox[{"-", "22"}]]}]}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{"g", " ", 
     RowBox[{"D", ".", "A", ".", "Steck"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["m", "Rb"], "=", 
     RowBox[{"1.443160648", " ", 
      SuperscriptBox["10", 
       RowBox[{"-", "22"}]]}]}], ";"}], 
   RowBox[{"(*", " ", 
    RowBox[{"g", " ", 
     RowBox[{"D", ".", "A", ".", "Steck"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["m", "e"], "=", 
     RowBox[{"9.10938188", " ", 
      SuperscriptBox["10", 
       RowBox[{"-", "28"}]]}]}], ";"}], 
   RowBox[{"(*", " ", 
    RowBox[{"g", " ", 
     RowBox[{"D", ".", "A", ".", "Steck"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"gS", "=", "2.0023193043622"}], ";"}], "  ", 
   RowBox[{"(*", " ", 
    RowBox[{"2006", " ", "CODATA"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["i", "Rb"], "=", 
     RowBox[{"3", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["i", "Cs"], "=", 
     RowBox[{"7", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["B", "RbCs"], "=", 
     RowBox[{"490.17", "*", 
      RowBox[{"10", "^", "6"}], "*", "h"}]}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"N", "=", 
      RowBox[{
      "0", " ", "rotational", " ", "constant", " ", "from", " ", "Blackmore", 
       " ", "et", " ", 
       RowBox[{"al", "."}]}]}], ",", " ", 
     RowBox[{"Comp", ".", " ", "Phys", ".", " ", "Commun", ".", " ", "282"}], 
     ",", " ", 
     RowBox[{"108512", " ", 
      RowBox[{"(", "2023", ")"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["d", "RbCs"], "=", 
     RowBox[{"1.25", "*", 
      RowBox[{"10", "^", 
       RowBox[{"-", "18"}]}]}]}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "permanent", " ", "dipole", " ", "moment", " ", "in", " ", "molecule", 
      " ", "fixed", " ", "frame", " ", "in", " ", "statcoulomb"}], "-", 
     RowBox[{"cm", " ", 
      RowBox[{"(", 
       RowBox[{"Debye", " ", "*", " ", 
        RowBox[{"10", "^", 
         RowBox[{"-", "18"}]}]}], ")"}]}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["eqQ", "Rb"], "=", 
     RowBox[{
      RowBox[{"-", "0.809"}], "*", 
      RowBox[{"10", "^", "6"}], "*", "h"}]}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "87", "Rb", " ", "electric", " ", "quadrupole", " ", "constant", " ", 
      "Blackmore", " ", "et", " ", 
      RowBox[{"al", "."}]}], ",", " ", 
     RowBox[{"Comp", ".", " ", "Phys", ".", " ", "Commun", ".", " ", "282"}], 
     ",", " ", 
     RowBox[{"108512", " ", 
      RowBox[{"(", "2023", ")"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["eqQ", "Cs"], "=", 
     RowBox[{"0.059", "*", 
      RowBox[{"10", "^", "6"}], "*", "h"}]}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "Cs", " ", "electric", " ", "quadrupole", " ", "constant", " ", 
      "Blackmore", " ", "et", " ", 
      RowBox[{"al", "."}]}], ",", " ", 
     RowBox[{"Comp", ".", " ", "Phys", ".", " ", "Commun", ".", " ", "282"}], 
     ",", " ", 
     RowBox[{"108512", " ", 
      RowBox[{"(", "2023", ")"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["g", 
      RowBox[{"i", ",", "Rb"}]], "=", "1.8295"}], " ", ";"}], " ", 
   RowBox[{"(*", "  ", 
    RowBox[{
     RowBox[{"Blackmore", " ", "et", " ", 
      RowBox[{"al", "."}]}], ",", " ", 
     RowBox[{"Comp", ".", " ", "Phys", ".", " ", "Commun", ".", " ", "282"}], 
     ",", " ", 
     RowBox[{"108512", " ", 
      RowBox[{"(", "2023", ")"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["g", 
      RowBox[{"i", ",", "Cs"}]], "=", "0.7331"}], " ", ";"}], " ", 
   RowBox[{"(*", "  ", 
    RowBox[{
     RowBox[{"Blackmore", " ", "et", " ", 
      RowBox[{"al", "."}]}], ",", " ", 
     RowBox[{"Comp", ".", " ", "Phys", ".", " ", "Commun", ".", " ", "282"}], 
     ",", " ", 
     RowBox[{"108512", " ", 
      RowBox[{"(", "2023", ")"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["g", "r"], "=", "0.0062"}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "rotational", " ", "g", " ", "factor", " ", "Aldegunde", " ", "et", " ", 
      RowBox[{"al", "."}]}], ",", " ", 
     RowBox[{"PRA", " ", "78", " ", "033434", " ", 
      RowBox[{"(", "2008", ")"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["c", "Rb"], "=", 
     RowBox[{"98.4", "*", "h"}]}], ";"}], "  ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"87", "Rb", " ", "nuclear", " ", "spin"}], "-", 
      RowBox[{"rotation", " ", "constant", " ", "Aldegunde", " ", "et", " ", 
       RowBox[{"al", "."}]}]}], ",", " ", 
     RowBox[{"PRA", " ", "78", " ", "033434", " ", 
      RowBox[{"(", "2008", ")"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["c", "Cs"], "=", 
     RowBox[{"194.2", "*", "h"}]}], ";"}], "  ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"Cs", " ", "nuclear", " ", "spin"}], "-", 
      RowBox[{"rotation", " ", "constant", " ", 
       RowBox[{
       "Comp", ".", " ", "Phys", ".", " ", "Commun", ".", " ", "282"}]}]}], 
     ",", " ", 
     RowBox[{"108512", " ", 
      RowBox[{"(", "2023", ")"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"c3", "=", 
     RowBox[{"192.4", "*", "h"}]}], ";"}], " ", 
   RowBox[{"(*", "  ", 
    RowBox[{
     RowBox[{"Aldegunde", " ", "et", " ", 
      RowBox[{"al", "."}]}], ",", " ", 
     RowBox[{"PRA", " ", "78", " ", "033434", " ", 
      RowBox[{"(", "2008", ")"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"c4", "=", 
     RowBox[{"19018.96", "*", "h"}]}], ";"}], " ", 
   RowBox[{"(*", "  ", 
    RowBox[{
     RowBox[{"Comp", ".", " ", "Phys", ".", " ", "Commun", ".", " ", "282"}], 
     ",", " ", 
     RowBox[{"108512", " ", 
      RowBox[{"(", "2023", ")"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Sigma]Rb", "=", 
     RowBox[{"3531", "*", 
      RowBox[{"10", "^", 
       RowBox[{"(", 
        RowBox[{"-", "6"}], ")"}]}]}]}], ";"}], " ", 
   RowBox[{"(*", "  ", 
    RowBox[{
     RowBox[{"Aldegunde", " ", "et", " ", 
      RowBox[{"al", "."}]}], ",", " ", 
     RowBox[{"PRA", " ", "78", " ", "033434", " ", 
      RowBox[{"(", "2008", ")"}], " ", "has", " ", "N", " ", "dependence", 
      " ", "but", " ", "this", " ", "is", " ", "ignored", " ", "here"}]}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Sigma]Cs", "=", 
     RowBox[{"6367", "*", 
      RowBox[{"10", "^", 
       RowBox[{"(", 
        RowBox[{"-", "6"}], ")"}]}]}]}], ";"}], " ", 
   RowBox[{"(*", "  ", 
    RowBox[{
     RowBox[{"Aldegunde", " ", "et", " ", 
      RowBox[{"al", "."}]}], ",", " ", 
     RowBox[{"PRA", " ", "78", " ", "033434", " ", 
      RowBox[{"(", "2008", ")"}], " ", "has", " ", "N", " ", "dependence", 
      " ", "but", " ", "this", " ", "is", " ", "ignored", " ", "here"}]}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"alphapar", "=", 
     RowBox[{"904", 
      RowBox[{"ao", "^", "3"}]}]}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{"parallel", " ", "to", " ", "axis", " ", "dc", " ", 
     RowBox[{"polarizability", " ", "@", " ", "min"}], " ", "internuc", " ", 
     "sep", " ", "from", " ", "Dulieu", " ", "JCP", " ", "129", " ", "064309",
      " ", 
     RowBox[{"(", "2008", ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"alphaperp", "=", 
     RowBox[{"492.3", 
      RowBox[{"ao", "^", "3"}]}]}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{"perpendicular", " ", "dc", " ", 
     RowBox[{"polarizability", " ", "@", " ", "min"}], " ", "internuc", " ", 
     "sep", " ", "from", " ", "Dulieu", " ", "JCP", " ", "129", " ", "064309",
      " ", 
     RowBox[{"(", "2008", ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"alpha", "=", 
     RowBox[{"597.6", 
      RowBox[{"ao", "^", "3"}]}]}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"avg", " ", "polarizability", " ", "for", " ", "v"}], "=", 
     RowBox[{
     "0", " ", "from", " ", "Dulieu", " ", "JCP", " ", "129", " ", "064309", 
      " ", 
      RowBox[{"(", "2008", ")"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
       "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
       "**"}], "*", 
     RowBox[{
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**"}],
      "*", 
     RowBox[{"**", "**", "**", "**", "**"}], "*"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "Hamiltonians", " ", "with", " ", "Stark", " ", "and", " ", "Zeeman", 
      " ", "in", " ", "nuclear", " ", "spin"}], "-", 
     RowBox[{"decoupled", " ", 
      RowBox[{"basis", "."}]}]}], "                      ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
       "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
       "**"}], "*", 
     RowBox[{
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**"}],
      "*", 
     RowBox[{"**", "**", "**", "**", "**"}], "*"}], " ", "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Heff", "[", 
      RowBox[{
      "mIRb1_", ",", "mICs1_", ",", "N1_", ",", "mN1_", ",", "mIRb2_", ",", 
       "mICs2_", ",", "N2_", ",", "mN2_", ",", "Ez_"}], "]"}], ":=", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"mIRb1", ",", "mIRb2"}], "]"}], " ", "*", " ", 
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"mICs1", ",", "mICs2"}], "]"}], "*", 
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"N1", ",", "N2"}], "]"}], " ", "*", " ", 
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"mN1", ",", "mN2"}], "]"}], "*", 
       SubscriptBox["B", "RbCs"], "N1", 
       RowBox[{"(", 
        RowBox[{"N1", "+", "1"}], ")"}]}], "-", " ", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
         RowBox[{
         "Stark", " ", "diag", " ", "in", " ", "mIRb", " ", "mICs", " ", 
          RowBox[{"mN", ".", "  ", "\[CapitalDelta]N"}]}], " ", "=", " ", 
         "0"}], ",", 
        RowBox[{"+", 
         RowBox[{"-", "1"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"mIRb1", ",", "mIRb2"}], "]"}], " ", "*", " ", 
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"mICs1", ",", "mICs2"}], "]"}], "*", 
       SubscriptBox["d", "RbCs"], "*", "Ez", "*", 
       RowBox[{"Sqrt", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", "N1"}], "+", "1"}], ")"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", "N2"}], "+", "1"}], ")"}]}], "]"}], "*", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"-", "1"}], ")"}], "^", "mN1"}], " ", "*", 
       RowBox[{"ThreeJSymbol", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"N1", ",", 
           RowBox[{"-", "mN1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"N2", ",", "mN2"}], "}"}]}], "]"}], "*", 
       RowBox[{"ThreeJSymbol", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"N1", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"N2", ",", "0"}], "}"}]}], "]"}]}], " ", "-", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"nuc", " ", "Zeeman", " ", "diag", " ", "in", " ", "all"}], 
       " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"mIRb1", ",", "mIRb2"}], "]"}], " ", "*", " ", 
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"mICs1", ",", "mICs2"}], "]"}], "*", 
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"N1", ",", "N2"}], "]"}], " ", "*", " ", 
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"mN1", ",", "mN2"}], "]"}], "*", "\[IndentingNewLine]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SubscriptBox["g", 
           RowBox[{"i", ",", "Rb"}]], 
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Sigma]Rb"}], ")"}], "mIRb1"}], "+", 
         RowBox[{
          SubscriptBox["g", 
           RowBox[{"i", ",", "Cs"}]], " ", 
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Sigma]Cs"}], ")"}], "mICs1"}], "+", 
         RowBox[{
          SubscriptBox["g", "r"], "mN1"}]}], ")"}], " ", 
       SubscriptBox["\[Mu]", "Nuc"], " ", "Bz"}], " ", "+", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"RbQP", " ", "diag", " ", "in", " ", 
          RowBox[{"mICs", ".", " ", "\[CapitalDelta]N"}]}], "=", 
         RowBox[{"-", "2"}]}], ",", "0", ",", 
        RowBox[{
         RowBox[{"2", " ", "\[CapitalDelta]mN"}], "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], ".."}], "2", " ", "\[CapitalDelta]mIRb"}], 
          "=", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], ".."}], "2"}]}]}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["eqQ", "Rb"], "/", "4"}], ")"}], "*", 
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"mICs1", ",", "mICs2"}], "]"}], "*", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], 
           RowBox[{"p", "+", "N1", "-", "mN1"}]], 
          RowBox[{"ThreeJSymbol", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"N1", ",", 
              RowBox[{"-", "mN1"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"2", ",", "p"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"N2", ",", "mN2"}], "}"}]}], "]"}], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], "N1"], 
          RowBox[{"Sqrt", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", "N1"}], "+", "1"}], ")"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", "N2"}], "+", "1"}], ")"}]}], "]"}], 
          RowBox[{"ThreeJSymbol", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"N1", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"2", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"N2", ",", "0"}], "}"}]}], "]"}], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], 
           RowBox[{
            SubscriptBox["i", "Rb"], "-", "mIRb1"}]], 
          RowBox[{
           RowBox[{"ThreeJSymbol", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               SubscriptBox["i", "Rb"], ",", 
               RowBox[{"-", "mIRb1"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"2", ",", 
               RowBox[{"-", "p"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               SubscriptBox["i", "Rb"], ",", "mIRb2"}], "}"}]}], "]"}], "/", 
           RowBox[{"ThreeJSymbol", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               SubscriptBox["i", "Rb"], ",", 
               RowBox[{"-", 
                SubscriptBox["i", "Rb"]}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"2", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               SubscriptBox["i", "Rb"], ",", 
               SubscriptBox["i", "Rb"]}], "}"}]}], "]"}]}]}], ",", 
         RowBox[{"{", 
          RowBox[{"p", ",", 
           RowBox[{"-", "2"}], ",", "2"}], "}"}]}], "]"}]}], "+", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"CsQP", " ", "diag", " ", "in", " ", 
          RowBox[{"mIRb", ".", " ", "\[CapitalDelta]N"}]}], "=", 
         RowBox[{"-", "2"}]}], ",", "0", ",", 
        RowBox[{
         RowBox[{"2", " ", "\[CapitalDelta]mN"}], "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], ".."}], "2", " ", "\[CapitalDelta]mICs"}], 
          "=", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], ".."}], "2"}]}]}]}], " ", "*)"}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["eqQ", "Cs"], "/", "4"}], ")"}], "*", 
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"mIRb1", ",", "mIRb2"}], "]"}], "*", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], 
           RowBox[{"p", "+", "N1", "-", "mN1"}]], 
          RowBox[{"ThreeJSymbol", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"N1", ",", 
              RowBox[{"-", "mN1"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"2", ",", "p"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"N2", ",", "mN2"}], "}"}]}], "]"}], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], "N1"], 
          RowBox[{"Sqrt", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", "N1"}], "+", "1"}], ")"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", "N2"}], "+", "1"}], ")"}]}], "]"}], 
          RowBox[{"ThreeJSymbol", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"N1", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"2", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"N2", ",", "0"}], "}"}]}], "]"}], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], 
           RowBox[{
            SubscriptBox["i", "Cs"], "-", "mICs1"}]], 
          RowBox[{
           RowBox[{"ThreeJSymbol", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               SubscriptBox["i", "Cs"], ",", 
               RowBox[{"-", "mICs1"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"2", ",", 
               RowBox[{"-", "p"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               SubscriptBox["i", "Cs"], ",", "mICs2"}], "}"}]}], "]"}], "/", 
           RowBox[{"ThreeJSymbol", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               SubscriptBox["i", "Cs"], ",", 
               RowBox[{"-", 
                SubscriptBox["i", "Cs"]}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"2", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               SubscriptBox["i", "Cs"], ",", 
               SubscriptBox["i", "Cs"]}], "}"}]}], "]"}]}]}], ",", 
         RowBox[{"{", 
          RowBox[{"p", ",", 
           RowBox[{"-", "2"}], ",", "2"}], "}"}]}], "]"}]}], "+", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "Rb", " ", "spin", " ", "rot", " ", "diag", " ", "in", " ", "mICs"}], 
        ",", 
        RowBox[{
         RowBox[{"N", ".", " ", "\[CapitalDelta]mN"}], "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"-", "1"}], ".."}], "1", " ", "\[CapitalDelta]mIRb"}], 
          "=", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "1"}], ".."}], "1"}]}]}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       SubscriptBox["c", "Rb"], "*", 
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"mICs1", ",", "mICs2"}], "]"}], "*", 
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"N1", ",", "N2"}], "]"}], "*", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], 
           RowBox[{"p", "+", "N1", "-", "mN1", "+", 
            SubscriptBox["i", "Rb"], "-", "mIRb1"}]], 
          RowBox[{"Sqrt", "[", 
           RowBox[{"N1", 
            RowBox[{"(", 
             RowBox[{"N1", "+", "1"}], ")"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", "N1"}], "+", "1"}], ")"}], 
            SubscriptBox["i", "Rb"], 
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["i", "Rb"], "+", "1"}], ")"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", 
               SubscriptBox["i", "Rb"]}], "+", "1"}], ")"}]}], "]"}], 
          RowBox[{"ThreeJSymbol", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"N1", ",", 
              RowBox[{"-", "mN1"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "p"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"N1", ",", "mN2"}], "}"}]}], "]"}], 
          RowBox[{"ThreeJSymbol", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              SubscriptBox["i", "Rb"], ",", 
              RowBox[{"-", "mIRb1"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", 
              RowBox[{"-", "p"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              SubscriptBox["i", "Rb"], ",", "mIRb2"}], "}"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"p", ",", 
           RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}]}], "+", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "Cs", " ", "spin", " ", "rot", " ", "diag", " ", "in", " ", "mIRb"}], 
        ",", 
        RowBox[{
         RowBox[{"N", ".", " ", "\[CapitalDelta]mN"}], "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"-", "1"}], ".."}], "1", " ", "\[CapitalDelta]mICs"}], 
          "=", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "1"}], ".."}], "1"}]}]}]}], " ", "*)"}], 
      RowBox[{
       SubscriptBox["c", "Cs"], "*", 
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"mIRb1", ",", "mIRb2"}], "]"}], "*", 
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"N1", ",", "N2"}], "]"}], "*", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], 
           RowBox[{"p", "+", "N1", "-", "mN1", "+", 
            SubscriptBox["i", "Cs"], "-", "mICs1"}]], 
          RowBox[{"Sqrt", "[", 
           RowBox[{"N1", 
            RowBox[{"(", 
             RowBox[{"N1", "+", "1"}], ")"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", "N1"}], "+", "1"}], ")"}], 
            SubscriptBox["i", "Cs"], 
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["i", "Cs"], "+", "1"}], ")"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", 
               SubscriptBox["i", "Cs"]}], "+", "1"}], ")"}]}], "]"}], 
          RowBox[{"ThreeJSymbol", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"N1", ",", 
              RowBox[{"-", "mN1"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "p"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"N1", ",", "mN2"}], "}"}]}], "]"}], 
          RowBox[{"ThreeJSymbol", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              SubscriptBox["i", "Cs"], ",", 
              RowBox[{"-", "mICs1"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", 
              RowBox[{"-", "p"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              SubscriptBox["i", "Cs"], ",", "mICs2"}], "}"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"p", ",", 
           RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}]}], "-", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
         RowBox[{
         "nuc", " ", "nuc", " ", "spin", " ", "tensor", " ", 
          "\[CapitalDelta]N"}], "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], ".."}], "2", " ", "\[CapitalDelta]mN"}], "=", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"-", "2"}], ".."}], "2", " ", "\[CapitalDelta]mIRb"}], 
           "=", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"-", "1"}], ".."}], "1", " ", "\[CapitalDelta]mICs"}], 
            "=", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"-", "1"}], ".."}], "1", "   ", "B"}], "&"}], "C", 
             " ", "8.314"}]}]}]}]}], ",", " ", 
        RowBox[{
         RowBox[{"8.302", " ", "but", " ", "error", " ", "in", " ", 
          RowBox[{"formula", ".", "  ", "q"}]}], "=", 
         RowBox[{"0", " ", "term", " ", "only"}]}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Sqrt", "[", "30", "]"}], "*", "c3", " ", "*", 
       "\[IndentingNewLine]", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], 
           RowBox[{
            SubscriptBox["i", "Cs"], "-", "mICs1", "+", 
            SubscriptBox["i", "Rb"], "-", "mIRb1"}]], 
          RowBox[{"ThreeJSymbol", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              SubscriptBox["i", "Cs"], ",", 
              RowBox[{"-", "mICs1"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", 
              RowBox[{"-", "p"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              SubscriptBox["i", "Cs"], ",", "mICs2"}], "}"}]}], "]"}], 
          RowBox[{"Sqrt", "[", 
           RowBox[{
            SubscriptBox["i", "Rb"], 
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["i", "Rb"], "+", "1"}], ")"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", 
               SubscriptBox["i", "Rb"]}], "+", "1"}], ")"}], 
            SubscriptBox["i", "Cs"], 
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["i", "Cs"], "+", "1"}], ")"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", 
               SubscriptBox["i", "Cs"]}], "+", "1"}], ")"}]}], "]"}], 
          "\[IndentingNewLine]", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], "N1"], 
             RowBox[{"Sqrt", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"2", "N1"}], "+", "1"}], ")"}], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"2", "N2"}], "+", "1"}], ")"}]}], "]"}], 
             RowBox[{"ThreeJSymbol", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"N1", ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"2", ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"N2", ",", "0"}], "}"}]}], "]"}], 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{"N1", "-", "mN1"}]], 
             RowBox[{"ThreeJSymbol", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"N1", ",", 
                 RowBox[{"-", "mN1"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"2", ",", "p2"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"N2", ",", "mN2"}], "}"}]}], "]"}], 
             RowBox[{"ThreeJSymbol", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 SubscriptBox["i", "Rb"], ",", 
                 RowBox[{"-", "mIRb1"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", "p1"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 SubscriptBox["i", "Rb"], ",", "mIRb2"}], "}"}]}], "]"}], 
             RowBox[{"ThreeJSymbol", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"1", ",", "p1"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"2", ",", "p2"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", 
                 RowBox[{"-", "p"}]}], "}"}]}], "]"}]}], 
            "\[IndentingNewLine]", ",", 
            RowBox[{"{", 
             RowBox[{"p1", ",", 
              RowBox[{"-", " ", "1"}], ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"p2", ",", 
              RowBox[{"-", "2"}], ",", "2"}], "}"}]}], "]"}]}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"p", ",", 
           RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}]}], "+", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "nuc", " ", "nuc", " ", "spin", " ", "scalar", " ", "diag", " ", "in",
          " ", "N"}], ",", " ", 
        RowBox[{
         RowBox[{"mN", ".", " ", "\[CapitalDelta]mIRb"}], "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"-", "1"}], ".."}], "1", " ", "\[CapitalDelta]mICs"}], 
          "=", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "1"}], ".."}], "1"}]}]}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"c4", "*", 
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"N1", ",", "N2"}], "]"}], " ", "*", " ", 
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"mN1", ",", "mN2"}], "]"}], "*", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], "p"], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], 
           RowBox[{
            RowBox[{"+", 
             SubscriptBox["i", "Rb"]}], "-", "mIRb1"}]], 
          RowBox[{"ThreeJSymbol", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              SubscriptBox["i", "Rb"], ",", 
              RowBox[{"-", "mIRb1"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "p"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              SubscriptBox["i", "Rb"], ",", "mIRb2"}], "}"}]}], "]"}], 
          RowBox[{"Sqrt", "[", 
           RowBox[{
            SubscriptBox["i", "Rb"], 
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["i", "Rb"], "+", "1"}], ")"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", 
               SubscriptBox["i", "Rb"]}], "+", "1"}], ")"}]}], "]"}], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], 
           RowBox[{
            RowBox[{"+", 
             SubscriptBox["i", "Cs"]}], "-", "mICs1"}]], 
          RowBox[{"ThreeJSymbol", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              SubscriptBox["i", "Cs"], ",", 
              RowBox[{"-", "mICs1"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", 
              RowBox[{"-", "p"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              SubscriptBox["i", "Cs"], ",", "mICs2"}], "}"}]}], "]"}], 
          RowBox[{"Sqrt", "[", 
           RowBox[{
            SubscriptBox["i", "Cs"], 
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["i", "Cs"], "+", "1"}], ")"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", 
               SubscriptBox["i", "Cs"]}], "+", "1"}], ")"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"p", ",", 
           RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"HeffNofields", "[", 
      RowBox[{
      "mIRb1_", ",", "mICs1_", ",", "N1_", ",", "mN1_", ",", "mIRb2_", ",", 
       "mICs2_", ",", "N2_", ",", "mN2_"}], "]"}], ":=", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"rotation", " ", "diag", " ", "in", " ", "all"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"mIRb1", ",", "mIRb2"}], "]"}], " ", "*", " ", 
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"mICs1", ",", "mICs2"}], "]"}], "*", 
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"N1", ",", "N2"}], "]"}], " ", "*", " ", 
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"mN1", ",", "mN2"}], "]"}], "*", 
       SubscriptBox["B", "RbCs"], "N1", 
       RowBox[{"(", 
        RowBox[{"N1", "+", "1"}], ")"}]}], "+", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"RbQP", " ", "diag", " ", "in", " ", 
          RowBox[{"mICs", ".", " ", "\[CapitalDelta]N"}]}], "=", 
         RowBox[{"-", "2"}]}], ",", "0", ",", 
        RowBox[{
         RowBox[{"2", " ", "\[CapitalDelta]mN"}], "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], ".."}], "2", " ", "\[CapitalDelta]mIRb"}], 
          "=", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], ".."}], "2"}]}]}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["eqQ", "Rb"], "/", "4"}], ")"}], "*", 
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"mICs1", ",", "mICs2"}], "]"}], "*", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], 
           RowBox[{"p", "+", "N1", "-", "mN1"}]], 
          RowBox[{"ThreeJSymbol", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"N1", ",", 
              RowBox[{"-", "mN1"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"2", ",", "p"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"N2", ",", "mN2"}], "}"}]}], "]"}], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], "N1"], 
          RowBox[{"Sqrt", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", "N1"}], "+", "1"}], ")"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", "N2"}], "+", "1"}], ")"}]}], "]"}], 
          RowBox[{"ThreeJSymbol", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"N1", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"2", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"N2", ",", "0"}], "}"}]}], "]"}], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], 
           RowBox[{
            SubscriptBox["i", "Rb"], "-", "mIRb1"}]], 
          RowBox[{
           RowBox[{"ThreeJSymbol", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               SubscriptBox["i", "Rb"], ",", 
               RowBox[{"-", "mIRb1"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"2", ",", 
               RowBox[{"-", "p"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               SubscriptBox["i", "Rb"], ",", "mIRb2"}], "}"}]}], "]"}], "/", 
           RowBox[{"ThreeJSymbol", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               SubscriptBox["i", "Rb"], ",", 
               RowBox[{"-", 
                SubscriptBox["i", "Rb"]}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"2", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               SubscriptBox["i", "Rb"], ",", 
               SubscriptBox["i", "Rb"]}], "}"}]}], "]"}]}]}], ",", 
         RowBox[{"{", 
          RowBox[{"p", ",", 
           RowBox[{"-", "2"}], ",", "2"}], "}"}]}], "]"}]}], "+", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"CsQP", " ", "diag", " ", "in", " ", 
          RowBox[{"mIRb", ".", " ", "\[CapitalDelta]N"}]}], "=", 
         RowBox[{"-", "2"}]}], ",", "0", ",", 
        RowBox[{
         RowBox[{"2", " ", "\[CapitalDelta]mN"}], "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], ".."}], "2", " ", "\[CapitalDelta]mICs"}], 
          "=", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], ".."}], "2"}]}]}]}], " ", "*)"}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["eqQ", "Cs"], "/", "4"}], ")"}], "*", 
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"mIRb1", ",", "mIRb2"}], "]"}], "*", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], 
           RowBox[{"p", "+", "N1", "-", "mN1"}]], 
          RowBox[{"ThreeJSymbol", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"N1", ",", 
              RowBox[{"-", "mN1"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"2", ",", "p"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"N2", ",", "mN2"}], "}"}]}], "]"}], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], "N1"], 
          RowBox[{"Sqrt", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", "N1"}], "+", "1"}], ")"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", "N2"}], "+", "1"}], ")"}]}], "]"}], 
          RowBox[{"ThreeJSymbol", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"N1", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"2", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"N2", ",", "0"}], "}"}]}], "]"}], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], 
           RowBox[{
            SubscriptBox["i", "Cs"], "-", "mICs1"}]], 
          RowBox[{
           RowBox[{"ThreeJSymbol", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               SubscriptBox["i", "Cs"], ",", 
               RowBox[{"-", "mICs1"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"2", ",", 
               RowBox[{"-", "p"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               SubscriptBox["i", "Cs"], ",", "mICs2"}], "}"}]}], "]"}], "/", 
           RowBox[{"ThreeJSymbol", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               SubscriptBox["i", "Cs"], ",", 
               RowBox[{"-", 
                SubscriptBox["i", "Cs"]}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"2", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               SubscriptBox["i", "Cs"], ",", 
               SubscriptBox["i", "Cs"]}], "}"}]}], "]"}]}]}], ",", 
         RowBox[{"{", 
          RowBox[{"p", ",", 
           RowBox[{"-", "2"}], ",", "2"}], "}"}]}], "]"}]}], "+", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "Rb", " ", "spin", " ", "rot", " ", "diag", " ", "in", " ", "mICs"}], 
        ",", 
        RowBox[{
         RowBox[{"N", ".", " ", "\[CapitalDelta]mN"}], "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"-", "1"}], ".."}], "1", " ", "\[CapitalDelta]mIRb"}], 
          "=", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "1"}], ".."}], "1"}]}]}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       SubscriptBox["c", "Rb"], "*", 
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"mICs1", ",", "mICs2"}], "]"}], "*", 
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"N1", ",", "N2"}], "]"}], "*", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], 
           RowBox[{"p", "+", "N1", "-", "mN1", "+", 
            SubscriptBox["i", "Rb"], "-", "mIRb1"}]], 
          RowBox[{"Sqrt", "[", 
           RowBox[{"N1", 
            RowBox[{"(", 
             RowBox[{"N1", "+", "1"}], ")"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", "N1"}], "+", "1"}], ")"}], 
            SubscriptBox["i", "Rb"], 
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["i", "Rb"], "+", "1"}], ")"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", 
               SubscriptBox["i", "Rb"]}], "+", "1"}], ")"}]}], "]"}], 
          RowBox[{"ThreeJSymbol", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"N1", ",", 
              RowBox[{"-", "mN1"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "p"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"N1", ",", "mN2"}], "}"}]}], "]"}], 
          RowBox[{"ThreeJSymbol", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              SubscriptBox["i", "Rb"], ",", 
              RowBox[{"-", "mIRb1"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", 
              RowBox[{"-", "p"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              SubscriptBox["i", "Rb"], ",", "mIRb2"}], "}"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"p", ",", 
           RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}]}], "+", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "Cs", " ", "spin", " ", "rot", " ", "diag", " ", "in", " ", "mIRb"}], 
        ",", 
        RowBox[{
         RowBox[{"N", ".", " ", "\[CapitalDelta]mN"}], "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"-", "1"}], ".."}], "1", " ", "\[CapitalDelta]mICs"}], 
          "=", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "1"}], ".."}], "1"}]}]}]}], " ", "*)"}], 
      RowBox[{
       SubscriptBox["c", "Cs"], "*", 
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"mIRb1", ",", "mIRb2"}], "]"}], "*", 
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"N1", ",", "N2"}], "]"}], "*", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], 
           RowBox[{"p", "+", "N1", "-", "mN1", "+", 
            SubscriptBox["i", "Cs"], "-", "mICs1"}]], 
          RowBox[{"Sqrt", "[", 
           RowBox[{"N1", 
            RowBox[{"(", 
             RowBox[{"N1", "+", "1"}], ")"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", "N1"}], "+", "1"}], ")"}], 
            SubscriptBox["i", "Cs"], 
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["i", "Cs"], "+", "1"}], ")"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", 
               SubscriptBox["i", "Cs"]}], "+", "1"}], ")"}]}], "]"}], 
          RowBox[{"ThreeJSymbol", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"N1", ",", 
              RowBox[{"-", "mN1"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "p"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"N1", ",", "mN2"}], "}"}]}], "]"}], 
          RowBox[{"ThreeJSymbol", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              SubscriptBox["i", "Cs"], ",", 
              RowBox[{"-", "mICs1"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", 
              RowBox[{"-", "p"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              SubscriptBox["i", "Cs"], ",", "mICs2"}], "}"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"p", ",", 
           RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}]}], "-", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
         RowBox[{
         "nuc", " ", "nuc", " ", "spin", " ", "tensor", " ", 
          "\[CapitalDelta]N"}], "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], ".."}], "2", " ", "\[CapitalDelta]mN"}], "=", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"-", "2"}], ".."}], "2", " ", "\[CapitalDelta]mIRb"}], 
           "=", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"-", "1"}], ".."}], "1", " ", "\[CapitalDelta]mICs"}], 
            "=", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"-", "1"}], ".."}], "1", "   ", "B"}], "&"}], "C", 
             " ", "8.314"}]}]}]}]}], ",", " ", 
        RowBox[{
         RowBox[{"8.302", " ", "but", " ", "error", " ", "in", " ", 
          RowBox[{"formula", ".", "  ", "q"}]}], "=", 
         RowBox[{"0", " ", "term", " ", "only"}]}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Sqrt", "[", "30", "]"}], "*", "c3", " ", "*", 
       "\[IndentingNewLine]", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], 
           RowBox[{
            SubscriptBox["i", "Cs"], "-", "mICs1", "+", 
            SubscriptBox["i", "Rb"], "-", "mIRb1"}]], 
          RowBox[{"ThreeJSymbol", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              SubscriptBox["i", "Cs"], ",", 
              RowBox[{"-", "mICs1"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", 
              RowBox[{"-", "p"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              SubscriptBox["i", "Cs"], ",", "mICs2"}], "}"}]}], "]"}], 
          RowBox[{"Sqrt", "[", 
           RowBox[{
            SubscriptBox["i", "Rb"], 
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["i", "Rb"], "+", "1"}], ")"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", 
               SubscriptBox["i", "Rb"]}], "+", "1"}], ")"}], 
            SubscriptBox["i", "Cs"], 
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["i", "Cs"], "+", "1"}], ")"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", 
               SubscriptBox["i", "Cs"]}], "+", "1"}], ")"}]}], "]"}], 
          "\[IndentingNewLine]", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], "N1"], 
             RowBox[{"Sqrt", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"2", "N1"}], "+", "1"}], ")"}], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"2", "N2"}], "+", "1"}], ")"}]}], "]"}], 
             RowBox[{"ThreeJSymbol", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"N1", ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"2", ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"N2", ",", "0"}], "}"}]}], "]"}], 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{"N1", "-", "mN1"}]], 
             RowBox[{"ThreeJSymbol", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"N1", ",", 
                 RowBox[{"-", "mN1"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"2", ",", "p2"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"N2", ",", "mN2"}], "}"}]}], "]"}], 
             RowBox[{"ThreeJSymbol", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 SubscriptBox["i", "Rb"], ",", 
                 RowBox[{"-", "mIRb1"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", "p1"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 SubscriptBox["i", "Rb"], ",", "mIRb2"}], "}"}]}], "]"}], 
             RowBox[{"ThreeJSymbol", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"1", ",", "p1"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"2", ",", "p2"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", 
                 RowBox[{"-", "p"}]}], "}"}]}], "]"}]}], 
            "\[IndentingNewLine]", ",", 
            RowBox[{"{", 
             RowBox[{"p1", ",", 
              RowBox[{"-", " ", "1"}], ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"p2", ",", 
              RowBox[{"-", "2"}], ",", "2"}], "}"}]}], "]"}]}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"p", ",", 
           RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}]}], "+", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "nuc", " ", "nuc", " ", "spin", " ", "scalar", " ", "diag", " ", "in",
          " ", "N"}], ",", " ", 
        RowBox[{
         RowBox[{"mN", ".", " ", "\[CapitalDelta]mIRb"}], "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"-", "1"}], ".."}], "1", " ", "\[CapitalDelta]mICs"}], 
          "=", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"-", "1"}], ".."}], "1", "   ", "B"}], "&"}], "C", " ", 
           "8.319"}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"c4", "*", 
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"N1", ",", "N2"}], "]"}], " ", "*", " ", 
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"mN1", ",", "mN2"}], "]"}], "*", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], "p"], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], 
           RowBox[{
            RowBox[{"+", 
             SubscriptBox["i", "Rb"]}], "-", "mIRb1"}]], 
          RowBox[{"ThreeJSymbol", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              SubscriptBox["i", "Rb"], ",", 
              RowBox[{"-", "mIRb1"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "p"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              SubscriptBox["i", "Rb"], ",", "mIRb2"}], "}"}]}], "]"}], 
          RowBox[{"Sqrt", "[", 
           RowBox[{
            SubscriptBox["i", "Rb"], 
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["i", "Rb"], "+", "1"}], ")"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", 
               SubscriptBox["i", "Rb"]}], "+", "1"}], ")"}]}], "]"}], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], 
           RowBox[{
            RowBox[{"+", 
             SubscriptBox["i", "Cs"]}], "-", "mICs1"}]], 
          RowBox[{"ThreeJSymbol", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              SubscriptBox["i", "Cs"], ",", 
              RowBox[{"-", "mICs1"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", 
              RowBox[{"-", "p"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              SubscriptBox["i", "Cs"], ",", "mICs2"}], "}"}]}], "]"}], 
          RowBox[{"Sqrt", "[", 
           RowBox[{
            SubscriptBox["i", "Cs"], 
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["i", "Cs"], "+", "1"}], ")"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", 
               SubscriptBox["i", "Cs"]}], "+", "1"}], ")"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"p", ",", 
           RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"old", " ", "nuc", " ", "dip", " ", "dip"}], 
     "\[IndentingNewLine]", "-", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
        RowBox[{
        "nuc", " ", "nuc", " ", "spin", " ", "tensor", " ", 
         "\[CapitalDelta]N"}], "=", 
        RowBox[{"-", "2"}]}], ",", "0", ",", 
       RowBox[{
        RowBox[{"2", " ", "\[CapitalDelta]N"}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"-", "1"}], ".."}], "1", " ", "\[CapitalDelta]mIRb"}], "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"-", "1"}], ".."}], "1", " ", "\[CapitalDelta]mICs"}], 
          "=", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "1"}], ".."}], "1"}]}]}]}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Sqrt", "[", "30", "]"}], "*", "c3", " ", "*", 
      "\[IndentingNewLine]", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"-", "1"}], ")"}], 
          RowBox[{
           SubscriptBox["i", "Cs"], "-", "mICs1", "+", 
           SubscriptBox["i", "Rb"], "-", "mIRb1"}]], 
         RowBox[{"ThreeJSymbol", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             SubscriptBox["i", "Cs"], ",", 
             RowBox[{"-", "mICs1"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"-", "p"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             SubscriptBox["i", "Cs"], ",", "mICs2"}], "}"}]}], "]"}], 
         RowBox[{"Sqrt", "[", 
          RowBox[{
           SubscriptBox["i", "Rb"], 
           RowBox[{"(", 
            RowBox[{
             SubscriptBox["i", "Rb"], "+", "1"}], ")"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", 
              SubscriptBox["i", "Rb"]}], "+", "1"}], ")"}], 
           SubscriptBox["i", "Cs"], 
           RowBox[{"(", 
            RowBox[{
             SubscriptBox["i", "Cs"], "+", "1"}], ")"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", 
              SubscriptBox["i", "Cs"]}], "+", "1"}], ")"}]}], "]"}], 
         "\[IndentingNewLine]", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"-", "1"}], ")"}], "N1"], 
            RowBox[{"Sqrt", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"2", "N1"}], "+", "1"}], ")"}], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"2", "N2"}], "+", "1"}], ")"}]}], "]"}], 
            RowBox[{"ThreeJSymbol", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"N1", ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"2", ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"N2", ",", "0"}], "}"}]}], "]"}], 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"-", "1"}], ")"}], 
             RowBox[{"N1", "-", "mN1"}]], 
            RowBox[{"ThreeJSymbol", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"N1", ",", 
                RowBox[{"-", "mN1"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", "p1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"N2", ",", "mN2"}], "}"}]}], "]"}], 
            RowBox[{"ThreeJSymbol", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                SubscriptBox["i", "Rb"], ",", 
                RowBox[{"-", "mIRb1"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", 
                RowBox[{"-", "p2"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                SubscriptBox["i", "Rb"], ",", "mIRb2"}], "}"}]}], "]"}], 
            RowBox[{"ThreeJSymbol", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", "p1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"2", ",", "p2"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", 
                RowBox[{"-", "p"}]}], "}"}]}], "]"}]}], "\[IndentingNewLine]",
            ",", 
           RowBox[{"{", 
            RowBox[{"p1", ",", 
             RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"p2", ",", 
             RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}]}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"p", ",", 
          RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"HeffNofieldsNoQPNoiitensor", "[", 
      RowBox[{
      "mIRb1_", ",", "mICs1_", ",", "N1_", ",", "mN1_", ",", "mIRb2_", ",", 
       "mICs2_", ",", "N2_", ",", "mN2_"}], "]"}], ":=", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"rotation", " ", "diag", " ", "in", " ", "all"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"mIRb1", ",", "mIRb2"}], "]"}], " ", "*", " ", 
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"mICs1", ",", "mICs2"}], "]"}], "*", 
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"N1", ",", "N2"}], "]"}], " ", "*", " ", 
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"mN1", ",", "mN2"}], "]"}], "*", 
       SubscriptBox["B", "RbCs"], "N1", 
       RowBox[{"(", 
        RowBox[{"N1", "+", "1"}], ")"}]}], "+", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "Rb", " ", "spin", " ", "rot", " ", "diag", " ", "in", " ", "mICs"}], 
        ",", 
        RowBox[{
         RowBox[{"N", ".", " ", "\[CapitalDelta]mN"}], "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"-", "1"}], ".."}], "1", " ", "\[CapitalDelta]mIRb"}], 
          "=", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "1"}], ".."}], "1"}]}]}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       SubscriptBox["c", "Rb"], "*", 
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"mICs1", ",", "mICs2"}], "]"}], "*", 
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"N1", ",", "N2"}], "]"}], "*", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], 
           RowBox[{"p", "+", "N1", "-", "mN1", "+", 
            SubscriptBox["i", "Rb"], "-", "mIRb1"}]], 
          RowBox[{"Sqrt", "[", 
           RowBox[{"N1", 
            RowBox[{"(", 
             RowBox[{"N1", "+", "1"}], ")"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", "N1"}], "+", "1"}], ")"}], 
            SubscriptBox["i", "Rb"], 
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["i", "Rb"], "+", "1"}], ")"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", 
               SubscriptBox["i", "Rb"]}], "+", "1"}], ")"}]}], "]"}], 
          RowBox[{"ThreeJSymbol", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"N1", ",", 
              RowBox[{"-", "mN1"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "p"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"N1", ",", "mN2"}], "}"}]}], "]"}], 
          RowBox[{"ThreeJSymbol", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              SubscriptBox["i", "Rb"], ",", 
              RowBox[{"-", "mIRb1"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", 
              RowBox[{"-", "p"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              SubscriptBox["i", "Rb"], ",", "mIRb2"}], "}"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"p", ",", 
           RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}]}], "+", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "Cs", " ", "spin", " ", "rot", " ", "diag", " ", "in", " ", "mIRb"}], 
        ",", 
        RowBox[{
         RowBox[{"N", ".", " ", "\[CapitalDelta]mN"}], "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"-", "1"}], ".."}], "1", " ", "\[CapitalDelta]mICs"}], 
          "=", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "1"}], ".."}], "1"}]}]}]}], " ", "*)"}], 
      RowBox[{
       SubscriptBox["c", "Cs"], "*", 
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"mIRb1", ",", "mIRb2"}], "]"}], "*", 
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"N1", ",", "N2"}], "]"}], "*", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], 
           RowBox[{"p", "+", "N1", "-", "mN1", "+", 
            SubscriptBox["i", "Cs"], "-", "mICs1"}]], 
          RowBox[{"Sqrt", "[", 
           RowBox[{"N1", 
            RowBox[{"(", 
             RowBox[{"N1", "+", "1"}], ")"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", "N1"}], "+", "1"}], ")"}], 
            SubscriptBox["i", "Cs"], 
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["i", "Cs"], "+", "1"}], ")"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", 
               SubscriptBox["i", "Cs"]}], "+", "1"}], ")"}]}], "]"}], 
          RowBox[{"ThreeJSymbol", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"N1", ",", 
              RowBox[{"-", "mN1"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "p"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"N1", ",", "mN2"}], "}"}]}], "]"}], 
          RowBox[{"ThreeJSymbol", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              SubscriptBox["i", "Cs"], ",", 
              RowBox[{"-", "mICs1"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", 
              RowBox[{"-", "p"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              SubscriptBox["i", "Cs"], ",", "mICs2"}], "}"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"p", ",", 
           RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}]}], "+", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "nuc", " ", "nuc", " ", "spin", " ", "scalar", " ", "diag", " ", "in",
          " ", "N"}], ",", " ", 
        RowBox[{
         RowBox[{"mN", ".", " ", "\[CapitalDelta]mIRb"}], "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"-", "1"}], ".."}], "1", " ", "\[CapitalDelta]mICs"}], 
          "=", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "1"}], ".."}], "1"}]}]}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"c4", "*", 
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"N1", ",", "N2"}], "]"}], " ", "*", " ", 
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"mN1", ",", "mN2"}], "]"}], "*", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], "p"], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], 
           RowBox[{
            RowBox[{"+", 
             SubscriptBox["i", "Rb"]}], "-", "mIRb1"}]], 
          RowBox[{"ThreeJSymbol", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              SubscriptBox["i", "Rb"], ",", 
              RowBox[{"-", "mIRb1"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "p"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              SubscriptBox["i", "Rb"], ",", "mIRb2"}], "}"}]}], "]"}], 
          RowBox[{"Sqrt", "[", 
           RowBox[{
            SubscriptBox["i", "Rb"], 
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["i", "Rb"], "+", "1"}], ")"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", 
               SubscriptBox["i", "Rb"]}], "+", "1"}], ")"}]}], "]"}], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], 
           RowBox[{
            RowBox[{"+", 
             SubscriptBox["i", "Cs"]}], "-", "mICs1"}]], 
          RowBox[{"ThreeJSymbol", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              SubscriptBox["i", "Cs"], ",", 
              RowBox[{"-", "mICs1"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", 
              RowBox[{"-", "p"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              SubscriptBox["i", "Cs"], ",", "mICs2"}], "}"}]}], "]"}], 
          RowBox[{"Sqrt", "[", 
           RowBox[{
            SubscriptBox["i", "Cs"], 
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["i", "Cs"], "+", "1"}], ")"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", 
               SubscriptBox["i", "Cs"]}], "+", "1"}], ")"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"p", ",", 
           RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"HeffNofieldsNoiitensor", "[", 
      RowBox[{
      "mIRb1_", ",", "mICs1_", ",", "N1_", ",", "mN1_", ",", "mIRb2_", ",", 
       "mICs2_", ",", "N2_", ",", "mN2_"}], "]"}], ":=", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"rotation", " ", "diag", " ", "in", " ", "all"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"mIRb1", ",", "mIRb2"}], "]"}], " ", "*", " ", 
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"mICs1", ",", "mICs2"}], "]"}], "*", 
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"N1", ",", "N2"}], "]"}], " ", "*", " ", 
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"mN1", ",", "mN2"}], "]"}], "*", 
       SubscriptBox["B", "RbCs"], "N1", 
       RowBox[{"(", 
        RowBox[{"N1", "+", "1"}], ")"}]}], "+", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"RbQP", " ", "diag", " ", "in", " ", 
          RowBox[{"mICs", ".", " ", "\[CapitalDelta]N"}]}], "=", 
         RowBox[{"-", "2"}]}], ",", "0", ",", 
        RowBox[{
         RowBox[{"2", " ", "\[CapitalDelta]mN"}], "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], ".."}], "2", " ", "\[CapitalDelta]mIRb"}], 
          "=", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], ".."}], "2"}]}]}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["eqQ", "Rb"], "/", "4"}], ")"}], "*", 
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"mICs1", ",", "mICs2"}], "]"}], "*", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], 
           RowBox[{"p", "+", "N1", "-", "mN1"}]], 
          RowBox[{"ThreeJSymbol", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"N1", ",", 
              RowBox[{"-", "mN1"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"2", ",", "p"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"N2", ",", "mN2"}], "}"}]}], "]"}], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], "N1"], 
          RowBox[{"Sqrt", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", "N1"}], "+", "1"}], ")"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", "N2"}], "+", "1"}], ")"}]}], "]"}], 
          RowBox[{"ThreeJSymbol", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"N1", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"2", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"N2", ",", "0"}], "}"}]}], "]"}], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], 
           RowBox[{
            SubscriptBox["i", "Rb"], "-", "mIRb1"}]], 
          RowBox[{
           RowBox[{"ThreeJSymbol", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               SubscriptBox["i", "Rb"], ",", 
               RowBox[{"-", "mIRb1"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"2", ",", 
               RowBox[{"-", "p"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               SubscriptBox["i", "Rb"], ",", "mIRb2"}], "}"}]}], "]"}], "/", 
           RowBox[{"ThreeJSymbol", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               SubscriptBox["i", "Rb"], ",", 
               RowBox[{"-", 
                SubscriptBox["i", "Rb"]}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"2", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               SubscriptBox["i", "Rb"], ",", 
               SubscriptBox["i", "Rb"]}], "}"}]}], "]"}]}]}], ",", 
         RowBox[{"{", 
          RowBox[{"p", ",", 
           RowBox[{"-", "2"}], ",", "2"}], "}"}]}], "]"}]}], "+", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"CsQP", " ", "diag", " ", "in", " ", 
          RowBox[{"mIRb", ".", " ", "\[CapitalDelta]N"}]}], "=", 
         RowBox[{"-", "2"}]}], ",", "0", ",", 
        RowBox[{
         RowBox[{"2", " ", "\[CapitalDelta]mN"}], "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], ".."}], "2", " ", "\[CapitalDelta]mICs"}], 
          "=", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], ".."}], "2"}]}]}]}], " ", "*)"}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["eqQ", "Cs"], "/", "4"}], ")"}], "*", 
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"mIRb1", ",", "mIRb2"}], "]"}], "*", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], 
           RowBox[{"p", "+", "N1", "-", "mN1"}]], 
          RowBox[{"ThreeJSymbol", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"N1", ",", 
              RowBox[{"-", "mN1"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"2", ",", "p"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"N2", ",", "mN2"}], "}"}]}], "]"}], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], "N1"], 
          RowBox[{"Sqrt", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", "N1"}], "+", "1"}], ")"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", "N2"}], "+", "1"}], ")"}]}], "]"}], 
          RowBox[{"ThreeJSymbol", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"N1", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"2", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"N2", ",", "0"}], "}"}]}], "]"}], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], 
           RowBox[{
            SubscriptBox["i", "Cs"], "-", "mICs1"}]], 
          RowBox[{
           RowBox[{"ThreeJSymbol", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               SubscriptBox["i", "Cs"], ",", 
               RowBox[{"-", "mICs1"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"2", ",", 
               RowBox[{"-", "p"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               SubscriptBox["i", "Cs"], ",", "mICs2"}], "}"}]}], "]"}], "/", 
           RowBox[{"ThreeJSymbol", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               SubscriptBox["i", "Cs"], ",", 
               RowBox[{"-", 
                SubscriptBox["i", "Cs"]}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"2", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               SubscriptBox["i", "Cs"], ",", 
               SubscriptBox["i", "Cs"]}], "}"}]}], "]"}]}]}], ",", 
         RowBox[{"{", 
          RowBox[{"p", ",", 
           RowBox[{"-", "2"}], ",", "2"}], "}"}]}], "]"}]}], "+", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "Rb", " ", "spin", " ", "rot", " ", "diag", " ", "in", " ", "mICs"}], 
        ",", 
        RowBox[{
         RowBox[{"N", ".", " ", "\[CapitalDelta]mN"}], "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"-", "1"}], ".."}], "1", " ", "\[CapitalDelta]mIRb"}], 
          "=", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "1"}], ".."}], "1"}]}]}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       SubscriptBox["c", "Rb"], "*", 
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"mICs1", ",", "mICs2"}], "]"}], "*", 
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"N1", ",", "N2"}], "]"}], "*", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], 
           RowBox[{"p", "+", "N1", "-", "mN1", "+", 
            SubscriptBox["i", "Rb"], "-", "mIRb1"}]], 
          RowBox[{"Sqrt", "[", 
           RowBox[{"N1", 
            RowBox[{"(", 
             RowBox[{"N1", "+", "1"}], ")"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", "N1"}], "+", "1"}], ")"}], 
            SubscriptBox["i", "Rb"], 
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["i", "Rb"], "+", "1"}], ")"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", 
               SubscriptBox["i", "Rb"]}], "+", "1"}], ")"}]}], "]"}], 
          RowBox[{"ThreeJSymbol", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"N1", ",", 
              RowBox[{"-", "mN1"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "p"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"N1", ",", "mN2"}], "}"}]}], "]"}], 
          RowBox[{"ThreeJSymbol", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              SubscriptBox["i", "Rb"], ",", 
              RowBox[{"-", "mIRb1"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", 
              RowBox[{"-", "p"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              SubscriptBox["i", "Rb"], ",", "mIRb2"}], "}"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"p", ",", 
           RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}]}], "+", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "Cs", " ", "spin", " ", "rot", " ", "diag", " ", "in", " ", "mIRb"}], 
        ",", 
        RowBox[{
         RowBox[{"N", ".", " ", "\[CapitalDelta]mN"}], "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"-", "1"}], ".."}], "1", " ", "\[CapitalDelta]mICs"}], 
          "=", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "1"}], ".."}], "1"}]}]}]}], " ", "*)"}], 
      RowBox[{
       SubscriptBox["c", "Cs"], "*", 
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"mIRb1", ",", "mIRb2"}], "]"}], "*", 
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"N1", ",", "N2"}], "]"}], "*", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], 
           RowBox[{"p", "+", "N1", "-", "mN1", "+", 
            SubscriptBox["i", "Cs"], "-", "mICs1"}]], 
          RowBox[{"Sqrt", "[", 
           RowBox[{"N1", 
            RowBox[{"(", 
             RowBox[{"N1", "+", "1"}], ")"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", "N1"}], "+", "1"}], ")"}], 
            SubscriptBox["i", "Cs"], 
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["i", "Cs"], "+", "1"}], ")"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", 
               SubscriptBox["i", "Cs"]}], "+", "1"}], ")"}]}], "]"}], 
          RowBox[{"ThreeJSymbol", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"N1", ",", 
              RowBox[{"-", "mN1"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "p"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"N1", ",", "mN2"}], "}"}]}], "]"}], 
          RowBox[{"ThreeJSymbol", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              SubscriptBox["i", "Cs"], ",", 
              RowBox[{"-", "mICs1"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", 
              RowBox[{"-", "p"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              SubscriptBox["i", "Cs"], ",", "mICs2"}], "}"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"p", ",", 
           RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}]}], "+", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "nuc", " ", "nuc", " ", "spin", " ", "scalar", " ", "diag", " ", "in",
          " ", "N"}], ",", " ", 
        RowBox[{
         RowBox[{"mN", ".", " ", "\[CapitalDelta]mIRb"}], "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"-", "1"}], ".."}], "1", " ", "\[CapitalDelta]mICs"}], 
          "=", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "1"}], ".."}], "1"}]}]}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"c4", "*", 
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"N1", ",", "N2"}], "]"}], " ", "*", " ", 
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"mN1", ",", "mN2"}], "]"}], "*", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], "p"], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], 
           RowBox[{
            RowBox[{"+", 
             SubscriptBox["i", "Rb"]}], "-", "mIRb1"}]], 
          RowBox[{"ThreeJSymbol", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              SubscriptBox["i", "Rb"], ",", 
              RowBox[{"-", "mIRb1"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "p"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              SubscriptBox["i", "Rb"], ",", "mIRb2"}], "}"}]}], "]"}], 
          RowBox[{"Sqrt", "[", 
           RowBox[{
            SubscriptBox["i", "Rb"], 
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["i", "Rb"], "+", "1"}], ")"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", 
               SubscriptBox["i", "Rb"]}], "+", "1"}], ")"}]}], "]"}], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], 
           RowBox[{
            RowBox[{"+", 
             SubscriptBox["i", "Cs"]}], "-", "mICs1"}]], 
          RowBox[{"ThreeJSymbol", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              SubscriptBox["i", "Cs"], ",", 
              RowBox[{"-", "mICs1"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", 
              RowBox[{"-", "p"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              SubscriptBox["i", "Cs"], ",", "mICs2"}], "}"}]}], "]"}], 
          RowBox[{"Sqrt", "[", 
           RowBox[{
            SubscriptBox["i", "Cs"], 
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["i", "Cs"], "+", "1"}], ")"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", 
               SubscriptBox["i", "Cs"]}], "+", "1"}], ")"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"p", ",", 
           RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{
      "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", 
       "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
        "**", "**"}], "*", 
      RowBox[{
      "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", 
       "**", "**", "**"}]}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
     "Formulas", " ", "to", " ", "get", " ", "quantum", " ", "numbers", " ", 
      "from", " ", "Hamiltonian", " ", "matrix", " ", 
      RowBox[{"index", ".", "  ", "For"}], " ", "reference", " ", 
      RowBox[{"only", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{
      "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", 
       "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
        "**", "**"}], "*", 
      RowBox[{
      "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", 
       "**", "**", "**"}]}], " ", "*)"}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"mICs2", "[", "m_", "]"}], ":=", 
      RowBox[{
       RowBox[{"Mod", "[", 
        RowBox[{
         RowBox[{"Mod", "[", 
          RowBox[{
           RowBox[{"m", "-", "1"}], ",", "32"}], "]"}], ",", "8"}], "]"}], 
       "-", 
       RowBox[{"7", "/", "2"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"mIRb2", "[", "m_", "]"}], ":=", 
      RowBox[{
       RowBox[{"Quotient", "[", 
        RowBox[{
         RowBox[{"Mod", "[", 
          RowBox[{
           RowBox[{"m", "-", "1"}], ",", "32"}], "]"}], ",", "8"}], "]"}], 
       "-", 
       RowBox[{"3", "/", "2"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"N2", "[", "m_", "]"}], ":=", 
      RowBox[{"Floor", "[", 
       RowBox[{
        RowBox[{"Sqrt", "[", 
         RowBox[{"Quotient", "[", 
          RowBox[{
           RowBox[{"m", "-", "1"}], ",", "32"}], "]"}], "]"}], ",", "1"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"mN2", "[", "m_", "]"}], ":=", 
      RowBox[{
       RowBox[{"Quotient", "[", 
        RowBox[{
         RowBox[{"m", "-", "1"}], ",", "32"}], "]"}], "-", 
       RowBox[{
        RowBox[{"Floor", "[", 
         RowBox[{"Sqrt", "[", 
          RowBox[{"Quotient", "[", 
           RowBox[{
            RowBox[{"m", "-", "1"}], ",", "32"}], "]"}], "]"}], "]"}], "^", 
        "2"}], "-", 
       RowBox[{"Floor", "[", 
        RowBox[{"Sqrt", "[", 
         RowBox[{"Quotient", "[", 
          RowBox[{
           RowBox[{"m", "-", "1"}], ",", "32"}], "]"}], "]"}], "]"}]}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"N1", "[", "n_", "]"}], ":=", 
      RowBox[{"Floor", "[", 
       RowBox[{
        RowBox[{"Sqrt", "[", 
         RowBox[{"Quotient", "[", 
          RowBox[{
           RowBox[{"n", "-", "1"}], ",", "32"}], "]"}], "]"}], ",", "1"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"mN1", "[", "n_", "]"}], ":=", 
      RowBox[{
       RowBox[{"Quotient", "[", 
        RowBox[{
         RowBox[{"n", "-", "1"}], ",", "32"}], "]"}], "-", 
       RowBox[{
        RowBox[{"Floor", "[", 
         RowBox[{"Sqrt", "[", 
          RowBox[{"Quotient", "[", 
           RowBox[{
            RowBox[{"n", "-", "1"}], ",", "32"}], "]"}], "]"}], "]"}], "^", 
        "2"}], "-", 
       RowBox[{"Floor", "[", 
        RowBox[{"Sqrt", "[", 
         RowBox[{"Quotient", "[", 
          RowBox[{
           RowBox[{"n", "-", "1"}], ",", "32"}], "]"}], "]"}], "]"}]}]}], 
     ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
       "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
       "**"}], "*", 
     RowBox[{
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**"}], 
     "*"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Code", " ", "snippets", " ", "to", " ", "generate", " ", "matrices", " ",
      "and", " ", "save", " ", "to", " ", 
     RowBox[{"disk", ".", "  ", "Only"}], " ", "need", " ", "to", " ", "run", 
     " ", "once", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
       "Ignore", " ", "if", " ", "the", " ", "matrices", " ", "are", " ", 
        "already", " ", "generated"}], ")"}], "."}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
       "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
       "**"}], "*", 
     RowBox[{
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**"}], 
     "*"}], " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{"generate", " ", "field"}], "-", 
      RowBox[{"free", " ", "effective", " ", "Hamiltonian", " ", "matrix"}]}],
      " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Nmax", "=", "2"}], ";", " ", 
     RowBox[{"(*", " ", 
      RowBox[{
      "rotational", " ", "level", " ", "in", " ", "basis", " ", "set"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<Number of levels = \>\"", ",", 
       RowBox[{"Nlevels", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"Nmax", "+", "1"}], ")"}], "^", "2"}], "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", "  ", 
            SubscriptBox["i", "Rb"]}], "+", "1"}], ")"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", "*", 
            SubscriptBox["i", "Cs"]}], "+", "1"}], ")"}]}]}]}], "]"}], ";", 
     RowBox[{"(*", " ", 
      RowBox[{"number", " ", "of", " ", "levels"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"m", "=", " ", "0"}], ";", " ", "\n", 
     RowBox[{"H", "=", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"Nlevels", ",", "Nlevels"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"m", " ", "=", 
         RowBox[{"1", "+", 
          RowBox[{"(", 
           RowBox[{"mICs2", "-", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "7"}], "/", "2"}], ")"}]}], ")"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"mIRb2", "-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "3"}], "/", "2"}], ")"}]}], ")"}], "*", "8"}], 
          "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"mN2", "-", 
             RowBox[{"(", 
              RowBox[{"-", "N2"}], ")"}]}], ")"}], "*", "32"}], "+", 
          RowBox[{"32", "*", 
           RowBox[{"UnitStep", "[", 
            RowBox[{"N2", "-", ".5"}], "]"}], 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"2", "x"}], "+", "1"}], ",", 
             RowBox[{"{", 
              RowBox[{"x", ",", "0", ",", 
               RowBox[{"N2", "-", "1"}]}], "}"}]}], "]"}]}]}]}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"n", " ", "=", 
            RowBox[{"1", "+", 
             RowBox[{"(", 
              RowBox[{"mICs1", "-", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "7"}], "/", "2"}], ")"}]}], ")"}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"mIRb1", "-", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "3"}], "/", "2"}], ")"}]}], ")"}], "*", "8"}], 
             "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"mN1", "-", 
                RowBox[{"(", 
                 RowBox[{"-", "N1"}], ")"}]}], ")"}], "*", "32"}], "+", 
             RowBox[{"32", "*", 
              RowBox[{"UnitStep", "[", 
               RowBox[{"N1", "-", ".5"}], "]"}], 
              RowBox[{"Sum", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"2", "x"}], "+", "1"}], ",", 
                RowBox[{"{", 
                 RowBox[{"x", ",", "0", ",", 
                  RowBox[{"N1", "-", "1"}]}], "}"}]}], "]"}]}]}]}], ";", 
           RowBox[{
            RowBox[{"H", "[", 
             RowBox[{"[", 
              RowBox[{"m", ",", "n"}], "]"}], "]"}], "=", 
            RowBox[{"HeffNofields", "[", 
             RowBox[{
             "mIRb1", ",", "mICs1", ",", "N1", ",", "mN1", ",", "mIRb2", ",", 
              "mICs2", ",", "N2", ",", "mN2"}], "]"}]}], ";"}], 
          "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"N1", ",", 
            RowBox[{"Max", "[", 
             RowBox[{
              RowBox[{"N2", "-", "1"}], ",", "0"}], "]"}], ",", 
            RowBox[{"Min", "[", 
             RowBox[{
              RowBox[{"N2", "+", "1"}], ",", "Nmax"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"mN1", ",", 
            RowBox[{"Max", "[", 
             RowBox[{
              RowBox[{"mN2", "-", "2"}], ",", 
              RowBox[{"-", "N1"}]}], "]"}], ",", 
            RowBox[{"Min", "[", 
             RowBox[{
              RowBox[{"mN2", "+", "2"}], ",", "N1"}], "]"}]}], "}"}], ",", 
          " ", 
          RowBox[{"{", 
           RowBox[{"mIRb1", ",", 
            RowBox[{"Max", "[", 
             RowBox[{
              RowBox[{"mIRb2", "-", "2"}], ",", 
              RowBox[{"-", 
               SubscriptBox["i", "Rb"]}]}], "]"}], ",", " ", 
            RowBox[{"Min", "[", 
             RowBox[{
              RowBox[{"mIRb2", "+", "2"}], ",", 
              SubscriptBox["i", "Rb"]}], "]"}]}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"mICs1", ",", 
            RowBox[{"Max", "[", 
             RowBox[{
              RowBox[{"mICs2", "-", "2"}], ",", 
              RowBox[{"-", 
               SubscriptBox["i", "Cs"]}]}], "]"}], ",", " ", 
            RowBox[{"Min", "[", 
             RowBox[{
              RowBox[{"mICs2", "+", "2"}], ",", 
              SubscriptBox["i", "Cs"]}], "]"}]}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Mod", "[", 
            RowBox[{"m", ",", "100"}], "]"}], "==", "0"}], ",", 
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<row \>\"", ",", "m", ",", "\"\</\>\"", ",", "Nlevels"}], 
           "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"N2", ",", "0", ",", "Nmax"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"mN2", ",", 
         RowBox[{"-", "N2"}], ",", "N2"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"mIRb2", ",", 
         RowBox[{"-", 
          SubscriptBox["i", "Rb"]}], ",", " ", 
         SubscriptBox["i", "Rb"]}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"mICs2", ",", 
         RowBox[{"-", 
          SubscriptBox["i", "Cs"]}], ",", " ", 
         SubscriptBox["i", "Cs"]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"SetDirectory", "[", 
      StyleBox["libPath", "SearchResultSummary"], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"H", ">>", 
      RowBox[{"\"\<fieldfreematrixNmax2.nb\>\"", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", "\"\<done!\>\"", "]"}], "\[IndentingNewLine]", 
       RowBox[{"Quit", "[", "]"}]}]}]}], "\[IndentingNewLine]", "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"generate", " ", "Stark", " ", "Hamiltonian", " ", "matrices"}], 
     " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"fmin", "=", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"fmax", "=", "20"}], ";", "\[IndentingNewLine]", 
     RowBox[{"NF", "=", "21"}], ";", " ", 
     RowBox[{"(*", " ", 
      RowBox[{"number", " ", "of", " ", "fields"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"HStark", "[", 
       RowBox[{
       "mIRb1_", ",", "mICs1_", ",", "N1_", ",", "mN1_", ",", "mIRb2_", ",", 
        "mICs2_", ",", "N2_", ",", "mN2_", ",", "Ez_"}], "]"}], ":=", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
         RowBox[{
         "Stark", " ", "diag", " ", "in", " ", "mIRb", " ", "mICs", " ", 
          RowBox[{"mN", ".", "  ", "\[CapitalDelta]N"}]}], " ", "=", " ", 
         "0"}], ",", 
        RowBox[{"+", 
         RowBox[{"-", "1"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"-", " ", 
        RowBox[{"KroneckerDelta", "[", 
         RowBox[{"mIRb1", ",", "mIRb2"}], "]"}]}], " ", "*", " ", 
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"mICs1", ",", "mICs2"}], "]"}], "*", 
       SubscriptBox["d", "RbCs"], "*", "Ez", "*", 
       RowBox[{"Sqrt", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", "N1"}], "+", "1"}], ")"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", "N2"}], "+", "1"}], ")"}]}], "]"}], "*", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"-", "1"}], ")"}], "^", "mN1"}], "*", 
       RowBox[{"ThreeJSymbol", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"N1", ",", 
           RowBox[{"-", "mN1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"N2", ",", "mN2"}], "}"}]}], "]"}], "*", 
       RowBox[{"ThreeJSymbol", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"N1", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"N2", ",", "0"}], "}"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Nmax", "=", "2"}], ";", " ", 
     RowBox[{"(*", " ", 
      RowBox[{
      "highest", " ", "rotational", " ", "level", " ", "in", " ", "basis", 
       " ", "set"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<Number of levels = \>\"", ",", 
       RowBox[{"Nlevels", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"Nmax", "+", "1"}], ")"}], "^", "2"}], "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", "*", 
            SubscriptBox["i", "Rb"]}], "+", "1"}], ")"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", "*", 
            SubscriptBox["i", "Cs"]}], "+", "1"}], ")"}]}]}]}], "]"}], ";", 
     RowBox[{"(*", " ", 
      RowBox[{"number", " ", "of", " ", "levels"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"m", "=", " ", "0"}], ";", " ", "\n", 
     RowBox[{"(*", 
      RowBox[{"Do", "["}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"H", "=", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"Nlevels", ",", "Nlevels"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"m", " ", "=", 
         RowBox[{"1", "+", 
          RowBox[{"(", 
           RowBox[{"mICs2", "-", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "7"}], "/", "2"}], ")"}]}], ")"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"mIRb2", "-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "3"}], "/", "2"}], ")"}]}], ")"}], "*", "8"}], 
          "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"mN2", "-", 
             RowBox[{"(", 
              RowBox[{"-", "N2"}], ")"}]}], ")"}], "*", "32"}], "+", 
          RowBox[{"32", "*", 
           RowBox[{"N2", "^", "2"}]}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"n", " ", "=", 
            RowBox[{"1", "+", 
             RowBox[{"(", 
              RowBox[{"mICs2", "-", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "7"}], "/", "2"}], ")"}]}], ")"}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"mIRb2", "-", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "3"}], "/", "2"}], ")"}]}], ")"}], "*", "8"}], 
             "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"mN1", "-", 
                RowBox[{"(", 
                 RowBox[{"-", "N1"}], ")"}]}], ")"}], "*", "32"}], "+", 
             RowBox[{"32", "*", 
              RowBox[{"N1", "^", "2"}]}]}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"H", "[", 
             RowBox[{"[", 
              RowBox[{"m", ",", "n"}], "]"}], "]"}], "=", 
            RowBox[{"HStark", "[", 
             RowBox[{
             "mIRb2", ",", "mICs2", ",", "N1", ",", "mN1", ",", "mIRb2", ",", 
              "mICs2", ",", "N2", ",", "mN2", ",", "1"}], "]"}]}], ";"}], 
          "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"N1", ",", 
            RowBox[{"Max", "[", 
             RowBox[{
              RowBox[{"N2", "-", "1"}], ",", "0"}], "]"}], ",", 
            RowBox[{"Min", "[", 
             RowBox[{
              RowBox[{"N2", "+", "1"}], ",", "Nmax"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"mN1", ",", 
            RowBox[{"Max", "[", 
             RowBox[{
              RowBox[{"mN2", "-", "1"}], ",", 
              RowBox[{"-", "N1"}]}], "]"}], ",", 
            RowBox[{"Min", "[", 
             RowBox[{
              RowBox[{"mN2", "+", "1"}], ",", "N1"}], "]"}]}], "}"}]}], "]"}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Mod", "[", 
            RowBox[{"m", ",", "100"}], "]"}], "==", "0"}], ",", 
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<row \>\"", ",", "m", ",", "\"\</\>\"", ",", "Nlevels"}], 
           "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"N2", ",", "0", ",", "Nmax"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"mN2", ",", 
         RowBox[{"-", "N2"}], ",", "N2"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"mIRb2", ",", 
         RowBox[{"-", 
          SubscriptBox["i", "Rb"]}], ",", " ", 
         SubscriptBox["i", "Rb"]}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"mICs2", ",", 
         RowBox[{"-", 
          SubscriptBox["i", "Cs"]}], ",", " ", 
         SubscriptBox["i", "Cs"]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"SetDirectory", "[", 
      StyleBox["libPath", "SearchResultSummary"], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"H", ">>", 
        RowBox[{"\"\<Starkmatrix\>\"", "<>", 
         RowBox[{"ToString", "[", "field", "]"}], "<>", "\"\<.nb\>\""}]}], 
       ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"H", ">>", "\"\<StarkmatrixNmax2.nb\>\""}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
        RowBox[{",", " ", 
         RowBox[{"{", 
          RowBox[{"field", ",", " ", "fmin", ",", " ", "fmax", ",", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"fmax", "-", "fmin"}], ")"}], "/", 
            RowBox[{"(", 
             RowBox[{"NF", "-", "1"}], ")"}]}]}], "}"}]}], "]"}], ";"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Quit", "[", "]"}]}], "\[IndentingNewLine]", "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"generate", " ", "Zeeman", " ", "matrix"}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"HZeeman", "[", 
       RowBox[{
       "mIRb1_", ",", "mICs1_", ",", "N1_", ",", "mN1_", ",", "mIRb2_", ",", 
        "mICs2_", ",", "N2_", ",", "mN2_", ",", "Bz_"}], "]"}], ":=", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"nuc", " ", "Zeeman", " ", "diag", " ", "in", " ", "all"}], 
       " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"KroneckerDelta", "[", 
         RowBox[{"mIRb1", ",", "mIRb2"}], "]"}]}], " ", "*", " ", 
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"mICs1", ",", "mICs2"}], "]"}], "*", 
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"N1", ",", "N2"}], "]"}], " ", "*", " ", 
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"mN1", ",", "mN2"}], "]"}], "*", "\[IndentingNewLine]", 
       RowBox[{"(", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubscriptBox["g", 
             RowBox[{"i", ",", "Rb"}]], 
            RowBox[{"(", 
             RowBox[{"1", "-", "\[Sigma]Rb"}], ")"}], "mIRb1"}], "+", 
           RowBox[{
            SubscriptBox["g", 
             RowBox[{"i", ",", "Cs"}]], " ", 
            RowBox[{"(", 
             RowBox[{"1", "-", "\[Sigma]Cs"}], ")"}], "mICs1"}], "+", 
           RowBox[{
            SubscriptBox["g", "r"], "mN1"}]}], ")"}], " ", 
         SubscriptBox["\[Mu]", "Nuc"], " ", "Bz"}], " ", 
        "\[IndentingNewLine]", ")"}]}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"Nmax", "=", "2"}], ";", " ", 
     RowBox[{"(*", " ", 
      RowBox[{
      "highest", " ", "rotational", " ", "level", " ", "in", " ", "basis", 
       " ", "set"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<Number of levels = \>\"", ",", 
       RowBox[{"Nlevels", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"Nmax", "+", "1"}], ")"}], "^", "2"}], "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", "  ", 
            SubscriptBox["i", "Rb"]}], "+", "1"}], ")"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", "*", 
            SubscriptBox["i", "Cs"]}], "+", "1"}], ")"}]}]}]}], "]"}], ";", 
     RowBox[{"(*", " ", 
      RowBox[{"number", " ", "of", " ", "levels"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"H", "=", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"Nlevels", ",", "Nlevels"}], "}"}]}], "]"}]}], ";", "\n", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"m", " ", "=", 
         RowBox[{"1", "+", 
          RowBox[{"(", 
           RowBox[{"mICs2", "-", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "7"}], "/", "2"}], ")"}]}], ")"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"mIRb2", "-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "3"}], "/", "2"}], ")"}]}], ")"}], "*", "8"}], 
          "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"mN2", "-", 
             RowBox[{"(", 
              RowBox[{"-", "N2"}], ")"}]}], ")"}], "*", "32"}], "+", 
          RowBox[{"32", "*", 
           RowBox[{"N2", "^", "2"}]}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"H", "[", 
          RowBox[{"[", 
           RowBox[{"m", ",", "m"}], "]"}], "]"}], "=", 
         RowBox[{"HZeeman", "[", 
          RowBox[{
          "mIRb2", ",", "mICs2", ",", "N2", ",", "mN2", ",", "mIRb2", ",", 
           "mICs2", ",", "N2", ",", "mN2", ",", "1"}], "]"}]}], ";"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"N2", ",", "0", ",", "Nmax"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"mN2", ",", 
         RowBox[{"-", "N2"}], ",", "N2"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"mIRb2", ",", 
         RowBox[{"-", 
          SubscriptBox["i", "Rb"]}], ",", " ", 
         SubscriptBox["i", "Rb"]}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"mICs2", ",", 
         RowBox[{"-", 
          SubscriptBox["i", "Cs"]}], ",", " ", 
         SubscriptBox["i", "Cs"]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"SetDirectory", "[", "libPath", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"H", ">>", "\"\<ZeemanmatrixNmax2.nb\>\""}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "\"\<done!\>\"", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Quit", "[", "]"}]}], "\[IndentingNewLine]", "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", 
     "**"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"single", " ", "field", " ", "calculations"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", 
     "**"}], " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Nmax", "=", "2"}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "Highest", " ", "N", " ", "rotational", " ", "quantum", " ", "number", 
      " ", "in", " ", "basis", " ", 
      RowBox[{"set", ".", "  ", "Ground"}], " ", "state", " ", "has", " ", 
      "N"}], "=", "0."}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"field", "=", "181.5"}], ";"}], "  ", 
   RowBox[{"(*", " ", 
    RowBox[{"magnetic", " ", "field", " ", "in", " ", "G"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"field", "=", "314"}], ";"}], "  ", 
    RowBox[{"(*", " ", 
     RowBox[{"magnetic", " ", "field", " ", "in", " ", "G"}], " ", "*)"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<Field = \>\"", ",", "field", ",", "\"\< G.\>\""}], "]"}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<Number of levels in basis set = \>\"", ",", 
      RowBox[{"Nlevels", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Nmax", "+", "1"}], ")"}], "^", "2"}], "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", "  ", 
           SubscriptBox["i", "Rb"]}], "+", "1"}], ")"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", "*", 
           SubscriptBox["i", "Cs"]}], "+", "1"}], ")"}]}]}]}], "]"}], ";"}], 
   RowBox[{"(*", " ", 
    RowBox[{"NL", " ", "=", " ", 
     RowBox[{
     "number", " ", "of", " ", "levels", " ", "in", " ", "basis", " ", 
      "set"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Timing", "[", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"!", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"ValueQ", "[", "H0", "]"}], "&&", 
         RowBox[{"ValueQ", "[", "HS", "]"}], "&&", 
         RowBox[{"ValueQ", "[", "HZ", "]"}], "&&", 
         RowBox[{"ValueQ", "[", "hdata", "]"}], "&&", 
         RowBox[{"ValueQ", "[", "vdata", "]"}]}], ")"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Print", "[", "\"\<loading data and matrices...\>\"", "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"SetDirectory", "[", 
        StyleBox["libPath", "SearchResultSummary"], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"H0", "=", 
        RowBox[{"<<", "\"\<fieldfreematrixNmax2.nb\>\""}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"HS", "=", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"Nlevels", ",", "Nlevels"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"HZ", "=", 
        RowBox[{"<<", "\"\<ZeemanmatrixNmax2.nb\>\""}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", "\"\<finished!\>\"", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"SetDirectory", "[", "BasePath", "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", "]"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Energies", "=", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"0", ",", "Nlevels"}], "]"}]}], ";"}], "  ", 
   RowBox[{"(*", " ", 
    RowBox[{
    "matrix", " ", "containing", " ", "energy", " ", "levels", " ", "for", 
     " ", "each", " ", "field"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"H0", "=", 
     RowBox[{"H0", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"Range", "[", 
         RowBox[{"1", ",", "Nlevels"}], "]"}], ",", 
        RowBox[{"Range", "[", 
         RowBox[{"1", ",", "Nlevels"}], "]"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"HS", "=", 
     RowBox[{"HS", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"Range", "[", 
         RowBox[{"1", ",", "Nlevels"}], "]"}], ",", 
        RowBox[{"Range", "[", 
         RowBox[{"1", ",", "Nlevels"}], "]"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"HZ", "=", 
     RowBox[{"HZ", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"Range", "[", 
         RowBox[{"1", ",", "Nlevels"}], "]"}], ",", 
        RowBox[{"Range", "[", 
         RowBox[{"1", ",", "Nlevels"}], "]"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MatrixForm", "[", 
     RowBox[{"H0", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"Range", "[", 
         RowBox[{"1", ",", "64"}], "]"}], ",", 
        RowBox[{"Range", "[", 
         RowBox[{"1", ",", "64"}], "]"}]}], "]"}], "]"}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MatrixForm", "[", 
     RowBox[{"HS", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"Range", "[", 
         RowBox[{"1", ",", "64"}], "]"}], ",", 
        RowBox[{"Range", "[", 
         RowBox[{"1", ",", "64"}], "]"}]}], "]"}], "]"}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MatrixForm", "[", 
     RowBox[{"HZ", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"Range", "[", 
         RowBox[{"1", ",", "64"}], "]"}], ",", 
        RowBox[{"Range", "[", 
         RowBox[{"1", ",", "64"}], "]"}]}], "]"}], "]"}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"H1", "=", 
     RowBox[{"H0", "+", "HS"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Energies", " ", "=", 
     RowBox[{
      RowBox[{"Sort", "[", 
       RowBox[{
        RowBox[{"Eigenvalues", "[", 
         RowBox[{"H1", "+", 
          RowBox[{"HZ", "*", "field"}]}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"Range", "[", 
          RowBox[{
           RowBox[{"Nlevels", "-", "31"}], ",", "Nlevels"}], "]"}], "]"}], 
        "]"}], "]"}], "/", "h"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"UnorderedEnergies", " ", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Eigenvalues", "[", 
        RowBox[{"H1", "+", 
         RowBox[{"HZ", "*", "field"}]}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"Range", "[", 
         RowBox[{
          RowBox[{"Nlevels", "-", "31"}], ",", "Nlevels"}], "]"}], "]"}], 
       "]"}], "/", "h"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"order", "=", 
     RowBox[{"Ordering", "[", "UnorderedEnergies", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"UnorderedStates", "=", 
     RowBox[{
      RowBox[{"Eigenvectors", "[", 
       RowBox[{"H1", "+", 
        RowBox[{"HZ", "*", "field"}]}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"Range", "[", 
        RowBox[{
         RowBox[{"Nlevels", "-", "31"}], ",", "Nlevels"}], "]"}], "]"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MatrixForm", "[", "UnorderedStates", "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"States", "=", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"0", ",", 
       RowBox[{"{", 
        RowBox[{"32", ",", "32"}], "}"}]}], "]"}]}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
    "state", " ", "vectors", " ", "in", " ", "order", " ", "of", " ", 
     "increasing", " ", "energy"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SigStates", "=", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"0", ",", 
       RowBox[{"{", 
        RowBox[{"32", ",", "4", ",", "8"}], "}"}]}], "]"}]}], ";"}], "  ", 
   RowBox[{"(*", " ", 
    RowBox[{"spin", " ", "state", " ", "matrices", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"rows", " ", "miRb"}], ",", " ", 
       RowBox[{"columns", " ", "miCs"}]}], ")"}], " ", "in", " ", "order", 
     " ", "of", " ", "increasing", " ", "energy"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"States", "[", 
         RowBox[{"[", "m", "]"}], "]"}], "=", 
        RowBox[{
         RowBox[{"UnorderedStates", "[", 
          RowBox[{"[", 
           RowBox[{"order", "[", 
            RowBox[{"[", "m", "]"}], "]"}], "]"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"Range", "[", 
           RowBox[{"1", ",", "32"}], "]"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Abs", "[", 
              RowBox[{
               RowBox[{"States", "[", 
                RowBox[{"[", "m", "]"}], "]"}], "[", 
               RowBox[{"[", "j", "]"}], "]"}], "]"}], ">", "0.000001"}], ",", 
            " ", 
            RowBox[{
             RowBox[{"SigStates", "[", 
              RowBox[{"[", 
               RowBox[{"m", ",", 
                RowBox[{
                 RowBox[{"Quotient", "[", 
                  RowBox[{
                   RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"j", "-", "1"}], ",", "32"}], "]"}], ",", "8"}], 
                  "]"}], "+", "1"}], ",", 
                RowBox[{
                 RowBox[{"Mod", "[", 
                  RowBox[{
                   RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"j", "-", "1"}], ",", "32"}], "]"}], ",", "8"}], 
                  "]"}], "+", "1"}]}], " ", "]"}], "]"}], "=", 
             RowBox[{
              RowBox[{"States", "[", 
               RowBox[{"[", "m", "]"}], "]"}], "[", 
              RowBox[{"[", "j", "]"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"States", "[", 
               RowBox[{"[", "m", "]"}], "]"}], "[", 
              RowBox[{"[", "j", "]"}], "]"}], "=", "0"}]}], "]"}], ";"}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "32"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Energy=\>\"", ",", 
         RowBox[{"ScientificForm", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Energies", "[", 
             RowBox[{"[", "m", "]"}], "]"}], "/", 
            RowBox[{"10", "^", "6"}]}], ",", "6"}], "]"}], ",", 
         "\"\< MHz, spin state=\>\"", ",", 
         RowBox[{"MatrixForm", "[", 
          RowBox[{"SigStates", "[", 
           RowBox[{"[", "m", "]"}], "]"}], "]"}]}], "]"}], ";"}], 
      "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "1", ",", "32"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"gsenergy", "=", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"0", ",", "10"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"gsenergy", "[", 
         RowBox[{"[", "m", "]"}], "]"}], "=", 
        RowBox[{
         RowBox[{"Energies", "[", 
          RowBox[{"[", "m", "]"}], "]"}], "/", 
         RowBox[{"10", "^", "6"}]}]}], ";"}], "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "1", ",", "10"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Export", "[", 
     RowBox[{"\"\<groundstate_energy_181p5G.csv\>\"", ",", "gsenergy"}], 
     "]"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<level 1 to level 10 splitting = \>\"", ",", 
     RowBox[{
      RowBox[{"Energies", "[", 
       RowBox[{"[", "10", "]"}], "]"}], "-", 
      RowBox[{
       RowBox[{"Energies", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "/", 
       RowBox[{"10", "^", "6"}]}]}], ",", " ", "\"\< MHz\>\""}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"mIRbX", "=", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"0", ",", 
       RowBox[{"{", 
        RowBox[{"32", ",", "32"}], "}"}]}], "]"}]}], " ", ";"}], 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"mIRb", " ", "operator", " ", "for", " ", 
      RowBox[{"J", "''"}]}], "=", 
     RowBox[{"0", " ", "subspace"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"mICsX", "=", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"0", ",", 
       RowBox[{"{", 
        RowBox[{"32", ",", "32"}], "}"}]}], "]"}]}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"mICs", " ", "operator", " ", "for", " ", 
      RowBox[{"J", "''"}]}], "=", 
     RowBox[{"0", " ", "subspace"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"m", " ", "=", 
        RowBox[{"1", "+", 
         RowBox[{"(", 
          RowBox[{"mICs2", "-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "7"}], "/", "2"}], ")"}]}], ")"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"mIRb2", "-", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "3"}], "/", "2"}], ")"}]}], ")"}], "*", "8"}]}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"mIRbX", "[", 
         RowBox[{"[", 
          RowBox[{"m", ",", "m"}], "]"}], "]"}], "=", "mIRb2"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"mICsX", "[", 
         RowBox[{"[", 
          RowBox[{"m", ",", "m"}], "]"}], "]"}], "=", "mICs2"}], ";"}], 
      "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"mIRb2", ",", 
        RowBox[{"-", 
         SubscriptBox["i", "Rb"]}], ",", " ", 
        SubscriptBox["i", "Rb"]}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"mICs2", ",", 
        RowBox[{"-", 
         SubscriptBox["i", "Cs"]}], ",", " ", 
        SubscriptBox["i", "Cs"]}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"mIRbXs", "=", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"0", ",", "32"}], "]"}]}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
    "vector", " ", "with", " ", "mIRb", " ", "expectation", " ", "values"}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"mICsXs", "=", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"0", ",", "32"}], "]"}]}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
    "vector", " ", "with", " ", "mICs", " ", "expectation", " ", "values"}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MXs", "=", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"0", ",", "32"}], "]"}]}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
    "vector", " ", "with", " ", "M", " ", "expectation", " ", "values"}], " ",
     "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"M2Xs", "=", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"0", ",", "32"}], "]"}]}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"vector", " ", "with", " ", "M"}], "=", 
     RowBox[{"2", " ", "character"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"M3Xs", "=", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"0", ",", "32"}], "]"}]}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"vector", " ", "with", " ", "M"}], "=", 
     RowBox[{"3", " ", "character"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"M4Xs", "=", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"0", ",", "32"}], "]"}]}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"vector", " ", "with", " ", "M"}], "=", 
     RowBox[{"4", " ", "character"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"M5Xs", "=", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"0", ",", "32"}], "]"}]}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"vector", " ", "with", " ", "M"}], "=", 
     RowBox[{"5", " ", "character"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"mIRbXs", "[", 
         RowBox[{"[", "m", "]"}], "]"}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"States", "[", 
           RowBox[{"[", "m", "]"}], "]"}], ".", "mIRbX", ".", 
          RowBox[{"States", "[", 
           RowBox[{"[", "m", "]"}], "]"}]}], "/", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"States", "[", 
            RowBox[{"[", "m", "]"}], "]"}], ".", 
           RowBox[{"States", "[", 
            RowBox[{"[", "m", "]"}], "]"}]}], ")"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"mICsXs", "[", 
         RowBox[{"[", "m", "]"}], "]"}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"States", "[", 
           RowBox[{"[", "m", "]"}], "]"}], ".", "mICsX", ".", 
          RowBox[{"States", "[", 
           RowBox[{"[", "m", "]"}], "]"}]}], "/", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"States", "[", 
            RowBox[{"[", "m", "]"}], "]"}], ".", 
           RowBox[{"States", "[", 
            RowBox[{"[", "m", "]"}], "]"}]}], ")"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"mIRbXs", "[", 
            RowBox[{"[", "m", "]"}], "]"}], "+", 
           RowBox[{"mICsXs", "[", 
            RowBox[{"[", "m", "]"}], "]"}]}], "==", "2"}], ",", 
         RowBox[{
          RowBox[{"M2Xs", "[", 
           RowBox[{"[", "m", "]"}], "]"}], "=", "1"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"mIRbXs", "[", 
            RowBox[{"[", "m", "]"}], "]"}], "+", 
           RowBox[{"mICsXs", "[", 
            RowBox[{"[", "m", "]"}], "]"}]}], "==", "3"}], ",", 
         RowBox[{
          RowBox[{"M3Xs", "[", 
           RowBox[{"[", "m", "]"}], "]"}], "=", "1"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"mIRbXs", "[", 
            RowBox[{"[", "m", "]"}], "]"}], "+", 
           RowBox[{"mICsXs", "[", 
            RowBox[{"[", "m", "]"}], "]"}]}], "==", "4"}], ",", 
         RowBox[{
          RowBox[{"M4Xs", "[", 
           RowBox[{"[", "m", "]"}], "]"}], "=", "1"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"mIRbXs", "[", 
            RowBox[{"[", "m", "]"}], "]"}], "+", 
           RowBox[{"mICsXs", "[", 
            RowBox[{"[", "m", "]"}], "]"}]}], "==", "5"}], ",", 
         RowBox[{
          RowBox[{"M5Xs", "[", 
           RowBox[{"[", "m", "]"}], "]"}], "=", "1"}]}], "]"}], ";"}], 
      "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "1", ",", "32"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MXs", "=", 
     RowBox[{"mIRbXs", "+", "mICsXs"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SetDirectory", "[", "libPath", "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"excitedspinstate1", "=", 
     RowBox[{"<<", "\"\<stirap1_down_state_vector_181p5G.nb\>\""}]}], ";"}], 
   "  ", 
   RowBox[{"(*", " ", 
    RowBox[{
    "3", "x32", " ", "matrix", " ", "with", " ", "spin", " ", "states", " ", 
     "for", " ", "each", " ", "mJ", " ", "component", " ", "of", " ", 
     "STIRAP1", " ", "excited", " ", "state", " ", "at", " ", "181.5", " ", 
     "G", " ", "generated", " ", "in", " ", 
     RowBox[{"excitedstate_TDMs", ".", 
      RowBox[{"nb", "'"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<XStates (each row is a state, in spin basis) \>\"", ",", " ", 
     RowBox[{"MatrixForm", "[", "States", "]"}]}], "]"}], "  ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "matrix", " ", "containing", " ", "all", " ", "ground", " ", "states"}], 
     ",", " ", 
     RowBox[{"in", " ", "spin", " ", "basis"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<XStates*M5Xs (each row is a state, in spin basis) \>\"", ",", 
     RowBox[{"MatrixForm", "[", 
      RowBox[{"States", "*", "M5Xs"}], "]"}]}], "]"}], "  ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"matrix", " ", "containing", " ", "M"}], "=", 
      RowBox[{"5", "  ", "ground", " ", "states"}]}], ",", " ", 
     RowBox[{"in", " ", "spin", " ", "basis"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<XStates*M4Xs (each row is a state, in spin basis) \>\"", ",", 
     RowBox[{"MatrixForm", "[", 
      RowBox[{"States", "*", "M4Xs"}], "]"}]}], "]"}], "  ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"matrix", " ", "containing", " ", "M"}], "=", 
      RowBox[{"4", "  ", "ground", " ", "states"}]}], ",", " ", 
     RowBox[{"in", " ", "spin", " ", "basis"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<XStates*M3Xs (each row is a state, in spin basis) \>\"", ",", 
     RowBox[{"MatrixForm", "[", 
      RowBox[{"States", "*", "M3Xs"}], "]"}]}], "]"}], "  ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"matrix", " ", "containing", " ", "M"}], "=", 
      RowBox[{"3", "  ", "ground", " ", "states"}]}], ",", " ", 
     RowBox[{"in", " ", "spin", " ", "basis"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Print", "[", 
    RowBox[{
    "\"\<XStates*M5Xs.(excitedspinstate1[[1]]+excitedspinstate1[[2]]+\
excitedspinstate1[[3]]) spin overlap for STIRAP1 sigma+ transitions \>\"", 
     ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"States", "*", "M5Xs"}], ")"}], ".", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"excitedspinstate1", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "+", 
        RowBox[{"excitedspinstate1", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "+", 
        RowBox[{"excitedspinstate1", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}], ")"}]}]}], "  ", "]"}], "  ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
      "spin", " ", "overlap", " ", "of", " ", "STIRAP1", " ", "excited", " ", 
       "state", " ", "with", " ", "J"}], "=", "0"}], ",", " ", 
     RowBox[{"M", "=", 
      RowBox[{
       RowBox[{"5", " ", "ground", " ", 
        RowBox[{"states", " ", "--"}]}], "-", " ", "sigma", "+", " ", 
       "transition"}]}]}], " ", "*)"}], "  ", 
   RowBox[{"(*", " ", 
    RowBox[{
    "This", " ", "works", " ", "because", " ", "all", " ", "rot", " ", 
     "elements", " ", "are", " ", 
     RowBox[{"equal", ".", "  ", "See"}], " ", 
     RowBox[{"below", "."}]}], "  ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Print", "[", 
    RowBox[{
    "\"\<XStates*M4Xs.(excitedspinstate[[1]]+excitedspinstate[[2]]+\
excitedspinstate[[3]]) spin overlap for STIRAP1 pi transitions \>\"", ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"States", "*", "M4Xs"}], ")"}], ".", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"excitedspinstate1", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "+", 
        RowBox[{"excitedspinstate1", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "+", 
        RowBox[{"excitedspinstate1", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}], ")"}]}]}], " ", "]"}], "  ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
      "spin", " ", "overlap", " ", "of", " ", "STIRAP1", " ", "excited", " ", 
       "state", " ", "with", " ", "J"}], "=", "0"}], ",", " ", 
     RowBox[{"M", "=", 
      RowBox[{
       RowBox[{"4", " ", "ground", " ", 
        RowBox[{"states", " ", "--"}]}], "-", " ", 
       RowBox[{"pi", " ", "transition"}]}]}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Print", "[", 
    RowBox[{
    "\"\<XStates*M3Xs.(excitedspinstate[[1]]+excitedspinstate[[2]]+\
excitedspinstate[[3]]) spin overlap for STIRAP1 sigma- transitions \>\"", ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"States", "*", "M3Xs"}], ")"}], ".", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"excitedspinstate1", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "+", 
        RowBox[{"excitedspinstate1", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "+", 
        RowBox[{"excitedspinstate1", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}], ")"}]}]}], " ", "]"}], "   ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
      "spin", " ", "overlap", " ", "of", " ", "STIRAP1", " ", "excited", " ", 
       "state", " ", "with", " ", "J"}], "=", "0"}], ",", " ", 
     RowBox[{"M", "=", 
      RowBox[{
       RowBox[{"3", " ", "ground", " ", 
        RowBox[{"states", " ", "--"}]}], "-", " ", "sigma", "-", " ", 
       "transition"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["\[Phi]", "rot"], "=", 
     RowBox[{"Sqrt", "[", 
      RowBox[{"2", "/", "3"}], "]"}]}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{"the", " ", "rotational", " ", "part", " ", 
     RowBox[{"from", " ", "'"}], 
     RowBox[{"lib", "/", "Rotational_part"}], "_of", "_E1", "_TDM", 
     RowBox[{"_GS", ".", 
      RowBox[{"nb", "'"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"uvmixingD", "=", 
     RowBox[{"-", "0.003975"}]}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{"ground", "-", 
     RowBox[{"state", " ", "elec"}], "-", 
     RowBox[{"vib", " ", "moment", " ", "calculated", " ", 
      RowBox[{"from", " ", "'"}], 
      RowBox[{"lib", "/", "Elec_vib"}], "_moment", "_", "181", 
      RowBox[{"p5G", ".", 
       RowBox[{"nb", "'"}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<STIRAP1 E1 moment for vh\>\"", ",", 
     RowBox[{"\[Omega]XE1h", "=", 
      RowBox[{"Abs", "[", 
       RowBox[{
        SubscriptBox["\[Phi]", "rot"], "*", "uvmixingD", "*", 
        RowBox[{"(", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"States", "*", "M5Xs"}], ")"}], ".", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"excitedspinstate1", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "+", 
             RowBox[{"excitedspinstate1", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "+", 
             RowBox[{"excitedspinstate1", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"States", "*", "M3Xs"}], ")"}], ".", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"excitedspinstate1", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "+", 
             RowBox[{"excitedspinstate1", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "+", 
             RowBox[{"excitedspinstate1", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], ")"}]}]}], ")"}]}], "]"}]}]}],
     "]"}], "  ", 
   RowBox[{"(*", " ", 
    RowBox[{"E1", " ", "moment"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<STIRAP1 E1 moment for vv\>\"", ",", 
     RowBox[{"\[Omega]XE1v", "=", 
      RowBox[{"Abs", "[", 
       RowBox[{
        SubscriptBox["\[Phi]", "rot"], "*", "uvmixingD", "*", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"States", "*", "M4Xs"}], ")"}], ".", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"excitedspinstate1", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "+", 
           RowBox[{"excitedspinstate1", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "+", 
           RowBox[{"excitedspinstate1", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}], ")"}]}]}], "]"}]}]}], "]"}], 
   " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SetDirectory", "[", "outputPath", "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"field", "==", "181.5"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ns", "=", "10"}], ";", "\[IndentingNewLine]", 
       RowBox[{"PlotXEnergy", "=", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"ns", ",", "2"}], "}"}]}], "]"}]}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{"all", " ", "lines"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"PlotXhE1", "=", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"ns", ",", "2"}], "}"}]}], "]"}]}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{"hpol", " ", "Rabi", " ", "spectrum"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"PlotXvE1", "=", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"ns", ",", "2"}], "}"}]}], "]"}]}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{"vpol", " ", "Rabi", " ", "spectrum"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"graphoffset", "=", 
        RowBox[{
         RowBox[{"Energies", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "/", 
         RowBox[{"10", "^", "6"}]}]}], ";", "  ", 
       RowBox[{"(*", " ", 
        RowBox[{
        "calculated", " ", "lines", " ", "offset", " ", "in", " ", "MHz"}], 
        " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"PlotXhE1", "[", 
             RowBox[{"[", "m", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "=", 
           RowBox[{
            RowBox[{
             RowBox[{"Energies", "[", 
              RowBox[{"[", "m", "]"}], "]"}], "/", 
             RowBox[{"10", "^", "6"}]}], "-", "graphoffset"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"PlotXvE1", "[", 
             RowBox[{"[", "m", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "=", 
           RowBox[{
            RowBox[{
             RowBox[{"Energies", "[", 
              RowBox[{"[", "m", "]"}], "]"}], "/", 
             RowBox[{"10", "^", "6"}]}], "-", "graphoffset"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"PlotXEnergy", "[", 
             RowBox[{"[", "m", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "=", 
           RowBox[{
            RowBox[{
             RowBox[{"Energies", "[", 
              RowBox[{"[", "m", "]"}], "]"}], "/", 
             RowBox[{"10", "^", "6"}]}], "-", "graphoffset"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"PlotXhE1", "[", 
             RowBox[{"[", "m", "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], "=", 
           RowBox[{
            RowBox[{"\[Omega]XE1h", "[", 
             RowBox[{"[", "m", "]"}], "]"}], "*", 
            RowBox[{"10", "^", "4"}]}]}], ";", " ", 
          RowBox[{"(*", 
           RowBox[{"*", " ", "in", " ", "x", " ", 
            RowBox[{"10", "^", 
             RowBox[{"-", "4"}]}], " ", "ea0"}], " ", "**)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"PlotXvE1", "[", 
             RowBox[{"[", "m", "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], "=", 
           RowBox[{
            RowBox[{"\[Omega]XE1v", "[", 
             RowBox[{"[", "m", "]"}], "]"}], "*", 
            RowBox[{"10", "^", "4"}]}]}], ";", 
          RowBox[{"(*", 
           RowBox[{"*", " ", "in", " ", "x", " ", 
            RowBox[{"10", "^", 
             RowBox[{"-", "4"}]}], " ", "ea0"}], " ", "**)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"PlotXEnergy", "[", 
             RowBox[{"[", "m", "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], "=", "1"}], ";"}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"m", ",", "1", ",", "ns"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"yoffset", "=", "0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"SetOptions", "[", 
        RowBox[{"ListPlot", ",", 
         RowBox[{"ImageSize", " ", "->", " ", 
          RowBox[{"{", 
           RowBox[{"700", ",", " ", "550"}], "}"}]}], ",", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", ".1"}], ",", "1.0"}], "}"}], ",", "Automatic"}], 
           "}"}]}], ",", 
         RowBox[{"Ticks", "\[Rule]", "Automatic"}], ",", 
         RowBox[{"AxesOrigin", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "0.1"}], ",", "Automatic"}], "}"}]}], " ", ",", 
         RowBox[{"Axes", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"True", ",", "True"}], "}"}]}], ",", 
         RowBox[{"FrameTicksStyle", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"24", ",", "24"}], "}"}]}], ",", " ", 
         RowBox[{"ImagePadding", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"100", ",", "100"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"100", ",", "100"}], "}"}]}], "}"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"p1", "=", 
        RowBox[{"ListPlot", "[", 
         RowBox[{"PlotXhE1", ",", 
          RowBox[{"Filling", "\[Rule]", "Axis"}], ",", 
          RowBox[{"PlotStyle", "\[Rule]", "Red"}], ",", 
          RowBox[{"FillingStyle", "\[Rule]", "Red"}], ",", 
          RowBox[{"Frame", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"True", ",", "True", ",", "True", ",", "True"}], "}"}]}], 
          ",", 
          RowBox[{"FrameTicks", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"All", ",", "None"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"All", ",", "None"}], "}"}]}], "}"}]}], ",", 
          RowBox[{"FrameStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
            "Automatic", ",", "Red", ",", "Automatic", ",", "Automatic"}], 
            "}"}]}], ",", 
          RowBox[{"PlotRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", ".1"}], ",", "0.6"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "40"}], "}"}]}], "}"}]}], ",", " ", 
          RowBox[{"FrameLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Style", "[", 
                RowBox[{
                "\"\<TDM ( x 10^-4 ea0)\>\"", ",", "Bold", ",", "26"}], "]"}],
                ",", "\"\<\>\""}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"\"\<\>\"", ",", 
               RowBox[{"Style", "[", 
                RowBox[{
                "\"\<\!\(\*SuperscriptBox[\(\[InvisiblePrefixScriptBase]\), \
\(87\)]\)RbCs \[InvisiblePrefixScriptBase]\!\(\*SuperscriptBox[\(X\), \
\(1\)]\)\!\(\*SuperscriptBox[\(\[CapitalSigma]\), \(+\)]\) v''=0 J''=0 181.5 \
G vh-pol \>\"", ",", "Bold", ",", "26"}], "]"}]}], "}"}]}], "}"}]}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"p2", "=", 
        RowBox[{"ListPlot", "[", 
         RowBox[{"PlotXvE1", ",", 
          RowBox[{"Filling", "\[Rule]", "Axis"}], ",", 
          RowBox[{"PlotStyle", "\[Rule]", "Green"}], ",", 
          RowBox[{"FillingStyle", "\[Rule]", "Green"}], ",", 
          RowBox[{"Frame", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"True", ",", "True", ",", "True", ",", "True"}], "}"}]}], 
          ",", 
          RowBox[{"FrameTicks", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"All", ",", "None"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"All", ",", "None"}], "}"}]}], "}"}]}], ",", 
          RowBox[{"FrameStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
            "Automatic", ",", "Green", ",", "Automatic", ",", "Automatic"}], 
            "}"}]}], ",", 
          RowBox[{"PlotRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", ".1"}], ",", "0.6"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "30"}], "}"}]}], "}"}]}], ",", " ", 
          RowBox[{"FrameLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Style", "[", 
                RowBox[{
                "\"\<TDM ( x 10^-4 ea0)\>\"", ",", "Bold", ",", "26"}], "]"}],
                ",", "\"\<\>\""}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"\"\<\>\"", ",", 
               RowBox[{"Style", "[", 
                RowBox[{
                "\"\<\!\(\*SuperscriptBox[\(\[InvisiblePrefixScriptBase]\), \
\(87\)]\)RbCs \[InvisiblePrefixScriptBase]\!\(\*SuperscriptBox[\(X\), \
\(1\)]\)\!\(\*SuperscriptBox[\(\[CapitalSigma]\), \(+\)]\) v''=0 J''=0 181.5 \
G vv-pol\>\"", ",", "Bold", ",", "26"}], "]"}]}], "}"}]}], "}"}]}]}], "]"}]}],
        ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"Show", "[", "p1", "]"}], "\[IndentingNewLine]", 
   RowBox[{"Show", "[", "p2", "]"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"Export", "[", 
    RowBox[{"\"\<TDM_vh_181p5G_Stokes.csv\>\"", ",", "PlotXhE1"}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Export", "[", 
    RowBox[{"\"\<TDM_vv_181p5G_Stokes.csv\>\"", ",", "PlotXvE1"}], "]"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"NotebookSave", "[", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Quit", "[", "]"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.8705106823145604`*^9, 3.8705106989579163`*^9}, 
   3.8705111139145*^9, {3.8705111786608562`*^9, 3.870511255450698*^9}, {
   3.8705144779714317`*^9, 3.87051451364209*^9}, {3.8705145856668425`*^9, 
   3.870514589362107*^9}, {3.870927897448503*^9, 3.870927922461501*^9}, {
   3.8709279810735674`*^9, 3.8709279919564276`*^9}, 3.870928069283157*^9, 
   3.871116071894576*^9, 3.8711368054384036`*^9, {3.8711370628938665`*^9, 
   3.8711370751903057`*^9}, {3.8711378581752453`*^9, 
   3.8711379309918194`*^9}, {3.871138003253318*^9, 3.871138107998437*^9}, {
   3.8711381559999056`*^9, 3.8711382516782565`*^9}, {3.8711383024446225`*^9, 
   3.8711383278307705`*^9}, {3.871138378947694*^9, 3.871138479380617*^9}, {
   3.871138595277232*^9, 3.8711386006499615`*^9}, {3.871138723586886*^9, 
   3.8711387338613696`*^9}, {3.871138972321042*^9, 3.871138997598448*^9}, {
   3.871139080931043*^9, 3.871139096614005*^9}, {3.871139204477915*^9, 
   3.8711392467466726`*^9}, {3.8711394031401625`*^9, 3.871139415465063*^9}, {
   3.8711395314667215`*^9, 3.8711395390118694`*^9}, {3.871139850606797*^9, 
   3.871139909532261*^9}, 3.87113998889883*^9, 3.8711400780249295`*^9, {
   3.871144366988204*^9, 3.8711443750847387`*^9}, {3.8711444216665726`*^9, 
   3.871144561706081*^9}, {3.871439122498387*^9, 3.8714391336174*^9}, {
   3.8714397561171904`*^9, 3.871439792146626*^9}, {3.871440095269646*^9, 
   3.8714400983788147`*^9}, {3.8714419166670732`*^9, 
   3.8714419218073883`*^9}, {3.8764676492105584`*^9, 
   3.8764676508823338`*^9}, {3.876468097892173*^9, 3.876468160468707*^9}, {
   3.8764682381522617`*^9, 3.8764682813054457`*^9}, {3.876469925404197*^9, 
   3.876469948636669*^9}, 3.8764701190968676`*^9, {3.8764702213930826`*^9, 
   3.8764702610014606`*^9}, {3.876470298457709*^9, 3.876470305051832*^9}, {
   3.876470393558408*^9, 3.876470398447113*^9}, 3.8764704338944397`*^9, {
   3.876471674462902*^9, 3.876471684084369*^9}, {3.8764718767033615`*^9, 
   3.876471882296749*^9}, {3.876474520625727*^9, 3.8764745317209597`*^9}, {
   3.876474610754493*^9, 3.8764746187121115`*^9}, {3.877509812137291*^9, 
   3.8775098490837374`*^9}, {3.8775099552916207`*^9, 
   3.8775099771294236`*^9}, {3.877510007132639*^9, 3.8775100522266817`*^9}, {
   3.877510223911361*^9, 3.877510252358178*^9}, {3.8775104638242407`*^9, 
   3.877510498344037*^9}, {3.8775105745400343`*^9, 3.8775106965650344`*^9}, {
   3.877510752448393*^9, 3.8775108502583704`*^9}, {3.877515933744178*^9, 
   3.8775159437776117`*^9}, {3.877516016251019*^9, 3.877516023769556*^9}, {
   3.8775161532474747`*^9, 3.877516163463621*^9}, {3.886234473013073*^9, 
   3.8862346033513007`*^9}, {3.886234845617175*^9, 3.8862349062893233`*^9}, {
   3.8862349475549445`*^9, 3.8862351006498413`*^9}, {3.8862351847559137`*^9, 
   3.886235267955227*^9}, {3.886235300353842*^9, 3.8862353251335006`*^9}, {
   3.8862364670799417`*^9, 3.8862364856181297`*^9}, {3.886236790694195*^9, 
   3.8862367942979426`*^9}, {3.8862368354325733`*^9, 3.886236935258665*^9}, {
   3.8862372464760046`*^9, 3.88623727608191*^9}, {3.8862373905636544`*^9, 
   3.8862373918408175`*^9}, {3.886237532108982*^9, 3.886237617739126*^9}, {
   3.88623833418522*^9, 3.8862383768248596`*^9}, 3.8862393084634914`*^9, {
   3.8862398828085504`*^9, 3.886239923786508*^9}, {3.8862400144091997`*^9, 
   3.886240023291636*^9}, {3.8862401535195103`*^9, 3.8862401878445*^9}, 
   3.887268290340684*^9, {3.8901135945657997`*^9, 3.890113628455295*^9}, 
   3.890113691397598*^9, {3.9024541134860077`*^9, 3.902454114112424*^9}, 
   3.904087368223692*^9, {3.9040874227745543`*^9, 3.904087428246716*^9}, {
   3.9040880596660433`*^9, 3.9040880627277393`*^9}, {3.904088179699273*^9, 
   3.904088188330207*^9}, 3.904200796239612*^9, {3.904200853334508*^9, 
   3.904200861006509*^9}, {3.9046141883177767`*^9, 3.904614217432329*^9}, {
   3.904614274724485*^9, 3.904614311265967*^9}, {3.904614343233508*^9, 
   3.90461446498883*^9}, {3.9046145038445*^9, 3.9046145163340683`*^9}, {
   3.9046146144408503`*^9, 3.9046146617777767`*^9}, 3.904614695528571*^9, {
   3.904614727417923*^9, 3.9046147467417793`*^9}, 3.904614783876287*^9, {
   3.904615046703445*^9, 3.904615057658741*^9}, {3.9046152818204813`*^9, 
   3.904615321303071*^9}, {3.90461541210198*^9, 3.904615444400936*^9}, {
   3.904615505336876*^9, 3.90461551093896*^9}, {3.904615553113496*^9, 
   3.904615566637239*^9}, {3.904615667747727*^9, 3.9046156936693373`*^9}, {
   3.904866869047104*^9, 3.90486689537328*^9}, {3.9048669365017557`*^9, 
   3.904866938587695*^9}, {3.904866972005845*^9, 3.9048670167218513`*^9}, {
   3.9048671322004843`*^9, 3.904867155650156*^9}, {3.9048671933231077`*^9, 
   3.90486719625585*^9}, {3.904870005405939*^9, 3.904870079742064*^9}, {
   3.904870123822847*^9, 3.90487019438056*^9}, {3.904870474552492*^9, 
   3.904870492282267*^9}, {3.90495310083674*^9, 3.904953101294941*^9}, {
   3.904953142629387*^9, 3.9049531429970512`*^9}, {3.904956664057723*^9, 
   3.9049566650749903`*^9}, {3.904956719258141*^9, 3.9049567203765507`*^9}, {
   3.9049624171013937`*^9, 3.904962497173534*^9}, {3.904965535637928*^9, 
   3.904965536239534*^9}, {3.904968149593644*^9, 3.9049681626675367`*^9}, 
   3.904969149094696*^9, {3.905300295475389*^9, 3.9053003417351933`*^9}, {
   3.905300377277796*^9, 3.905300378678866*^9}, 3.905328689085623*^9},
 Background->RGBColor[
  1, 0.925, 0.925],ExpressionUUID->"75106907-4c48-48ac-aa41-698a2f07545c"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
(* A Das Nov 2022: Calculation of TDMs for Stokes transition at 305 G *)\
\>", "Section",
 CellChangeTimes->{{3.8705106823145604`*^9, 3.8705106989579163`*^9}, 
   3.8705111139145*^9, {3.8705111786608562`*^9, 3.870511255450698*^9}, {
   3.8705148025123014`*^9, 3.870514804622804*^9}, {3.8705148970171547`*^9, 
   3.8705149679298077`*^9}, {3.870515018906948*^9, 3.8705151736807194`*^9}, {
   3.8705152279430656`*^9, 3.870515273974344*^9}, 3.870515366083853*^9, {
   3.8705155661531754`*^9, 3.870515588088193*^9}, {3.870515762475386*^9, 
   3.8705157632877293`*^9}, {3.870516037916381*^9, 3.8705160506137915`*^9}, {
   3.8705162575407147`*^9, 3.870516265135002*^9}, {3.8709290808572645`*^9, 
   3.870929083450732*^9}, {3.870929113505889*^9, 3.870929116353879*^9}, {
   3.8709293402048454`*^9, 3.870929400728337*^9}, 3.8709295761256323`*^9, {
   3.8709297503653555`*^9, 3.870929769905547*^9}, {3.8709302621566963`*^9, 
   3.8709302760044656`*^9}, {3.870930320664864*^9, 3.8709304954001703`*^9}, {
   3.870931145514799*^9, 3.87093120659927*^9}, {3.8709314678939247`*^9, 
   3.870931468110197*^9}, {3.870931681909829*^9, 3.870931708821127*^9}, {
   3.8709317413244286`*^9, 3.870931741567087*^9}, {3.8709318318073654`*^9, 
   3.870931860295926*^9}, {3.8709320249167843`*^9, 3.8709320282975445`*^9}, 
   3.870932433453094*^9, {3.870932587347542*^9, 3.870932596550042*^9}, {
   3.870932703784641*^9, 3.870932707049594*^9}, {3.8709327668806753`*^9, 
   3.8709328209118185`*^9}, {3.870933003820838*^9, 3.8709330413617306`*^9}, {
   3.870933077118432*^9, 3.8709331668707957`*^9}, {3.8709332648685246`*^9, 
   3.8709333477491517`*^9}, 3.870933485294163*^9, {3.8709337342551126`*^9, 
   3.870933746805048*^9}, {3.8709337911825123`*^9, 3.870933811804056*^9}, {
   3.8709338562481184`*^9, 3.8709339180555754`*^9}, 3.870934118873764*^9, {
   3.870934837187893*^9, 3.8709348426278124`*^9}, 3.870935150460209*^9, {
   3.870937498872613*^9, 3.8709375053013334`*^9}, {3.870937556940441*^9, 
   3.870937559786424*^9}, {3.870937590591866*^9, 3.8709375914952097`*^9}, 
   3.8709379520439415`*^9, {3.8709382905399623`*^9, 3.870938294469285*^9}, {
   3.871115205850418*^9, 3.871115216540025*^9}, {3.8711153434327583`*^9, 
   3.8711154569832044`*^9}, {3.8711159137608957`*^9, 3.871115914323264*^9}, {
   3.8711388364781866`*^9, 3.8711388426597414`*^9}, {3.8711425802899914`*^9, 
   3.8711425903070345`*^9}, {3.8711427801735506`*^9, 3.871142866005243*^9}, {
   3.8711429094763136`*^9, 3.871143036489319*^9}, {3.8711431228521137`*^9, 
   3.8711433015459003`*^9}, {3.871143399857803*^9, 3.871143418098217*^9}, {
   3.871143496486483*^9, 3.8711435225390368`*^9}, {3.871143663425996*^9, 
   3.871143697392471*^9}, 3.8711437860246105`*^9, {3.8711438605193567`*^9, 
   3.8711439623996267`*^9}, {3.8711440546324434`*^9, 
   3.8711440806191287`*^9}, {3.8711442486280107`*^9, 
   3.8711442595236244`*^9}, {3.871439955383347*^9, 3.871440006413169*^9}, {
   3.8714400551976213`*^9, 3.8714400767312737`*^9}, {3.8714586193700294`*^9, 
   3.871458627111759*^9}, {3.876369227697382*^9, 3.8763692503738594`*^9}, {
   3.876472158393323*^9, 3.876472188792179*^9}, {3.8764722356342106`*^9, 
   3.8764723407858987`*^9}, {3.8764723916294923`*^9, 3.876472409362612*^9}, 
   3.87647257212991*^9, {3.8764726041616645`*^9, 3.8764726495817995`*^9}, {
   3.8764728225842824`*^9, 3.876472880115553*^9}, {3.876472959411112*^9, 
   3.8764730134727077`*^9}, {3.876473182741073*^9, 3.8764732199100885`*^9}, {
   3.876473331440055*^9, 3.8764734510105515`*^9}, {3.8764735686042957`*^9, 
   3.8764736498083925`*^9}, {3.8764742594923077`*^9, 
   3.8764742849624815`*^9}, {3.8764743363527412`*^9, 3.87647435222957*^9}, {
   3.8775072838168836`*^9, 3.8775073133175497`*^9}, {3.8775073442189245`*^9, 
   3.877507353830655*^9}, {3.8775079983476276`*^9, 3.877508131182732*^9}, {
   3.877508217136463*^9, 3.8775082223167996`*^9}, 3.877512274259432*^9, {
   3.877683433605953*^9, 3.877683458678177*^9}, {3.877683495700754*^9, 
   3.8776834958257303`*^9}, 3.8776835273771152`*^9, 3.877683557698092*^9, 
   3.8776838768506126`*^9, {3.877683921558858*^9, 3.8776839293070483`*^9}, {
   3.877684069530013*^9, 3.877684117565626*^9}, {3.8777663874944572`*^9, 
   3.8777664331091404`*^9}, {3.8781985265558004`*^9, 3.878198536800106*^9}, {
   3.8789882510935764`*^9, 3.878988253325284*^9}, {3.878988302895945*^9, 
   3.8789883164468956`*^9}, {3.878988375147209*^9, 3.878988416939107*^9}, {
   3.878988898187974*^9, 3.878988931431535*^9}, {3.878988989257063*^9, 
   3.878988994661078*^9}, {3.884087086959981*^9, 3.8840870911523275`*^9}, {
   3.8847800203899007`*^9, 3.884780027129955*^9}, {3.884780287946352*^9, 
   3.884780299015362*^9}, 3.884936147747841*^9, {3.8849362862389727`*^9, 
   3.884936288854941*^9}, 3.8849382218999825`*^9, {3.8862392933248053`*^9, 
   3.8862393019662666`*^9}, {3.8862394051532826`*^9, 
   3.8862394603113327`*^9}, {3.886239494777465*^9, 3.8862394952839403`*^9}, {
   3.8862395462071295`*^9, 3.8862395823175354`*^9}, {3.8862397022737846`*^9, 
   3.8862398527796507`*^9}, {3.8862402170861397`*^9, 
   3.8862402764628215`*^9}, {3.8862404758865643`*^9, 3.886240503145917*^9}, {
   3.8862406538082867`*^9, 3.8862407135053763`*^9}, {3.8862407535803967`*^9, 
   3.886240861781022*^9}, {3.8862410631239667`*^9, 3.886241069480061*^9}, 
   3.88726765748438*^9, 3.887267751677579*^9, {3.8872679733467846`*^9, 
   3.88726803810929*^9}, {3.90408934625288*^9, 3.904089351483412*^9}, {
   3.904089385908493*^9, 3.904089391046248*^9}, {3.904089477432457*^9, 
   3.9040894836613417`*^9}, {3.90420409164384*^9, 3.904204188142837*^9}, 
   3.904285404322475*^9, {3.9042871667807503`*^9, 3.904287201875204*^9}, {
   3.904287356409614*^9, 3.904287384128086*^9}, {3.904287527126876*^9, 
   3.9042875963740263`*^9}, {3.9042876522848063`*^9, 3.904287790636602*^9}, {
   3.904287830071412*^9, 3.904288095150969*^9}, {3.9042881777647867`*^9, 
   3.904288335280692*^9}, {3.904288378212634*^9, 3.9042884398560953`*^9}, {
   3.904288534771048*^9, 3.904288535762967*^9}, {3.9042885791866627`*^9, 
   3.904288598805171*^9}, {3.9042886568169527`*^9, 3.904288657288293*^9}, {
   3.904288720790255*^9, 3.904288733358266*^9}, {3.904288817619225*^9, 
   3.904288893950068*^9}, {3.9042889253554993`*^9, 3.904288962613625*^9}, {
   3.904289115707115*^9, 3.9042891231961603`*^9}, {3.904613932063223*^9, 
   3.904614000812036*^9}, {3.904614055664584*^9, 3.904614058919737*^9}, {
   3.9046141719235*^9, 3.9046141764905043`*^9}, {3.9046145816309843`*^9, 
   3.904614584983767*^9}, {3.904615129069296*^9, 3.904615167558399*^9}, {
   3.904615708562623*^9, 3.904615720982229*^9}, {3.904867175863853*^9, 
   3.9048671766694307`*^9}, {3.904867208462274*^9, 3.904867221795562*^9}, {
   3.904870612589493*^9, 3.904870667158379*^9}, {3.904870705327263*^9, 
   3.90487072508055*^9}, {3.9048708526976223`*^9, 3.904870859428143*^9}, {
   3.904953196513465*^9, 3.904953203430544*^9}, {3.904956690608283*^9, 
   3.904956691554521*^9}, {3.90495672894827*^9, 3.904956730002139*^9}, {
   3.904962521323794*^9, 3.904962545797435*^9}, {3.904965807279839*^9, 
   3.904965807807646*^9}, {3.9049682180242853`*^9, 3.9049682380664473`*^9}, 
   3.9053004587623453`*^9, {3.905328709755629*^9, 3.905328722614429*^9}},
 Background->RGBColor[
  1, 0.925, 0.925],ExpressionUUID->"2a2f050d-2938-4c24-8426-bf085afe3bad"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Stark", " ", "shift", " ", 
      RowBox[{"convergence", ":", " ", 
       RowBox[{
       "change", " ", "in", " ", "ground", " ", "state", " ", "level", " ", 
        "with", " ", "additional", " ", "rotational", " ", "level", " ", "to",
         " ", "N"}]}]}], "=", 
     RowBox[{"7", " ", "2", "kHz"}]}], ",", " ", 
    RowBox[{
     RowBox[{"to", " ", "N"}], "=", 
     RowBox[{"8", " ", "7", "Hz"}]}], ",", " ", 
    RowBox[{
     RowBox[{"to", " ", "N"}], "=", 
     RowBox[{"9", " ", "<", 
      RowBox[{"1", "Hz"}]}]}]}], "  ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "estimated", " ", "effect", " ", "of", " ", "diagmagnetic", " ", "shift", 
    " ", 
    RowBox[{"(", "omitted", ")"}], " ", "is", " ", "about", " ", "50", "Hz"}],
    "  ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Off", "[", 
     RowBox[{"ClebschGordan", "::", "\"\<phy\>\""}], "]"}], " ", ";"}], "\n", 
   RowBox[{
    RowBox[{"Off", "[", 
     RowBox[{"ClebschGordan", "::", "\"\<tri\>\""}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BasePath", " ", "=", " ", 
     RowBox[{"NotebookDirectory", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"libPath", " ", "=", " ", 
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], "<>", "\"\</lib/\>\""}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"outputPath", " ", "=", " ", 
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], "<>", "\"\</data/\>\""}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SetDirectory", "[", "BasePath", "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"**", "**", "**", "**", "**", "**", "**"}], "**", "**"}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"physical", " ", "constants"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"**", "**", "**", "**", "**", "**", "**", "**", "**"}], " ", 
    "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"e", "=", 
     RowBox[{"4.803207", "/", 
      RowBox[{"10", "^", "10"}]}]}], ";"}], " ", 
   RowBox[{"(*", " ", "esu", " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"c", "=", 
     RowBox[{"2.99792458", "*", 
      RowBox[{"10", "^", "10"}]}]}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{"cm", "/", "s"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[HBar]", "=", 
     RowBox[{"1.05457163", " ", 
      SuperscriptBox["10", 
       RowBox[{"-", "27"}]]}]}], ";"}], "  ", 
   RowBox[{"(*", " ", 
    RowBox[{"in", " ", "erg", " ", "s", " ", "2006", " ", "CODATA"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"h", "=", 
     RowBox[{"2", "*", "Pi", "*", "\[HBar]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"g", "=", "980.553"}], " ", ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"http", ":"}], "//", 
     RowBox[{
      RowBox[{"bgi", ".", "cnes", ".", "fr"}], "/"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ao", "=", 
     RowBox[{"5.2917721092", "*", 
      RowBox[{"10", "^", 
       RowBox[{"-", "9"}]}]}]}], ";"}], "   ", 
   RowBox[{"(*", " ", 
    RowBox[{"Bohr", " ", "radius", " ", "cm"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["\[Mu]", "Bohr"], "=", 
     RowBox[{"9.27400915", " ", 
      SuperscriptBox["10", 
       RowBox[{"-", "21"}]]}]}], " ", ";"}], 
   RowBox[{"(*", " ", 
    RowBox[{"in", " ", 
     RowBox[{"erg", "/", "G"}], " ", "2006", " ", "CODATA"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["\[Mu]", "Nuc"], "=", 
     RowBox[{"5.05078353", " ", 
      SuperscriptBox["10", 
       RowBox[{"-", "24"}]]}]}], ";"}], 
   RowBox[{"(*", " ", 
    RowBox[{"in", " ", 
     RowBox[{"erg", "/", "G"}], " ", "2010", " ", "CODATA"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["m", "Cs"], "=", 
     RowBox[{"2.20694657", " ", 
      SuperscriptBox["10", 
       RowBox[{"-", "22"}]]}]}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{"g", " ", 
     RowBox[{"D", ".", "A", ".", "Steck"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["m", "Rb"], "=", 
     RowBox[{"1.443160648", " ", 
      SuperscriptBox["10", 
       RowBox[{"-", "22"}]]}]}], ";"}], 
   RowBox[{"(*", " ", 
    RowBox[{"g", " ", 
     RowBox[{"D", ".", "A", ".", "Steck"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["m", "e"], "=", 
     RowBox[{"9.10938188", " ", 
      SuperscriptBox["10", 
       RowBox[{"-", "28"}]]}]}], ";"}], 
   RowBox[{"(*", " ", 
    RowBox[{"g", " ", 
     RowBox[{"D", ".", "A", ".", "Steck"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"gS", "=", "2.0023193043622"}], ";"}], "  ", 
   RowBox[{"(*", " ", 
    RowBox[{"2006", " ", "CODATA"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["i", "Rb"], "=", 
     RowBox[{"3", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["i", "Cs"], "=", 
     RowBox[{"7", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["B", "RbCs"], "=", 
     RowBox[{"490.17", "*", 
      RowBox[{"10", "^", "6"}], "*", "h"}]}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"N", "=", 
      RowBox[{
      "0", " ", "rotational", " ", "constant", " ", "from", " ", "Blackmore", 
       " ", "et", " ", 
       RowBox[{"al", "."}]}]}], ",", " ", 
     RowBox[{"Comp", ".", " ", "Phys", ".", " ", "Commun", ".", " ", "282"}], 
     ",", " ", 
     RowBox[{"108512", " ", 
      RowBox[{"(", "2023", ")"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["d", "RbCs"], "=", 
     RowBox[{"1.25", "*", 
      RowBox[{"10", "^", 
       RowBox[{"-", "18"}]}]}]}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "permanent", " ", "dipole", " ", "moment", " ", "in", " ", "molecule", 
      " ", "fixed", " ", "frame", " ", "in", " ", "statcoulomb"}], "-", 
     RowBox[{"cm", " ", 
      RowBox[{"(", 
       RowBox[{"Debye", " ", "*", " ", 
        RowBox[{"10", "^", 
         RowBox[{"-", "18"}]}]}], ")"}]}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["eqQ", "Rb"], "=", 
     RowBox[{
      RowBox[{"-", "0.809"}], "*", 
      RowBox[{"10", "^", "6"}], "*", "h"}]}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "87", "Rb", " ", "electric", " ", "quadrupole", " ", "constant", " ", 
      "Blackmore", " ", "et", " ", 
      RowBox[{"al", "."}]}], ",", " ", 
     RowBox[{"Comp", ".", " ", "Phys", ".", " ", "Commun", ".", " ", "282"}], 
     ",", " ", 
     RowBox[{"108512", " ", 
      RowBox[{"(", "2023", ")"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["eqQ", "Cs"], "=", 
     RowBox[{"0.059", "*", 
      RowBox[{"10", "^", "6"}], "*", "h"}]}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "Cs", " ", "electric", " ", "quadrupole", " ", "constant", " ", 
      "Blackmore", " ", "et", " ", 
      RowBox[{"al", "."}]}], ",", " ", 
     RowBox[{"Comp", ".", " ", "Phys", ".", " ", "Commun", ".", " ", "282"}], 
     ",", " ", 
     RowBox[{"108512", " ", 
      RowBox[{"(", "2023", ")"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["g", 
      RowBox[{"i", ",", "Rb"}]], "=", "1.8295"}], " ", ";"}], " ", 
   RowBox[{"(*", "  ", 
    RowBox[{
     RowBox[{"Blackmore", " ", "et", " ", 
      RowBox[{"al", "."}]}], ",", " ", 
     RowBox[{"Comp", ".", " ", "Phys", ".", " ", "Commun", ".", " ", "282"}], 
     ",", " ", 
     RowBox[{"108512", " ", 
      RowBox[{"(", "2023", ")"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["g", 
      RowBox[{"i", ",", "Cs"}]], "=", "0.7331"}], " ", ";"}], " ", 
   RowBox[{"(*", "  ", 
    RowBox[{
     RowBox[{"Blackmore", " ", "et", " ", 
      RowBox[{"al", "."}]}], ",", " ", 
     RowBox[{"Comp", ".", " ", "Phys", ".", " ", "Commun", ".", " ", "282"}], 
     ",", " ", 
     RowBox[{"108512", " ", 
      RowBox[{"(", "2023", ")"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["g", "r"], "=", "0.0062"}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "rotational", " ", "g", " ", "factor", " ", "Aldegunde", " ", "et", " ", 
      RowBox[{"al", "."}]}], ",", " ", 
     RowBox[{"PRA", " ", "78", " ", "033434", " ", 
      RowBox[{"(", "2008", ")"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["c", "Rb"], "=", 
     RowBox[{"98.4", "*", "h"}]}], ";"}], "  ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"87", "Rb", " ", "nuclear", " ", "spin"}], "-", 
      RowBox[{"rotation", " ", "constant", " ", "Aldegunde", " ", "et", " ", 
       RowBox[{"al", "."}]}]}], ",", " ", 
     RowBox[{"PRA", " ", "78", " ", "033434", " ", 
      RowBox[{"(", "2008", ")"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["c", "Cs"], "=", 
     RowBox[{"194.2", "*", "h"}]}], ";"}], "  ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"Cs", " ", "nuclear", " ", "spin"}], "-", 
      RowBox[{"rotation", " ", "constant", " ", 
       RowBox[{
       "Comp", ".", " ", "Phys", ".", " ", "Commun", ".", " ", "282"}]}]}], 
     ",", " ", 
     RowBox[{"108512", " ", 
      RowBox[{"(", "2023", ")"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"c3", "=", 
     RowBox[{"192.4", "*", "h"}]}], ";"}], " ", 
   RowBox[{"(*", "  ", 
    RowBox[{
     RowBox[{"Aldegunde", " ", "et", " ", 
      RowBox[{"al", "."}]}], ",", " ", 
     RowBox[{"PRA", " ", "78", " ", "033434", " ", 
      RowBox[{"(", "2008", ")"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"c4", "=", 
     RowBox[{"19018.96", "*", "h"}]}], ";"}], " ", 
   RowBox[{"(*", "  ", 
    RowBox[{
     RowBox[{"Comp", ".", " ", "Phys", ".", " ", "Commun", ".", " ", "282"}], 
     ",", " ", 
     RowBox[{"108512", " ", 
      RowBox[{"(", "2023", ")"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Sigma]Rb", "=", 
     RowBox[{"3531", "*", 
      RowBox[{"10", "^", 
       RowBox[{"(", 
        RowBox[{"-", "6"}], ")"}]}]}]}], ";"}], " ", 
   RowBox[{"(*", "  ", 
    RowBox[{
     RowBox[{"Aldegunde", " ", "et", " ", 
      RowBox[{"al", "."}]}], ",", " ", 
     RowBox[{"PRA", " ", "78", " ", "033434", " ", 
      RowBox[{"(", "2008", ")"}], " ", "has", " ", "N", " ", "dependence", 
      " ", "but", " ", "this", " ", "is", " ", "ignored", " ", "here"}]}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Sigma]Cs", "=", 
     RowBox[{"6367", "*", 
      RowBox[{"10", "^", 
       RowBox[{"(", 
        RowBox[{"-", "6"}], ")"}]}]}]}], ";"}], " ", 
   RowBox[{"(*", "  ", 
    RowBox[{
     RowBox[{"Aldegunde", " ", "et", " ", 
      RowBox[{"al", "."}]}], ",", " ", 
     RowBox[{"PRA", " ", "78", " ", "033434", " ", 
      RowBox[{"(", "2008", ")"}], " ", "has", " ", "N", " ", "dependence", 
      " ", "but", " ", "this", " ", "is", " ", "ignored", " ", "here"}]}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"alphapar", "=", 
     RowBox[{"904", 
      RowBox[{"ao", "^", "3"}]}]}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{"parallel", " ", "to", " ", "axis", " ", "dc", " ", 
     RowBox[{"polarizability", " ", "@", " ", "min"}], " ", "internuc", " ", 
     "sep", " ", "from", " ", "Dulieu", " ", "JCP", " ", "129", " ", "064309",
      " ", 
     RowBox[{"(", "2008", ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"alphaperp", "=", 
     RowBox[{"492.3", 
      RowBox[{"ao", "^", "3"}]}]}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{"perpendicular", " ", "dc", " ", 
     RowBox[{"polarizability", " ", "@", " ", "min"}], " ", "internuc", " ", 
     "sep", " ", "from", " ", "Dulieu", " ", "JCP", " ", "129", " ", "064309",
      " ", 
     RowBox[{"(", "2008", ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"alpha", "=", 
     RowBox[{"597.6", 
      RowBox[{"ao", "^", "3"}]}]}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"avg", " ", "polarizability", " ", "for", " ", "v"}], "=", 
     RowBox[{
     "0", " ", "from", " ", "Dulieu", " ", "JCP", " ", "129", " ", "064309", 
      " ", 
      RowBox[{"(", "2008", ")"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
       "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
       "**"}], "*", 
     RowBox[{
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**"}],
      "*", 
     RowBox[{"**", "**", "**", "**", "**"}], "*"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "Hamiltonians", " ", "with", " ", "Stark", " ", "and", " ", "Zeeman", 
      " ", "in", " ", "nuclear", " ", "spin"}], "-", 
     RowBox[{"decoupled", " ", 
      RowBox[{"basis", "."}]}]}], "                      ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
       "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
       "**"}], "*", 
     RowBox[{
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**"}],
      "*", 
     RowBox[{"**", "**", "**", "**", "**"}], "*"}], " ", "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Heff", "[", 
      RowBox[{
      "mIRb1_", ",", "mICs1_", ",", "N1_", ",", "mN1_", ",", "mIRb2_", ",", 
       "mICs2_", ",", "N2_", ",", "mN2_", ",", "Ez_"}], "]"}], ":=", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"mIRb1", ",", "mIRb2"}], "]"}], " ", "*", " ", 
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"mICs1", ",", "mICs2"}], "]"}], "*", 
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"N1", ",", "N2"}], "]"}], " ", "*", " ", 
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"mN1", ",", "mN2"}], "]"}], "*", 
       SubscriptBox["B", "RbCs"], "N1", 
       RowBox[{"(", 
        RowBox[{"N1", "+", "1"}], ")"}]}], "-", " ", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
         RowBox[{
         "Stark", " ", "diag", " ", "in", " ", "mIRb", " ", "mICs", " ", 
          RowBox[{"mN", ".", "  ", "\[CapitalDelta]N"}]}], " ", "=", " ", 
         "0"}], ",", 
        RowBox[{"+", 
         RowBox[{"-", "1"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"mIRb1", ",", "mIRb2"}], "]"}], " ", "*", " ", 
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"mICs1", ",", "mICs2"}], "]"}], "*", 
       SubscriptBox["d", "RbCs"], "*", "Ez", "*", 
       RowBox[{"Sqrt", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", "N1"}], "+", "1"}], ")"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", "N2"}], "+", "1"}], ")"}]}], "]"}], "*", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"-", "1"}], ")"}], "^", "mN1"}], " ", "*", 
       RowBox[{"ThreeJSymbol", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"N1", ",", 
           RowBox[{"-", "mN1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"N2", ",", "mN2"}], "}"}]}], "]"}], "*", 
       RowBox[{"ThreeJSymbol", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"N1", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"N2", ",", "0"}], "}"}]}], "]"}]}], " ", "-", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"nuc", " ", "Zeeman", " ", "diag", " ", "in", " ", "all"}], 
       " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"mIRb1", ",", "mIRb2"}], "]"}], " ", "*", " ", 
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"mICs1", ",", "mICs2"}], "]"}], "*", 
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"N1", ",", "N2"}], "]"}], " ", "*", " ", 
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"mN1", ",", "mN2"}], "]"}], "*", "\[IndentingNewLine]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SubscriptBox["g", 
           RowBox[{"i", ",", "Rb"}]], 
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Sigma]Rb"}], ")"}], "mIRb1"}], "+", 
         RowBox[{
          SubscriptBox["g", 
           RowBox[{"i", ",", "Cs"}]], " ", 
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Sigma]Cs"}], ")"}], "mICs1"}], "+", 
         RowBox[{
          SubscriptBox["g", "r"], "mN1"}]}], ")"}], " ", 
       SubscriptBox["\[Mu]", "Nuc"], " ", "Bz"}], " ", "+", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"RbQP", " ", "diag", " ", "in", " ", 
          RowBox[{"mICs", ".", " ", "\[CapitalDelta]N"}]}], "=", 
         RowBox[{"-", "2"}]}], ",", "0", ",", 
        RowBox[{
         RowBox[{"2", " ", "\[CapitalDelta]mN"}], "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], ".."}], "2", " ", "\[CapitalDelta]mIRb"}], 
          "=", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], ".."}], "2"}]}]}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["eqQ", "Rb"], "/", "4"}], ")"}], "*", 
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"mICs1", ",", "mICs2"}], "]"}], "*", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], 
           RowBox[{"p", "+", "N1", "-", "mN1"}]], 
          RowBox[{"ThreeJSymbol", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"N1", ",", 
              RowBox[{"-", "mN1"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"2", ",", "p"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"N2", ",", "mN2"}], "}"}]}], "]"}], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], "N1"], 
          RowBox[{"Sqrt", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", "N1"}], "+", "1"}], ")"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", "N2"}], "+", "1"}], ")"}]}], "]"}], 
          RowBox[{"ThreeJSymbol", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"N1", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"2", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"N2", ",", "0"}], "}"}]}], "]"}], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], 
           RowBox[{
            SubscriptBox["i", "Rb"], "-", "mIRb1"}]], 
          RowBox[{
           RowBox[{"ThreeJSymbol", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               SubscriptBox["i", "Rb"], ",", 
               RowBox[{"-", "mIRb1"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"2", ",", 
               RowBox[{"-", "p"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               SubscriptBox["i", "Rb"], ",", "mIRb2"}], "}"}]}], "]"}], "/", 
           RowBox[{"ThreeJSymbol", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               SubscriptBox["i", "Rb"], ",", 
               RowBox[{"-", 
                SubscriptBox["i", "Rb"]}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"2", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               SubscriptBox["i", "Rb"], ",", 
               SubscriptBox["i", "Rb"]}], "}"}]}], "]"}]}]}], ",", 
         RowBox[{"{", 
          RowBox[{"p", ",", 
           RowBox[{"-", "2"}], ",", "2"}], "}"}]}], "]"}]}], "+", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"CsQP", " ", "diag", " ", "in", " ", 
          RowBox[{"mIRb", ".", " ", "\[CapitalDelta]N"}]}], "=", 
         RowBox[{"-", "2"}]}], ",", "0", ",", 
        RowBox[{
         RowBox[{"2", " ", "\[CapitalDelta]mN"}], "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], ".."}], "2", " ", "\[CapitalDelta]mICs"}], 
          "=", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], ".."}], "2"}]}]}]}], " ", "*)"}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["eqQ", "Cs"], "/", "4"}], ")"}], "*", 
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"mIRb1", ",", "mIRb2"}], "]"}], "*", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], 
           RowBox[{"p", "+", "N1", "-", "mN1"}]], 
          RowBox[{"ThreeJSymbol", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"N1", ",", 
              RowBox[{"-", "mN1"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"2", ",", "p"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"N2", ",", "mN2"}], "}"}]}], "]"}], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], "N1"], 
          RowBox[{"Sqrt", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", "N1"}], "+", "1"}], ")"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", "N2"}], "+", "1"}], ")"}]}], "]"}], 
          RowBox[{"ThreeJSymbol", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"N1", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"2", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"N2", ",", "0"}], "}"}]}], "]"}], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], 
           RowBox[{
            SubscriptBox["i", "Cs"], "-", "mICs1"}]], 
          RowBox[{
           RowBox[{"ThreeJSymbol", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               SubscriptBox["i", "Cs"], ",", 
               RowBox[{"-", "mICs1"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"2", ",", 
               RowBox[{"-", "p"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               SubscriptBox["i", "Cs"], ",", "mICs2"}], "}"}]}], "]"}], "/", 
           RowBox[{"ThreeJSymbol", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               SubscriptBox["i", "Cs"], ",", 
               RowBox[{"-", 
                SubscriptBox["i", "Cs"]}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"2", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               SubscriptBox["i", "Cs"], ",", 
               SubscriptBox["i", "Cs"]}], "}"}]}], "]"}]}]}], ",", 
         RowBox[{"{", 
          RowBox[{"p", ",", 
           RowBox[{"-", "2"}], ",", "2"}], "}"}]}], "]"}]}], "+", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "Rb", " ", "spin", " ", "rot", " ", "diag", " ", "in", " ", "mICs"}], 
        ",", 
        RowBox[{
         RowBox[{"N", ".", " ", "\[CapitalDelta]mN"}], "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"-", "1"}], ".."}], "1", " ", "\[CapitalDelta]mIRb"}], 
          "=", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "1"}], ".."}], "1"}]}]}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       SubscriptBox["c", "Rb"], "*", 
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"mICs1", ",", "mICs2"}], "]"}], "*", 
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"N1", ",", "N2"}], "]"}], "*", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], 
           RowBox[{"p", "+", "N1", "-", "mN1", "+", 
            SubscriptBox["i", "Rb"], "-", "mIRb1"}]], 
          RowBox[{"Sqrt", "[", 
           RowBox[{"N1", 
            RowBox[{"(", 
             RowBox[{"N1", "+", "1"}], ")"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", "N1"}], "+", "1"}], ")"}], 
            SubscriptBox["i", "Rb"], 
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["i", "Rb"], "+", "1"}], ")"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", 
               SubscriptBox["i", "Rb"]}], "+", "1"}], ")"}]}], "]"}], 
          RowBox[{"ThreeJSymbol", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"N1", ",", 
              RowBox[{"-", "mN1"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "p"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"N1", ",", "mN2"}], "}"}]}], "]"}], 
          RowBox[{"ThreeJSymbol", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              SubscriptBox["i", "Rb"], ",", 
              RowBox[{"-", "mIRb1"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", 
              RowBox[{"-", "p"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              SubscriptBox["i", "Rb"], ",", "mIRb2"}], "}"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"p", ",", 
           RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}]}], "+", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "Cs", " ", "spin", " ", "rot", " ", "diag", " ", "in", " ", "mIRb"}], 
        ",", 
        RowBox[{
         RowBox[{"N", ".", " ", "\[CapitalDelta]mN"}], "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"-", "1"}], ".."}], "1", " ", "\[CapitalDelta]mICs"}], 
          "=", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "1"}], ".."}], "1"}]}]}]}], " ", "*)"}], 
      RowBox[{
       SubscriptBox["c", "Cs"], "*", 
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"mIRb1", ",", "mIRb2"}], "]"}], "*", 
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"N1", ",", "N2"}], "]"}], "*", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], 
           RowBox[{"p", "+", "N1", "-", "mN1", "+", 
            SubscriptBox["i", "Cs"], "-", "mICs1"}]], 
          RowBox[{"Sqrt", "[", 
           RowBox[{"N1", 
            RowBox[{"(", 
             RowBox[{"N1", "+", "1"}], ")"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", "N1"}], "+", "1"}], ")"}], 
            SubscriptBox["i", "Cs"], 
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["i", "Cs"], "+", "1"}], ")"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", 
               SubscriptBox["i", "Cs"]}], "+", "1"}], ")"}]}], "]"}], 
          RowBox[{"ThreeJSymbol", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"N1", ",", 
              RowBox[{"-", "mN1"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "p"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"N1", ",", "mN2"}], "}"}]}], "]"}], 
          RowBox[{"ThreeJSymbol", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              SubscriptBox["i", "Cs"], ",", 
              RowBox[{"-", "mICs1"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", 
              RowBox[{"-", "p"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              SubscriptBox["i", "Cs"], ",", "mICs2"}], "}"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"p", ",", 
           RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}]}], "-", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
         RowBox[{
         "nuc", " ", "nuc", " ", "spin", " ", "tensor", " ", 
          "\[CapitalDelta]N"}], "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], ".."}], "2", " ", "\[CapitalDelta]mN"}], "=", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"-", "2"}], ".."}], "2", " ", "\[CapitalDelta]mIRb"}], 
           "=", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"-", "1"}], ".."}], "1", " ", "\[CapitalDelta]mICs"}], 
            "=", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"-", "1"}], ".."}], "1", "   ", "B"}], "&"}], "C", 
             " ", "8.314"}]}]}]}]}], ",", " ", 
        RowBox[{
         RowBox[{"8.302", " ", "but", " ", "error", " ", "in", " ", 
          RowBox[{"formula", ".", "  ", "q"}]}], "=", 
         RowBox[{"0", " ", "term", " ", "only"}]}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Sqrt", "[", "30", "]"}], "*", "c3", " ", "*", 
       "\[IndentingNewLine]", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], 
           RowBox[{
            SubscriptBox["i", "Cs"], "-", "mICs1", "+", 
            SubscriptBox["i", "Rb"], "-", "mIRb1"}]], 
          RowBox[{"ThreeJSymbol", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              SubscriptBox["i", "Cs"], ",", 
              RowBox[{"-", "mICs1"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", 
              RowBox[{"-", "p"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              SubscriptBox["i", "Cs"], ",", "mICs2"}], "}"}]}], "]"}], 
          RowBox[{"Sqrt", "[", 
           RowBox[{
            SubscriptBox["i", "Rb"], 
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["i", "Rb"], "+", "1"}], ")"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", 
               SubscriptBox["i", "Rb"]}], "+", "1"}], ")"}], 
            SubscriptBox["i", "Cs"], 
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["i", "Cs"], "+", "1"}], ")"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", 
               SubscriptBox["i", "Cs"]}], "+", "1"}], ")"}]}], "]"}], 
          "\[IndentingNewLine]", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], "N1"], 
             RowBox[{"Sqrt", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"2", "N1"}], "+", "1"}], ")"}], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"2", "N2"}], "+", "1"}], ")"}]}], "]"}], 
             RowBox[{"ThreeJSymbol", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"N1", ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"2", ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"N2", ",", "0"}], "}"}]}], "]"}], 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{"N1", "-", "mN1"}]], 
             RowBox[{"ThreeJSymbol", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"N1", ",", 
                 RowBox[{"-", "mN1"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"2", ",", "p2"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"N2", ",", "mN2"}], "}"}]}], "]"}], 
             RowBox[{"ThreeJSymbol", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 SubscriptBox["i", "Rb"], ",", 
                 RowBox[{"-", "mIRb1"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", "p1"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 SubscriptBox["i", "Rb"], ",", "mIRb2"}], "}"}]}], "]"}], 
             RowBox[{"ThreeJSymbol", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"1", ",", "p1"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"2", ",", "p2"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", 
                 RowBox[{"-", "p"}]}], "}"}]}], "]"}]}], 
            "\[IndentingNewLine]", ",", 
            RowBox[{"{", 
             RowBox[{"p1", ",", 
              RowBox[{"-", " ", "1"}], ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"p2", ",", 
              RowBox[{"-", "2"}], ",", "2"}], "}"}]}], "]"}]}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"p", ",", 
           RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}]}], "+", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "nuc", " ", "nuc", " ", "spin", " ", "scalar", " ", "diag", " ", "in",
          " ", "N"}], ",", " ", 
        RowBox[{
         RowBox[{"mN", ".", " ", "\[CapitalDelta]mIRb"}], "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"-", "1"}], ".."}], "1", " ", "\[CapitalDelta]mICs"}], 
          "=", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "1"}], ".."}], "1"}]}]}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"c4", "*", 
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"N1", ",", "N2"}], "]"}], " ", "*", " ", 
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"mN1", ",", "mN2"}], "]"}], "*", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], "p"], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], 
           RowBox[{
            RowBox[{"+", 
             SubscriptBox["i", "Rb"]}], "-", "mIRb1"}]], 
          RowBox[{"ThreeJSymbol", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              SubscriptBox["i", "Rb"], ",", 
              RowBox[{"-", "mIRb1"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "p"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              SubscriptBox["i", "Rb"], ",", "mIRb2"}], "}"}]}], "]"}], 
          RowBox[{"Sqrt", "[", 
           RowBox[{
            SubscriptBox["i", "Rb"], 
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["i", "Rb"], "+", "1"}], ")"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", 
               SubscriptBox["i", "Rb"]}], "+", "1"}], ")"}]}], "]"}], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], 
           RowBox[{
            RowBox[{"+", 
             SubscriptBox["i", "Cs"]}], "-", "mICs1"}]], 
          RowBox[{"ThreeJSymbol", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              SubscriptBox["i", "Cs"], ",", 
              RowBox[{"-", "mICs1"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", 
              RowBox[{"-", "p"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              SubscriptBox["i", "Cs"], ",", "mICs2"}], "}"}]}], "]"}], 
          RowBox[{"Sqrt", "[", 
           RowBox[{
            SubscriptBox["i", "Cs"], 
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["i", "Cs"], "+", "1"}], ")"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", 
               SubscriptBox["i", "Cs"]}], "+", "1"}], ")"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"p", ",", 
           RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"HeffNofields", "[", 
      RowBox[{
      "mIRb1_", ",", "mICs1_", ",", "N1_", ",", "mN1_", ",", "mIRb2_", ",", 
       "mICs2_", ",", "N2_", ",", "mN2_"}], "]"}], ":=", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"rotation", " ", "diag", " ", "in", " ", "all"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"mIRb1", ",", "mIRb2"}], "]"}], " ", "*", " ", 
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"mICs1", ",", "mICs2"}], "]"}], "*", 
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"N1", ",", "N2"}], "]"}], " ", "*", " ", 
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"mN1", ",", "mN2"}], "]"}], "*", 
       SubscriptBox["B", "RbCs"], "N1", 
       RowBox[{"(", 
        RowBox[{"N1", "+", "1"}], ")"}]}], "+", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"RbQP", " ", "diag", " ", "in", " ", 
          RowBox[{"mICs", ".", " ", "\[CapitalDelta]N"}]}], "=", 
         RowBox[{"-", "2"}]}], ",", "0", ",", 
        RowBox[{
         RowBox[{"2", " ", "\[CapitalDelta]mN"}], "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], ".."}], "2", " ", "\[CapitalDelta]mIRb"}], 
          "=", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], ".."}], "2"}]}]}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["eqQ", "Rb"], "/", "4"}], ")"}], "*", 
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"mICs1", ",", "mICs2"}], "]"}], "*", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], 
           RowBox[{"p", "+", "N1", "-", "mN1"}]], 
          RowBox[{"ThreeJSymbol", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"N1", ",", 
              RowBox[{"-", "mN1"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"2", ",", "p"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"N2", ",", "mN2"}], "}"}]}], "]"}], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], "N1"], 
          RowBox[{"Sqrt", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", "N1"}], "+", "1"}], ")"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", "N2"}], "+", "1"}], ")"}]}], "]"}], 
          RowBox[{"ThreeJSymbol", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"N1", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"2", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"N2", ",", "0"}], "}"}]}], "]"}], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], 
           RowBox[{
            SubscriptBox["i", "Rb"], "-", "mIRb1"}]], 
          RowBox[{
           RowBox[{"ThreeJSymbol", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               SubscriptBox["i", "Rb"], ",", 
               RowBox[{"-", "mIRb1"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"2", ",", 
               RowBox[{"-", "p"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               SubscriptBox["i", "Rb"], ",", "mIRb2"}], "}"}]}], "]"}], "/", 
           RowBox[{"ThreeJSymbol", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               SubscriptBox["i", "Rb"], ",", 
               RowBox[{"-", 
                SubscriptBox["i", "Rb"]}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"2", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               SubscriptBox["i", "Rb"], ",", 
               SubscriptBox["i", "Rb"]}], "}"}]}], "]"}]}]}], ",", 
         RowBox[{"{", 
          RowBox[{"p", ",", 
           RowBox[{"-", "2"}], ",", "2"}], "}"}]}], "]"}]}], "+", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"CsQP", " ", "diag", " ", "in", " ", 
          RowBox[{"mIRb", ".", " ", "\[CapitalDelta]N"}]}], "=", 
         RowBox[{"-", "2"}]}], ",", "0", ",", 
        RowBox[{
         RowBox[{"2", " ", "\[CapitalDelta]mN"}], "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], ".."}], "2", " ", "\[CapitalDelta]mICs"}], 
          "=", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], ".."}], "2"}]}]}]}], " ", "*)"}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["eqQ", "Cs"], "/", "4"}], ")"}], "*", 
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"mIRb1", ",", "mIRb2"}], "]"}], "*", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], 
           RowBox[{"p", "+", "N1", "-", "mN1"}]], 
          RowBox[{"ThreeJSymbol", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"N1", ",", 
              RowBox[{"-", "mN1"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"2", ",", "p"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"N2", ",", "mN2"}], "}"}]}], "]"}], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], "N1"], 
          RowBox[{"Sqrt", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", "N1"}], "+", "1"}], ")"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", "N2"}], "+", "1"}], ")"}]}], "]"}], 
          RowBox[{"ThreeJSymbol", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"N1", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"2", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"N2", ",", "0"}], "}"}]}], "]"}], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], 
           RowBox[{
            SubscriptBox["i", "Cs"], "-", "mICs1"}]], 
          RowBox[{
           RowBox[{"ThreeJSymbol", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               SubscriptBox["i", "Cs"], ",", 
               RowBox[{"-", "mICs1"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"2", ",", 
               RowBox[{"-", "p"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               SubscriptBox["i", "Cs"], ",", "mICs2"}], "}"}]}], "]"}], "/", 
           RowBox[{"ThreeJSymbol", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               SubscriptBox["i", "Cs"], ",", 
               RowBox[{"-", 
                SubscriptBox["i", "Cs"]}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"2", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               SubscriptBox["i", "Cs"], ",", 
               SubscriptBox["i", "Cs"]}], "}"}]}], "]"}]}]}], ",", 
         RowBox[{"{", 
          RowBox[{"p", ",", 
           RowBox[{"-", "2"}], ",", "2"}], "}"}]}], "]"}]}], "+", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "Rb", " ", "spin", " ", "rot", " ", "diag", " ", "in", " ", "mICs"}], 
        ",", 
        RowBox[{
         RowBox[{"N", ".", " ", "\[CapitalDelta]mN"}], "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"-", "1"}], ".."}], "1", " ", "\[CapitalDelta]mIRb"}], 
          "=", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "1"}], ".."}], "1"}]}]}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       SubscriptBox["c", "Rb"], "*", 
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"mICs1", ",", "mICs2"}], "]"}], "*", 
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"N1", ",", "N2"}], "]"}], "*", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], 
           RowBox[{"p", "+", "N1", "-", "mN1", "+", 
            SubscriptBox["i", "Rb"], "-", "mIRb1"}]], 
          RowBox[{"Sqrt", "[", 
           RowBox[{"N1", 
            RowBox[{"(", 
             RowBox[{"N1", "+", "1"}], ")"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", "N1"}], "+", "1"}], ")"}], 
            SubscriptBox["i", "Rb"], 
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["i", "Rb"], "+", "1"}], ")"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", 
               SubscriptBox["i", "Rb"]}], "+", "1"}], ")"}]}], "]"}], 
          RowBox[{"ThreeJSymbol", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"N1", ",", 
              RowBox[{"-", "mN1"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "p"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"N1", ",", "mN2"}], "}"}]}], "]"}], 
          RowBox[{"ThreeJSymbol", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              SubscriptBox["i", "Rb"], ",", 
              RowBox[{"-", "mIRb1"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", 
              RowBox[{"-", "p"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              SubscriptBox["i", "Rb"], ",", "mIRb2"}], "}"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"p", ",", 
           RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}]}], "+", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "Cs", " ", "spin", " ", "rot", " ", "diag", " ", "in", " ", "mIRb"}], 
        ",", 
        RowBox[{
         RowBox[{"N", ".", " ", "\[CapitalDelta]mN"}], "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"-", "1"}], ".."}], "1", " ", "\[CapitalDelta]mICs"}], 
          "=", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "1"}], ".."}], "1"}]}]}]}], " ", "*)"}], 
      RowBox[{
       SubscriptBox["c", "Cs"], "*", 
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"mIRb1", ",", "mIRb2"}], "]"}], "*", 
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"N1", ",", "N2"}], "]"}], "*", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], 
           RowBox[{"p", "+", "N1", "-", "mN1", "+", 
            SubscriptBox["i", "Cs"], "-", "mICs1"}]], 
          RowBox[{"Sqrt", "[", 
           RowBox[{"N1", 
            RowBox[{"(", 
             RowBox[{"N1", "+", "1"}], ")"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", "N1"}], "+", "1"}], ")"}], 
            SubscriptBox["i", "Cs"], 
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["i", "Cs"], "+", "1"}], ")"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", 
               SubscriptBox["i", "Cs"]}], "+", "1"}], ")"}]}], "]"}], 
          RowBox[{"ThreeJSymbol", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"N1", ",", 
              RowBox[{"-", "mN1"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "p"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"N1", ",", "mN2"}], "}"}]}], "]"}], 
          RowBox[{"ThreeJSymbol", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              SubscriptBox["i", "Cs"], ",", 
              RowBox[{"-", "mICs1"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", 
              RowBox[{"-", "p"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              SubscriptBox["i", "Cs"], ",", "mICs2"}], "}"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"p", ",", 
           RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}]}], "-", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
         RowBox[{
         "nuc", " ", "nuc", " ", "spin", " ", "tensor", " ", 
          "\[CapitalDelta]N"}], "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], ".."}], "2", " ", "\[CapitalDelta]mN"}], "=", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"-", "2"}], ".."}], "2", " ", "\[CapitalDelta]mIRb"}], 
           "=", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"-", "1"}], ".."}], "1", " ", "\[CapitalDelta]mICs"}], 
            "=", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"-", "1"}], ".."}], "1", "   ", "B"}], "&"}], "C", 
             " ", "8.314"}]}]}]}]}], ",", " ", 
        RowBox[{
         RowBox[{"8.302", " ", "but", " ", "error", " ", "in", " ", 
          RowBox[{"formula", ".", "  ", "q"}]}], "=", 
         RowBox[{"0", " ", "term", " ", "only"}]}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Sqrt", "[", "30", "]"}], "*", "c3", " ", "*", 
       "\[IndentingNewLine]", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], 
           RowBox[{
            SubscriptBox["i", "Cs"], "-", "mICs1", "+", 
            SubscriptBox["i", "Rb"], "-", "mIRb1"}]], 
          RowBox[{"ThreeJSymbol", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              SubscriptBox["i", "Cs"], ",", 
              RowBox[{"-", "mICs1"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", 
              RowBox[{"-", "p"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              SubscriptBox["i", "Cs"], ",", "mICs2"}], "}"}]}], "]"}], 
          RowBox[{"Sqrt", "[", 
           RowBox[{
            SubscriptBox["i", "Rb"], 
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["i", "Rb"], "+", "1"}], ")"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", 
               SubscriptBox["i", "Rb"]}], "+", "1"}], ")"}], 
            SubscriptBox["i", "Cs"], 
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["i", "Cs"], "+", "1"}], ")"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", 
               SubscriptBox["i", "Cs"]}], "+", "1"}], ")"}]}], "]"}], 
          "\[IndentingNewLine]", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], "N1"], 
             RowBox[{"Sqrt", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"2", "N1"}], "+", "1"}], ")"}], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"2", "N2"}], "+", "1"}], ")"}]}], "]"}], 
             RowBox[{"ThreeJSymbol", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"N1", ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"2", ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"N2", ",", "0"}], "}"}]}], "]"}], 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{"N1", "-", "mN1"}]], 
             RowBox[{"ThreeJSymbol", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"N1", ",", 
                 RowBox[{"-", "mN1"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"2", ",", "p2"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"N2", ",", "mN2"}], "}"}]}], "]"}], 
             RowBox[{"ThreeJSymbol", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 SubscriptBox["i", "Rb"], ",", 
                 RowBox[{"-", "mIRb1"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", "p1"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 SubscriptBox["i", "Rb"], ",", "mIRb2"}], "}"}]}], "]"}], 
             RowBox[{"ThreeJSymbol", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"1", ",", "p1"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"2", ",", "p2"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", 
                 RowBox[{"-", "p"}]}], "}"}]}], "]"}]}], 
            "\[IndentingNewLine]", ",", 
            RowBox[{"{", 
             RowBox[{"p1", ",", 
              RowBox[{"-", " ", "1"}], ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"p2", ",", 
              RowBox[{"-", "2"}], ",", "2"}], "}"}]}], "]"}]}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"p", ",", 
           RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}]}], "+", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "nuc", " ", "nuc", " ", "spin", " ", "scalar", " ", "diag", " ", "in",
          " ", "N"}], ",", " ", 
        RowBox[{
         RowBox[{"mN", ".", " ", "\[CapitalDelta]mIRb"}], "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"-", "1"}], ".."}], "1", " ", "\[CapitalDelta]mICs"}], 
          "=", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"-", "1"}], ".."}], "1", "   ", "B"}], "&"}], "C", " ", 
           "8.319"}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"c4", "*", 
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"N1", ",", "N2"}], "]"}], " ", "*", " ", 
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"mN1", ",", "mN2"}], "]"}], "*", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], "p"], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], 
           RowBox[{
            RowBox[{"+", 
             SubscriptBox["i", "Rb"]}], "-", "mIRb1"}]], 
          RowBox[{"ThreeJSymbol", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              SubscriptBox["i", "Rb"], ",", 
              RowBox[{"-", "mIRb1"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "p"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              SubscriptBox["i", "Rb"], ",", "mIRb2"}], "}"}]}], "]"}], 
          RowBox[{"Sqrt", "[", 
           RowBox[{
            SubscriptBox["i", "Rb"], 
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["i", "Rb"], "+", "1"}], ")"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", 
               SubscriptBox["i", "Rb"]}], "+", "1"}], ")"}]}], "]"}], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], 
           RowBox[{
            RowBox[{"+", 
             SubscriptBox["i", "Cs"]}], "-", "mICs1"}]], 
          RowBox[{"ThreeJSymbol", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              SubscriptBox["i", "Cs"], ",", 
              RowBox[{"-", "mICs1"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", 
              RowBox[{"-", "p"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              SubscriptBox["i", "Cs"], ",", "mICs2"}], "}"}]}], "]"}], 
          RowBox[{"Sqrt", "[", 
           RowBox[{
            SubscriptBox["i", "Cs"], 
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["i", "Cs"], "+", "1"}], ")"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", 
               SubscriptBox["i", "Cs"]}], "+", "1"}], ")"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"p", ",", 
           RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"old", " ", "nuc", " ", "dip", " ", "dip"}], 
     "\[IndentingNewLine]", "-", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
        RowBox[{
        "nuc", " ", "nuc", " ", "spin", " ", "tensor", " ", 
         "\[CapitalDelta]N"}], "=", 
        RowBox[{"-", "2"}]}], ",", "0", ",", 
       RowBox[{
        RowBox[{"2", " ", "\[CapitalDelta]N"}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"-", "1"}], ".."}], "1", " ", "\[CapitalDelta]mIRb"}], "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"-", "1"}], ".."}], "1", " ", "\[CapitalDelta]mICs"}], 
          "=", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "1"}], ".."}], "1"}]}]}]}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Sqrt", "[", "30", "]"}], "*", "c3", " ", "*", 
      "\[IndentingNewLine]", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"-", "1"}], ")"}], 
          RowBox[{
           SubscriptBox["i", "Cs"], "-", "mICs1", "+", 
           SubscriptBox["i", "Rb"], "-", "mIRb1"}]], 
         RowBox[{"ThreeJSymbol", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             SubscriptBox["i", "Cs"], ",", 
             RowBox[{"-", "mICs1"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"-", "p"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             SubscriptBox["i", "Cs"], ",", "mICs2"}], "}"}]}], "]"}], 
         RowBox[{"Sqrt", "[", 
          RowBox[{
           SubscriptBox["i", "Rb"], 
           RowBox[{"(", 
            RowBox[{
             SubscriptBox["i", "Rb"], "+", "1"}], ")"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", 
              SubscriptBox["i", "Rb"]}], "+", "1"}], ")"}], 
           SubscriptBox["i", "Cs"], 
           RowBox[{"(", 
            RowBox[{
             SubscriptBox["i", "Cs"], "+", "1"}], ")"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", 
              SubscriptBox["i", "Cs"]}], "+", "1"}], ")"}]}], "]"}], 
         "\[IndentingNewLine]", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"-", "1"}], ")"}], "N1"], 
            RowBox[{"Sqrt", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"2", "N1"}], "+", "1"}], ")"}], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"2", "N2"}], "+", "1"}], ")"}]}], "]"}], 
            RowBox[{"ThreeJSymbol", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"N1", ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"2", ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"N2", ",", "0"}], "}"}]}], "]"}], 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"-", "1"}], ")"}], 
             RowBox[{"N1", "-", "mN1"}]], 
            RowBox[{"ThreeJSymbol", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"N1", ",", 
                RowBox[{"-", "mN1"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", "p1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"N2", ",", "mN2"}], "}"}]}], "]"}], 
            RowBox[{"ThreeJSymbol", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                SubscriptBox["i", "Rb"], ",", 
                RowBox[{"-", "mIRb1"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", 
                RowBox[{"-", "p2"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                SubscriptBox["i", "Rb"], ",", "mIRb2"}], "}"}]}], "]"}], 
            RowBox[{"ThreeJSymbol", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", "p1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"2", ",", "p2"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", 
                RowBox[{"-", "p"}]}], "}"}]}], "]"}]}], "\[IndentingNewLine]",
            ",", 
           RowBox[{"{", 
            RowBox[{"p1", ",", 
             RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"p2", ",", 
             RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}]}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"p", ",", 
          RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"HeffNofieldsNoQPNoiitensor", "[", 
      RowBox[{
      "mIRb1_", ",", "mICs1_", ",", "N1_", ",", "mN1_", ",", "mIRb2_", ",", 
       "mICs2_", ",", "N2_", ",", "mN2_"}], "]"}], ":=", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"rotation", " ", "diag", " ", "in", " ", "all"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"mIRb1", ",", "mIRb2"}], "]"}], " ", "*", " ", 
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"mICs1", ",", "mICs2"}], "]"}], "*", 
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"N1", ",", "N2"}], "]"}], " ", "*", " ", 
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"mN1", ",", "mN2"}], "]"}], "*", 
       SubscriptBox["B", "RbCs"], "N1", 
       RowBox[{"(", 
        RowBox[{"N1", "+", "1"}], ")"}]}], "+", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "Rb", " ", "spin", " ", "rot", " ", "diag", " ", "in", " ", "mICs"}], 
        ",", 
        RowBox[{
         RowBox[{"N", ".", " ", "\[CapitalDelta]mN"}], "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"-", "1"}], ".."}], "1", " ", "\[CapitalDelta]mIRb"}], 
          "=", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "1"}], ".."}], "1"}]}]}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       SubscriptBox["c", "Rb"], "*", 
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"mICs1", ",", "mICs2"}], "]"}], "*", 
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"N1", ",", "N2"}], "]"}], "*", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], 
           RowBox[{"p", "+", "N1", "-", "mN1", "+", 
            SubscriptBox["i", "Rb"], "-", "mIRb1"}]], 
          RowBox[{"Sqrt", "[", 
           RowBox[{"N1", 
            RowBox[{"(", 
             RowBox[{"N1", "+", "1"}], ")"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", "N1"}], "+", "1"}], ")"}], 
            SubscriptBox["i", "Rb"], 
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["i", "Rb"], "+", "1"}], ")"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", 
               SubscriptBox["i", "Rb"]}], "+", "1"}], ")"}]}], "]"}], 
          RowBox[{"ThreeJSymbol", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"N1", ",", 
              RowBox[{"-", "mN1"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "p"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"N1", ",", "mN2"}], "}"}]}], "]"}], 
          RowBox[{"ThreeJSymbol", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              SubscriptBox["i", "Rb"], ",", 
              RowBox[{"-", "mIRb1"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", 
              RowBox[{"-", "p"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              SubscriptBox["i", "Rb"], ",", "mIRb2"}], "}"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"p", ",", 
           RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}]}], "+", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "Cs", " ", "spin", " ", "rot", " ", "diag", " ", "in", " ", "mIRb"}], 
        ",", 
        RowBox[{
         RowBox[{"N", ".", " ", "\[CapitalDelta]mN"}], "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"-", "1"}], ".."}], "1", " ", "\[CapitalDelta]mICs"}], 
          "=", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "1"}], ".."}], "1"}]}]}]}], " ", "*)"}], 
      RowBox[{
       SubscriptBox["c", "Cs"], "*", 
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"mIRb1", ",", "mIRb2"}], "]"}], "*", 
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"N1", ",", "N2"}], "]"}], "*", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], 
           RowBox[{"p", "+", "N1", "-", "mN1", "+", 
            SubscriptBox["i", "Cs"], "-", "mICs1"}]], 
          RowBox[{"Sqrt", "[", 
           RowBox[{"N1", 
            RowBox[{"(", 
             RowBox[{"N1", "+", "1"}], ")"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", "N1"}], "+", "1"}], ")"}], 
            SubscriptBox["i", "Cs"], 
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["i", "Cs"], "+", "1"}], ")"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", 
               SubscriptBox["i", "Cs"]}], "+", "1"}], ")"}]}], "]"}], 
          RowBox[{"ThreeJSymbol", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"N1", ",", 
              RowBox[{"-", "mN1"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "p"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"N1", ",", "mN2"}], "}"}]}], "]"}], 
          RowBox[{"ThreeJSymbol", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              SubscriptBox["i", "Cs"], ",", 
              RowBox[{"-", "mICs1"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", 
              RowBox[{"-", "p"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              SubscriptBox["i", "Cs"], ",", "mICs2"}], "}"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"p", ",", 
           RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}]}], "+", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "nuc", " ", "nuc", " ", "spin", " ", "scalar", " ", "diag", " ", "in",
          " ", "N"}], ",", " ", 
        RowBox[{
         RowBox[{"mN", ".", " ", "\[CapitalDelta]mIRb"}], "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"-", "1"}], ".."}], "1", " ", "\[CapitalDelta]mICs"}], 
          "=", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "1"}], ".."}], "1"}]}]}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"c4", "*", 
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"N1", ",", "N2"}], "]"}], " ", "*", " ", 
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"mN1", ",", "mN2"}], "]"}], "*", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], "p"], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], 
           RowBox[{
            RowBox[{"+", 
             SubscriptBox["i", "Rb"]}], "-", "mIRb1"}]], 
          RowBox[{"ThreeJSymbol", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              SubscriptBox["i", "Rb"], ",", 
              RowBox[{"-", "mIRb1"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "p"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              SubscriptBox["i", "Rb"], ",", "mIRb2"}], "}"}]}], "]"}], 
          RowBox[{"Sqrt", "[", 
           RowBox[{
            SubscriptBox["i", "Rb"], 
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["i", "Rb"], "+", "1"}], ")"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", 
               SubscriptBox["i", "Rb"]}], "+", "1"}], ")"}]}], "]"}], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], 
           RowBox[{
            RowBox[{"+", 
             SubscriptBox["i", "Cs"]}], "-", "mICs1"}]], 
          RowBox[{"ThreeJSymbol", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              SubscriptBox["i", "Cs"], ",", 
              RowBox[{"-", "mICs1"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", 
              RowBox[{"-", "p"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              SubscriptBox["i", "Cs"], ",", "mICs2"}], "}"}]}], "]"}], 
          RowBox[{"Sqrt", "[", 
           RowBox[{
            SubscriptBox["i", "Cs"], 
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["i", "Cs"], "+", "1"}], ")"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", 
               SubscriptBox["i", "Cs"]}], "+", "1"}], ")"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"p", ",", 
           RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"HeffNofieldsNoiitensor", "[", 
      RowBox[{
      "mIRb1_", ",", "mICs1_", ",", "N1_", ",", "mN1_", ",", "mIRb2_", ",", 
       "mICs2_", ",", "N2_", ",", "mN2_"}], "]"}], ":=", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"rotation", " ", "diag", " ", "in", " ", "all"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"mIRb1", ",", "mIRb2"}], "]"}], " ", "*", " ", 
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"mICs1", ",", "mICs2"}], "]"}], "*", 
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"N1", ",", "N2"}], "]"}], " ", "*", " ", 
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"mN1", ",", "mN2"}], "]"}], "*", 
       SubscriptBox["B", "RbCs"], "N1", 
       RowBox[{"(", 
        RowBox[{"N1", "+", "1"}], ")"}]}], "+", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"RbQP", " ", "diag", " ", "in", " ", 
          RowBox[{"mICs", ".", " ", "\[CapitalDelta]N"}]}], "=", 
         RowBox[{"-", "2"}]}], ",", "0", ",", 
        RowBox[{
         RowBox[{"2", " ", "\[CapitalDelta]mN"}], "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], ".."}], "2", " ", "\[CapitalDelta]mIRb"}], 
          "=", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], ".."}], "2"}]}]}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["eqQ", "Rb"], "/", "4"}], ")"}], "*", 
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"mICs1", ",", "mICs2"}], "]"}], "*", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], 
           RowBox[{"p", "+", "N1", "-", "mN1"}]], 
          RowBox[{"ThreeJSymbol", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"N1", ",", 
              RowBox[{"-", "mN1"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"2", ",", "p"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"N2", ",", "mN2"}], "}"}]}], "]"}], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], "N1"], 
          RowBox[{"Sqrt", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", "N1"}], "+", "1"}], ")"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", "N2"}], "+", "1"}], ")"}]}], "]"}], 
          RowBox[{"ThreeJSymbol", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"N1", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"2", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"N2", ",", "0"}], "}"}]}], "]"}], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], 
           RowBox[{
            SubscriptBox["i", "Rb"], "-", "mIRb1"}]], 
          RowBox[{
           RowBox[{"ThreeJSymbol", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               SubscriptBox["i", "Rb"], ",", 
               RowBox[{"-", "mIRb1"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"2", ",", 
               RowBox[{"-", "p"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               SubscriptBox["i", "Rb"], ",", "mIRb2"}], "}"}]}], "]"}], "/", 
           RowBox[{"ThreeJSymbol", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               SubscriptBox["i", "Rb"], ",", 
               RowBox[{"-", 
                SubscriptBox["i", "Rb"]}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"2", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               SubscriptBox["i", "Rb"], ",", 
               SubscriptBox["i", "Rb"]}], "}"}]}], "]"}]}]}], ",", 
         RowBox[{"{", 
          RowBox[{"p", ",", 
           RowBox[{"-", "2"}], ",", "2"}], "}"}]}], "]"}]}], "+", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"CsQP", " ", "diag", " ", "in", " ", 
          RowBox[{"mIRb", ".", " ", "\[CapitalDelta]N"}]}], "=", 
         RowBox[{"-", "2"}]}], ",", "0", ",", 
        RowBox[{
         RowBox[{"2", " ", "\[CapitalDelta]mN"}], "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], ".."}], "2", " ", "\[CapitalDelta]mICs"}], 
          "=", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], ".."}], "2"}]}]}]}], " ", "*)"}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["eqQ", "Cs"], "/", "4"}], ")"}], "*", 
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"mIRb1", ",", "mIRb2"}], "]"}], "*", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], 
           RowBox[{"p", "+", "N1", "-", "mN1"}]], 
          RowBox[{"ThreeJSymbol", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"N1", ",", 
              RowBox[{"-", "mN1"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"2", ",", "p"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"N2", ",", "mN2"}], "}"}]}], "]"}], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], "N1"], 
          RowBox[{"Sqrt", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", "N1"}], "+", "1"}], ")"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", "N2"}], "+", "1"}], ")"}]}], "]"}], 
          RowBox[{"ThreeJSymbol", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"N1", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"2", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"N2", ",", "0"}], "}"}]}], "]"}], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], 
           RowBox[{
            SubscriptBox["i", "Cs"], "-", "mICs1"}]], 
          RowBox[{
           RowBox[{"ThreeJSymbol", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               SubscriptBox["i", "Cs"], ",", 
               RowBox[{"-", "mICs1"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"2", ",", 
               RowBox[{"-", "p"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               SubscriptBox["i", "Cs"], ",", "mICs2"}], "}"}]}], "]"}], "/", 
           RowBox[{"ThreeJSymbol", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               SubscriptBox["i", "Cs"], ",", 
               RowBox[{"-", 
                SubscriptBox["i", "Cs"]}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"2", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               SubscriptBox["i", "Cs"], ",", 
               SubscriptBox["i", "Cs"]}], "}"}]}], "]"}]}]}], ",", 
         RowBox[{"{", 
          RowBox[{"p", ",", 
           RowBox[{"-", "2"}], ",", "2"}], "}"}]}], "]"}]}], "+", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "Rb", " ", "spin", " ", "rot", " ", "diag", " ", "in", " ", "mICs"}], 
        ",", 
        RowBox[{
         RowBox[{"N", ".", " ", "\[CapitalDelta]mN"}], "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"-", "1"}], ".."}], "1", " ", "\[CapitalDelta]mIRb"}], 
          "=", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "1"}], ".."}], "1"}]}]}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       SubscriptBox["c", "Rb"], "*", 
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"mICs1", ",", "mICs2"}], "]"}], "*", 
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"N1", ",", "N2"}], "]"}], "*", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], 
           RowBox[{"p", "+", "N1", "-", "mN1", "+", 
            SubscriptBox["i", "Rb"], "-", "mIRb1"}]], 
          RowBox[{"Sqrt", "[", 
           RowBox[{"N1", 
            RowBox[{"(", 
             RowBox[{"N1", "+", "1"}], ")"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", "N1"}], "+", "1"}], ")"}], 
            SubscriptBox["i", "Rb"], 
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["i", "Rb"], "+", "1"}], ")"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", 
               SubscriptBox["i", "Rb"]}], "+", "1"}], ")"}]}], "]"}], 
          RowBox[{"ThreeJSymbol", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"N1", ",", 
              RowBox[{"-", "mN1"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "p"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"N1", ",", "mN2"}], "}"}]}], "]"}], 
          RowBox[{"ThreeJSymbol", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              SubscriptBox["i", "Rb"], ",", 
              RowBox[{"-", "mIRb1"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", 
              RowBox[{"-", "p"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              SubscriptBox["i", "Rb"], ",", "mIRb2"}], "}"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"p", ",", 
           RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}]}], "+", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "Cs", " ", "spin", " ", "rot", " ", "diag", " ", "in", " ", "mIRb"}], 
        ",", 
        RowBox[{
         RowBox[{"N", ".", " ", "\[CapitalDelta]mN"}], "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"-", "1"}], ".."}], "1", " ", "\[CapitalDelta]mICs"}], 
          "=", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "1"}], ".."}], "1"}]}]}]}], " ", "*)"}], 
      RowBox[{
       SubscriptBox["c", "Cs"], "*", 
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"mIRb1", ",", "mIRb2"}], "]"}], "*", 
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"N1", ",", "N2"}], "]"}], "*", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], 
           RowBox[{"p", "+", "N1", "-", "mN1", "+", 
            SubscriptBox["i", "Cs"], "-", "mICs1"}]], 
          RowBox[{"Sqrt", "[", 
           RowBox[{"N1", 
            RowBox[{"(", 
             RowBox[{"N1", "+", "1"}], ")"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", "N1"}], "+", "1"}], ")"}], 
            SubscriptBox["i", "Cs"], 
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["i", "Cs"], "+", "1"}], ")"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", 
               SubscriptBox["i", "Cs"]}], "+", "1"}], ")"}]}], "]"}], 
          RowBox[{"ThreeJSymbol", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"N1", ",", 
              RowBox[{"-", "mN1"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "p"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"N1", ",", "mN2"}], "}"}]}], "]"}], 
          RowBox[{"ThreeJSymbol", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              SubscriptBox["i", "Cs"], ",", 
              RowBox[{"-", "mICs1"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", 
              RowBox[{"-", "p"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              SubscriptBox["i", "Cs"], ",", "mICs2"}], "}"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"p", ",", 
           RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}]}], "+", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "nuc", " ", "nuc", " ", "spin", " ", "scalar", " ", "diag", " ", "in",
          " ", "N"}], ",", " ", 
        RowBox[{
         RowBox[{"mN", ".", " ", "\[CapitalDelta]mIRb"}], "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"-", "1"}], ".."}], "1", " ", "\[CapitalDelta]mICs"}], 
          "=", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "1"}], ".."}], "1"}]}]}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"c4", "*", 
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"N1", ",", "N2"}], "]"}], " ", "*", " ", 
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"mN1", ",", "mN2"}], "]"}], "*", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], "p"], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], 
           RowBox[{
            RowBox[{"+", 
             SubscriptBox["i", "Rb"]}], "-", "mIRb1"}]], 
          RowBox[{"ThreeJSymbol", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              SubscriptBox["i", "Rb"], ",", 
              RowBox[{"-", "mIRb1"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "p"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              SubscriptBox["i", "Rb"], ",", "mIRb2"}], "}"}]}], "]"}], 
          RowBox[{"Sqrt", "[", 
           RowBox[{
            SubscriptBox["i", "Rb"], 
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["i", "Rb"], "+", "1"}], ")"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", 
               SubscriptBox["i", "Rb"]}], "+", "1"}], ")"}]}], "]"}], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], 
           RowBox[{
            RowBox[{"+", 
             SubscriptBox["i", "Cs"]}], "-", "mICs1"}]], 
          RowBox[{"ThreeJSymbol", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              SubscriptBox["i", "Cs"], ",", 
              RowBox[{"-", "mICs1"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", 
              RowBox[{"-", "p"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              SubscriptBox["i", "Cs"], ",", "mICs2"}], "}"}]}], "]"}], 
          RowBox[{"Sqrt", "[", 
           RowBox[{
            SubscriptBox["i", "Cs"], 
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["i", "Cs"], "+", "1"}], ")"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", 
               SubscriptBox["i", "Cs"]}], "+", "1"}], ")"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"p", ",", 
           RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{
      "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", 
       "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
        "**", "**"}], "*", 
      RowBox[{
      "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", 
       "**", "**", "**"}]}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
     "Formulas", " ", "to", " ", "get", " ", "quantum", " ", "numbers", " ", 
      "from", " ", "Hamiltonian", " ", "matrix", " ", 
      RowBox[{"index", ".", "  ", "For"}], " ", "reference", " ", 
      RowBox[{"only", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{
      "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", 
       "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
        "**", "**"}], "*", 
      RowBox[{
      "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", 
       "**", "**", "**"}]}], " ", "*)"}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"mICs2", "[", "m_", "]"}], ":=", 
      RowBox[{
       RowBox[{"Mod", "[", 
        RowBox[{
         RowBox[{"Mod", "[", 
          RowBox[{
           RowBox[{"m", "-", "1"}], ",", "32"}], "]"}], ",", "8"}], "]"}], 
       "-", 
       RowBox[{"7", "/", "2"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"mIRb2", "[", "m_", "]"}], ":=", 
      RowBox[{
       RowBox[{"Quotient", "[", 
        RowBox[{
         RowBox[{"Mod", "[", 
          RowBox[{
           RowBox[{"m", "-", "1"}], ",", "32"}], "]"}], ",", "8"}], "]"}], 
       "-", 
       RowBox[{"3", "/", "2"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"N2", "[", "m_", "]"}], ":=", 
      RowBox[{"Floor", "[", 
       RowBox[{
        RowBox[{"Sqrt", "[", 
         RowBox[{"Quotient", "[", 
          RowBox[{
           RowBox[{"m", "-", "1"}], ",", "32"}], "]"}], "]"}], ",", "1"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"mN2", "[", "m_", "]"}], ":=", 
      RowBox[{
       RowBox[{"Quotient", "[", 
        RowBox[{
         RowBox[{"m", "-", "1"}], ",", "32"}], "]"}], "-", 
       RowBox[{
        RowBox[{"Floor", "[", 
         RowBox[{"Sqrt", "[", 
          RowBox[{"Quotient", "[", 
           RowBox[{
            RowBox[{"m", "-", "1"}], ",", "32"}], "]"}], "]"}], "]"}], "^", 
        "2"}], "-", 
       RowBox[{"Floor", "[", 
        RowBox[{"Sqrt", "[", 
         RowBox[{"Quotient", "[", 
          RowBox[{
           RowBox[{"m", "-", "1"}], ",", "32"}], "]"}], "]"}], "]"}]}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"N1", "[", "n_", "]"}], ":=", 
      RowBox[{"Floor", "[", 
       RowBox[{
        RowBox[{"Sqrt", "[", 
         RowBox[{"Quotient", "[", 
          RowBox[{
           RowBox[{"n", "-", "1"}], ",", "32"}], "]"}], "]"}], ",", "1"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"mN1", "[", "n_", "]"}], ":=", 
      RowBox[{
       RowBox[{"Quotient", "[", 
        RowBox[{
         RowBox[{"n", "-", "1"}], ",", "32"}], "]"}], "-", 
       RowBox[{
        RowBox[{"Floor", "[", 
         RowBox[{"Sqrt", "[", 
          RowBox[{"Quotient", "[", 
           RowBox[{
            RowBox[{"n", "-", "1"}], ",", "32"}], "]"}], "]"}], "]"}], "^", 
        "2"}], "-", 
       RowBox[{"Floor", "[", 
        RowBox[{"Sqrt", "[", 
         RowBox[{"Quotient", "[", 
          RowBox[{
           RowBox[{"n", "-", "1"}], ",", "32"}], "]"}], "]"}], "]"}]}]}], 
     ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
       "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
       "**"}], "*", 
     RowBox[{
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**"}], 
     "*"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Code", " ", "snippets", " ", "to", " ", "generate", " ", "matrices", " ",
      "and", " ", "save", " ", "to", " ", 
     RowBox[{"disk", ".", "  ", "Only"}], " ", "need", " ", "to", " ", "run", 
     " ", "once", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
       "Ignore", " ", "if", " ", "the", " ", "matrices", " ", "are", " ", 
        "already", " ", "generated"}], ")"}], "."}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
       "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
       "**"}], "*", 
     RowBox[{
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**"}], 
     "*"}], " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{"generate", " ", "field"}], "-", 
      RowBox[{"free", " ", "effective", " ", "Hamiltonian", " ", "matrix"}]}],
      " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Nmax", "=", "2"}], ";", " ", 
     RowBox[{"(*", " ", 
      RowBox[{
      "rotational", " ", "level", " ", "in", " ", "basis", " ", "set"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<Number of levels = \>\"", ",", 
       RowBox[{"Nlevels", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"Nmax", "+", "1"}], ")"}], "^", "2"}], "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", "  ", 
            SubscriptBox["i", "Rb"]}], "+", "1"}], ")"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", "*", 
            SubscriptBox["i", "Cs"]}], "+", "1"}], ")"}]}]}]}], "]"}], ";", 
     RowBox[{"(*", " ", 
      RowBox[{"number", " ", "of", " ", "levels"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"m", "=", " ", "0"}], ";", " ", "\n", 
     RowBox[{"H", "=", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"Nlevels", ",", "Nlevels"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"m", " ", "=", 
         RowBox[{"1", "+", 
          RowBox[{"(", 
           RowBox[{"mICs2", "-", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "7"}], "/", "2"}], ")"}]}], ")"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"mIRb2", "-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "3"}], "/", "2"}], ")"}]}], ")"}], "*", "8"}], 
          "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"mN2", "-", 
             RowBox[{"(", 
              RowBox[{"-", "N2"}], ")"}]}], ")"}], "*", "32"}], "+", 
          RowBox[{"32", "*", 
           RowBox[{"UnitStep", "[", 
            RowBox[{"N2", "-", ".5"}], "]"}], 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"2", "x"}], "+", "1"}], ",", 
             RowBox[{"{", 
              RowBox[{"x", ",", "0", ",", 
               RowBox[{"N2", "-", "1"}]}], "}"}]}], "]"}]}]}]}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"n", " ", "=", 
            RowBox[{"1", "+", 
             RowBox[{"(", 
              RowBox[{"mICs1", "-", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "7"}], "/", "2"}], ")"}]}], ")"}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"mIRb1", "-", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "3"}], "/", "2"}], ")"}]}], ")"}], "*", "8"}], 
             "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"mN1", "-", 
                RowBox[{"(", 
                 RowBox[{"-", "N1"}], ")"}]}], ")"}], "*", "32"}], "+", 
             RowBox[{"32", "*", 
              RowBox[{"UnitStep", "[", 
               RowBox[{"N1", "-", ".5"}], "]"}], 
              RowBox[{"Sum", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"2", "x"}], "+", "1"}], ",", 
                RowBox[{"{", 
                 RowBox[{"x", ",", "0", ",", 
                  RowBox[{"N1", "-", "1"}]}], "}"}]}], "]"}]}]}]}], ";", 
           RowBox[{
            RowBox[{"H", "[", 
             RowBox[{"[", 
              RowBox[{"m", ",", "n"}], "]"}], "]"}], "=", 
            RowBox[{"HeffNofields", "[", 
             RowBox[{
             "mIRb1", ",", "mICs1", ",", "N1", ",", "mN1", ",", "mIRb2", ",", 
              "mICs2", ",", "N2", ",", "mN2"}], "]"}]}], ";"}], 
          "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"N1", ",", 
            RowBox[{"Max", "[", 
             RowBox[{
              RowBox[{"N2", "-", "1"}], ",", "0"}], "]"}], ",", 
            RowBox[{"Min", "[", 
             RowBox[{
              RowBox[{"N2", "+", "1"}], ",", "Nmax"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"mN1", ",", 
            RowBox[{"Max", "[", 
             RowBox[{
              RowBox[{"mN2", "-", "2"}], ",", 
              RowBox[{"-", "N1"}]}], "]"}], ",", 
            RowBox[{"Min", "[", 
             RowBox[{
              RowBox[{"mN2", "+", "2"}], ",", "N1"}], "]"}]}], "}"}], ",", 
          " ", 
          RowBox[{"{", 
           RowBox[{"mIRb1", ",", 
            RowBox[{"Max", "[", 
             RowBox[{
              RowBox[{"mIRb2", "-", "2"}], ",", 
              RowBox[{"-", 
               SubscriptBox["i", "Rb"]}]}], "]"}], ",", " ", 
            RowBox[{"Min", "[", 
             RowBox[{
              RowBox[{"mIRb2", "+", "2"}], ",", 
              SubscriptBox["i", "Rb"]}], "]"}]}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"mICs1", ",", 
            RowBox[{"Max", "[", 
             RowBox[{
              RowBox[{"mICs2", "-", "2"}], ",", 
              RowBox[{"-", 
               SubscriptBox["i", "Cs"]}]}], "]"}], ",", " ", 
            RowBox[{"Min", "[", 
             RowBox[{
              RowBox[{"mICs2", "+", "2"}], ",", 
              SubscriptBox["i", "Cs"]}], "]"}]}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Mod", "[", 
            RowBox[{"m", ",", "100"}], "]"}], "==", "0"}], ",", 
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<row \>\"", ",", "m", ",", "\"\</\>\"", ",", "Nlevels"}], 
           "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"N2", ",", "0", ",", "Nmax"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"mN2", ",", 
         RowBox[{"-", "N2"}], ",", "N2"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"mIRb2", ",", 
         RowBox[{"-", 
          SubscriptBox["i", "Rb"]}], ",", " ", 
         SubscriptBox["i", "Rb"]}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"mICs2", ",", 
         RowBox[{"-", 
          SubscriptBox["i", "Cs"]}], ",", " ", 
         SubscriptBox["i", "Cs"]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"SetDirectory", "[", 
      StyleBox["libPath", "SearchResultSummary"], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"H", ">>", 
      RowBox[{"\"\<fieldfreematrixNmax2.nb\>\"", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", "\"\<done!\>\"", "]"}], "\[IndentingNewLine]", 
       RowBox[{"Quit", "[", "]"}]}]}]}], "\[IndentingNewLine]", "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"generate", " ", "Stark", " ", "Hamiltonian", " ", "matrices"}], 
     " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"fmin", "=", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"fmax", "=", "20"}], ";", "\[IndentingNewLine]", 
     RowBox[{"NF", "=", "21"}], ";", " ", 
     RowBox[{"(*", " ", 
      RowBox[{"number", " ", "of", " ", "fields"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"HStark", "[", 
       RowBox[{
       "mIRb1_", ",", "mICs1_", ",", "N1_", ",", "mN1_", ",", "mIRb2_", ",", 
        "mICs2_", ",", "N2_", ",", "mN2_", ",", "Ez_"}], "]"}], ":=", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
         RowBox[{
         "Stark", " ", "diag", " ", "in", " ", "mIRb", " ", "mICs", " ", 
          RowBox[{"mN", ".", "  ", "\[CapitalDelta]N"}]}], " ", "=", " ", 
         "0"}], ",", 
        RowBox[{"+", 
         RowBox[{"-", "1"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"-", " ", 
        RowBox[{"KroneckerDelta", "[", 
         RowBox[{"mIRb1", ",", "mIRb2"}], "]"}]}], " ", "*", " ", 
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"mICs1", ",", "mICs2"}], "]"}], "*", 
       SubscriptBox["d", "RbCs"], "*", "Ez", "*", 
       RowBox[{"Sqrt", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", "N1"}], "+", "1"}], ")"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", "N2"}], "+", "1"}], ")"}]}], "]"}], "*", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"-", "1"}], ")"}], "^", "mN1"}], "*", 
       RowBox[{"ThreeJSymbol", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"N1", ",", 
           RowBox[{"-", "mN1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"N2", ",", "mN2"}], "}"}]}], "]"}], "*", 
       RowBox[{"ThreeJSymbol", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"N1", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"N2", ",", "0"}], "}"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Nmax", "=", "2"}], ";", " ", 
     RowBox[{"(*", " ", 
      RowBox[{
      "highest", " ", "rotational", " ", "level", " ", "in", " ", "basis", 
       " ", "set"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<Number of levels = \>\"", ",", 
       RowBox[{"Nlevels", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"Nmax", "+", "1"}], ")"}], "^", "2"}], "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", "*", 
            SubscriptBox["i", "Rb"]}], "+", "1"}], ")"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", "*", 
            SubscriptBox["i", "Cs"]}], "+", "1"}], ")"}]}]}]}], "]"}], ";", 
     RowBox[{"(*", " ", 
      RowBox[{"number", " ", "of", " ", "levels"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"m", "=", " ", "0"}], ";", " ", "\n", 
     RowBox[{"(*", 
      RowBox[{"Do", "["}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"H", "=", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"Nlevels", ",", "Nlevels"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"m", " ", "=", 
         RowBox[{"1", "+", 
          RowBox[{"(", 
           RowBox[{"mICs2", "-", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "7"}], "/", "2"}], ")"}]}], ")"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"mIRb2", "-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "3"}], "/", "2"}], ")"}]}], ")"}], "*", "8"}], 
          "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"mN2", "-", 
             RowBox[{"(", 
              RowBox[{"-", "N2"}], ")"}]}], ")"}], "*", "32"}], "+", 
          RowBox[{"32", "*", 
           RowBox[{"N2", "^", "2"}]}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"n", " ", "=", 
            RowBox[{"1", "+", 
             RowBox[{"(", 
              RowBox[{"mICs2", "-", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "7"}], "/", "2"}], ")"}]}], ")"}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"mIRb2", "-", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "3"}], "/", "2"}], ")"}]}], ")"}], "*", "8"}], 
             "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"mN1", "-", 
                RowBox[{"(", 
                 RowBox[{"-", "N1"}], ")"}]}], ")"}], "*", "32"}], "+", 
             RowBox[{"32", "*", 
              RowBox[{"N1", "^", "2"}]}]}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"H", "[", 
             RowBox[{"[", 
              RowBox[{"m", ",", "n"}], "]"}], "]"}], "=", 
            RowBox[{"HStark", "[", 
             RowBox[{
             "mIRb2", ",", "mICs2", ",", "N1", ",", "mN1", ",", "mIRb2", ",", 
              "mICs2", ",", "N2", ",", "mN2", ",", "1"}], "]"}]}], ";"}], 
          "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"N1", ",", 
            RowBox[{"Max", "[", 
             RowBox[{
              RowBox[{"N2", "-", "1"}], ",", "0"}], "]"}], ",", 
            RowBox[{"Min", "[", 
             RowBox[{
              RowBox[{"N2", "+", "1"}], ",", "Nmax"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"mN1", ",", 
            RowBox[{"Max", "[", 
             RowBox[{
              RowBox[{"mN2", "-", "1"}], ",", 
              RowBox[{"-", "N1"}]}], "]"}], ",", 
            RowBox[{"Min", "[", 
             RowBox[{
              RowBox[{"mN2", "+", "1"}], ",", "N1"}], "]"}]}], "}"}]}], "]"}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Mod", "[", 
            RowBox[{"m", ",", "100"}], "]"}], "==", "0"}], ",", 
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<row \>\"", ",", "m", ",", "\"\</\>\"", ",", "Nlevels"}], 
           "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"N2", ",", "0", ",", "Nmax"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"mN2", ",", 
         RowBox[{"-", "N2"}], ",", "N2"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"mIRb2", ",", 
         RowBox[{"-", 
          SubscriptBox["i", "Rb"]}], ",", " ", 
         SubscriptBox["i", "Rb"]}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"mICs2", ",", 
         RowBox[{"-", 
          SubscriptBox["i", "Cs"]}], ",", " ", 
         SubscriptBox["i", "Cs"]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"SetDirectory", "[", 
      StyleBox["libPath", "SearchResultSummary"], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"H", ">>", 
        RowBox[{"\"\<Starkmatrix\>\"", "<>", 
         RowBox[{"ToString", "[", "field", "]"}], "<>", "\"\<.nb\>\""}]}], 
       ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"H", ">>", "\"\<StarkmatrixNmax2.nb\>\""}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
        RowBox[{",", " ", 
         RowBox[{"{", 
          RowBox[{"field", ",", " ", "fmin", ",", " ", "fmax", ",", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"fmax", "-", "fmin"}], ")"}], "/", 
            RowBox[{"(", 
             RowBox[{"NF", "-", "1"}], ")"}]}]}], "}"}]}], "]"}], ";"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Quit", "[", "]"}]}], "\[IndentingNewLine]", "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"generate", " ", "Zeeman", " ", "matrix"}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"HZeeman", "[", 
       RowBox[{
       "mIRb1_", ",", "mICs1_", ",", "N1_", ",", "mN1_", ",", "mIRb2_", ",", 
        "mICs2_", ",", "N2_", ",", "mN2_", ",", "Bz_"}], "]"}], ":=", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"nuc", " ", "Zeeman", " ", "diag", " ", "in", " ", "all"}], 
       " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"KroneckerDelta", "[", 
         RowBox[{"mIRb1", ",", "mIRb2"}], "]"}]}], " ", "*", " ", 
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"mICs1", ",", "mICs2"}], "]"}], "*", 
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"N1", ",", "N2"}], "]"}], " ", "*", " ", 
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"mN1", ",", "mN2"}], "]"}], "*", "\[IndentingNewLine]", 
       RowBox[{"(", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubscriptBox["g", 
             RowBox[{"i", ",", "Rb"}]], 
            RowBox[{"(", 
             RowBox[{"1", "-", "\[Sigma]Rb"}], ")"}], "mIRb1"}], "+", 
           RowBox[{
            SubscriptBox["g", 
             RowBox[{"i", ",", "Cs"}]], " ", 
            RowBox[{"(", 
             RowBox[{"1", "-", "\[Sigma]Cs"}], ")"}], "mICs1"}], "+", 
           RowBox[{
            SubscriptBox["g", "r"], "mN1"}]}], ")"}], " ", 
         SubscriptBox["\[Mu]", "Nuc"], " ", "Bz"}], " ", 
        "\[IndentingNewLine]", ")"}]}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"Nmax", "=", "2"}], ";", " ", 
     RowBox[{"(*", " ", 
      RowBox[{
      "highest", " ", "rotational", " ", "level", " ", "in", " ", "basis", 
       " ", "set"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<Number of levels = \>\"", ",", 
       RowBox[{"Nlevels", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"Nmax", "+", "1"}], ")"}], "^", "2"}], "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", "  ", 
            SubscriptBox["i", "Rb"]}], "+", "1"}], ")"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", "*", 
            SubscriptBox["i", "Cs"]}], "+", "1"}], ")"}]}]}]}], "]"}], ";", 
     RowBox[{"(*", " ", 
      RowBox[{"number", " ", "of", " ", "levels"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"H", "=", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"Nlevels", ",", "Nlevels"}], "}"}]}], "]"}]}], ";", "\n", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"m", " ", "=", 
         RowBox[{"1", "+", 
          RowBox[{"(", 
           RowBox[{"mICs2", "-", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "7"}], "/", "2"}], ")"}]}], ")"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"mIRb2", "-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "3"}], "/", "2"}], ")"}]}], ")"}], "*", "8"}], 
          "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"mN2", "-", 
             RowBox[{"(", 
              RowBox[{"-", "N2"}], ")"}]}], ")"}], "*", "32"}], "+", 
          RowBox[{"32", "*", 
           RowBox[{"N2", "^", "2"}]}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"H", "[", 
          RowBox[{"[", 
           RowBox[{"m", ",", "m"}], "]"}], "]"}], "=", 
         RowBox[{"HZeeman", "[", 
          RowBox[{
          "mIRb2", ",", "mICs2", ",", "N2", ",", "mN2", ",", "mIRb2", ",", 
           "mICs2", ",", "N2", ",", "mN2", ",", "1"}], "]"}]}], ";"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"N2", ",", "0", ",", "Nmax"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"mN2", ",", 
         RowBox[{"-", "N2"}], ",", "N2"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"mIRb2", ",", 
         RowBox[{"-", 
          SubscriptBox["i", "Rb"]}], ",", " ", 
         SubscriptBox["i", "Rb"]}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"mICs2", ",", 
         RowBox[{"-", 
          SubscriptBox["i", "Cs"]}], ",", " ", 
         SubscriptBox["i", "Cs"]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"SetDirectory", "[", "libPath", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"H", ">>", "\"\<ZeemanmatrixNmax2.nb\>\""}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "\"\<done!\>\"", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Quit", "[", "]"}]}], "\[IndentingNewLine]", "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", 
     "**"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"single", " ", "field", " ", "calculations"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", 
     "**"}], " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Nmax", "=", "2"}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "Highest", " ", "N", " ", "rotational", " ", "quantum", " ", "number", 
      " ", "in", " ", "basis", " ", 
      RowBox[{"set", ".", "  ", "Ground"}], " ", "state", " ", "has", " ", 
      "N"}], "=", "0."}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"field", "=", "305"}], ";"}], "  ", 
   RowBox[{"(*", " ", 
    RowBox[{"magnetic", " ", "field", " ", "in", " ", "G"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"field", "=", "314"}], ";"}], "  ", 
    RowBox[{"(*", " ", 
     RowBox[{"magnetic", " ", "field", " ", "in", " ", "G"}], " ", "*)"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<Field = \>\"", ",", "field", ",", "\"\< G.\>\""}], "]"}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<Number of levels in basis set = \>\"", ",", 
      RowBox[{"Nlevels", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Nmax", "+", "1"}], ")"}], "^", "2"}], "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", "  ", 
           SubscriptBox["i", "Rb"]}], "+", "1"}], ")"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", "*", 
           SubscriptBox["i", "Cs"]}], "+", "1"}], ")"}]}]}]}], "]"}], ";"}], 
   RowBox[{"(*", " ", 
    RowBox[{"NL", " ", "=", " ", 
     RowBox[{
     "number", " ", "of", " ", "levels", " ", "in", " ", "basis", " ", 
      "set"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Timing", "[", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"!", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"ValueQ", "[", "H0", "]"}], "&&", 
         RowBox[{"ValueQ", "[", "HS", "]"}], "&&", 
         RowBox[{"ValueQ", "[", "HZ", "]"}], "&&", 
         RowBox[{"ValueQ", "[", "hdata", "]"}], "&&", 
         RowBox[{"ValueQ", "[", "vdata", "]"}]}], ")"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Print", "[", "\"\<loading data and matrices...\>\"", "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"SetDirectory", "[", 
        StyleBox["libPath", "SearchResultSummary"], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"H0", "=", 
        RowBox[{"<<", "\"\<fieldfreematrixNmax2.nb\>\""}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"HS", "=", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"Nlevels", ",", "Nlevels"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"HZ", "=", 
        RowBox[{"<<", "\"\<ZeemanmatrixNmax2.nb\>\""}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", "\"\<finished!\>\"", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"SetDirectory", "[", 
        StyleBox["BasePath", "SearchResultSummary"], "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"HS", "=", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"NL", ",", "NL"}], "}"}]}], "]"}]}], ";", " ", 
     RowBox[{"HS", "=", 
      RowBox[{"<<", "\"\<Starkmatrix0.nb\>\""}]}], ";"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Energies", "=", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"0", ",", "Nlevels"}], "]"}]}], ";"}], "  ", 
   RowBox[{"(*", " ", 
    RowBox[{
    "matrix", " ", "containing", " ", "energy", " ", "levels", " ", "for", 
     " ", "each", " ", "field"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"H0", "=", 
     RowBox[{"H0", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"Range", "[", 
         RowBox[{"1", ",", "Nlevels"}], "]"}], ",", 
        RowBox[{"Range", "[", 
         RowBox[{"1", ",", "Nlevels"}], "]"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"HS", "=", 
     RowBox[{"HS", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"Range", "[", 
         RowBox[{"1", ",", "Nlevels"}], "]"}], ",", 
        RowBox[{"Range", "[", 
         RowBox[{"1", ",", "Nlevels"}], "]"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"HZ", "=", 
     RowBox[{"HZ", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"Range", "[", 
         RowBox[{"1", ",", "Nlevels"}], "]"}], ",", 
        RowBox[{"Range", "[", 
         RowBox[{"1", ",", "Nlevels"}], "]"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MatrixForm", "[", 
     RowBox[{"H0", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"Range", "[", 
         RowBox[{"1", ",", "64"}], "]"}], ",", 
        RowBox[{"Range", "[", 
         RowBox[{"1", ",", "64"}], "]"}]}], "]"}], "]"}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MatrixForm", "[", 
     RowBox[{"HS", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"Range", "[", 
         RowBox[{"1", ",", "64"}], "]"}], ",", 
        RowBox[{"Range", "[", 
         RowBox[{"1", ",", "64"}], "]"}]}], "]"}], "]"}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MatrixForm", "[", 
     RowBox[{"HZ", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"Range", "[", 
         RowBox[{"1", ",", "64"}], "]"}], ",", 
        RowBox[{"Range", "[", 
         RowBox[{"1", ",", "64"}], "]"}]}], "]"}], "]"}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"H1", "=", 
     RowBox[{"H0", "+", "HS"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Energies", " ", "=", 
     RowBox[{
      RowBox[{"Sort", "[", 
       RowBox[{
        RowBox[{"Eigenvalues", "[", 
         RowBox[{"H1", "+", 
          RowBox[{"HZ", "*", "field"}]}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"Range", "[", 
          RowBox[{
           RowBox[{"Nlevels", "-", "31"}], ",", "Nlevels"}], "]"}], "]"}], 
        "]"}], "]"}], "/", "h"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"UnorderedEnergies", " ", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Eigenvalues", "[", 
        RowBox[{"H1", "+", 
         RowBox[{"HZ", "*", "field"}]}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"Range", "[", 
         RowBox[{
          RowBox[{"Nlevels", "-", "31"}], ",", "Nlevels"}], "]"}], "]"}], 
       "]"}], "/", "h"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"order", "=", 
     RowBox[{"Ordering", "[", "UnorderedEnergies", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"UnorderedStates", "=", 
     RowBox[{
      RowBox[{"Eigenvectors", "[", 
       RowBox[{"H1", "+", 
        RowBox[{"HZ", "*", "field"}]}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"Range", "[", 
        RowBox[{
         RowBox[{"Nlevels", "-", "31"}], ",", "Nlevels"}], "]"}], "]"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MatrixForm", "[", "UnorderedStates", "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"States", "=", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"0", ",", 
       RowBox[{"{", 
        RowBox[{"32", ",", "32"}], "}"}]}], "]"}]}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
    "state", " ", "vectors", " ", "in", " ", "order", " ", "of", " ", 
     "increasing", " ", "energy"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SigStates", "=", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"0", ",", 
       RowBox[{"{", 
        RowBox[{"32", ",", "4", ",", "8"}], "}"}]}], "]"}]}], ";"}], "  ", 
   RowBox[{"(*", " ", 
    RowBox[{"spin", " ", "state", " ", "matrices", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"rows", " ", "miRb"}], ",", " ", 
       RowBox[{"columns", " ", "miCs"}]}], ")"}], " ", "in", " ", "order", 
     " ", "of", " ", "increasing", " ", "energy"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"States", "[", 
         RowBox[{"[", "m", "]"}], "]"}], "=", 
        RowBox[{
         RowBox[{"UnorderedStates", "[", 
          RowBox[{"[", 
           RowBox[{"order", "[", 
            RowBox[{"[", "m", "]"}], "]"}], "]"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"Range", "[", 
           RowBox[{"1", ",", "32"}], "]"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Abs", "[", 
              RowBox[{
               RowBox[{"States", "[", 
                RowBox[{"[", "m", "]"}], "]"}], "[", 
               RowBox[{"[", "j", "]"}], "]"}], "]"}], ">", "0.000001"}], ",", 
            " ", 
            RowBox[{
             RowBox[{"SigStates", "[", 
              RowBox[{"[", 
               RowBox[{"m", ",", 
                RowBox[{
                 RowBox[{"Quotient", "[", 
                  RowBox[{
                   RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"j", "-", "1"}], ",", "32"}], "]"}], ",", "8"}], 
                  "]"}], "+", "1"}], ",", 
                RowBox[{
                 RowBox[{"Mod", "[", 
                  RowBox[{
                   RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"j", "-", "1"}], ",", "32"}], "]"}], ",", "8"}], 
                  "]"}], "+", "1"}]}], " ", "]"}], "]"}], "=", 
             RowBox[{
              RowBox[{"States", "[", 
               RowBox[{"[", "m", "]"}], "]"}], "[", 
              RowBox[{"[", "j", "]"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"States", "[", 
               RowBox[{"[", "m", "]"}], "]"}], "[", 
              RowBox[{"[", "j", "]"}], "]"}], "=", "0"}]}], "]"}], ";"}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "32"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Energy=\>\"", ",", 
         RowBox[{"ScientificForm", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Energies", "[", 
              RowBox[{"[", "m", "]"}], "]"}], ")"}], "/", 
            RowBox[{"10", "^", "6"}]}], ",", "6"}], "]"}], ",", 
         "\"\< MHz, spin state=\>\"", ",", 
         RowBox[{"MatrixForm", "[", 
          RowBox[{"SigStates", "[", 
           RowBox[{"[", "m", "]"}], "]"}], "]"}]}], "]"}], ";"}], 
      "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "1", ",", "32"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"gsenergy", "=", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"0", ",", "10"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"gsenergy", "[", 
         RowBox[{"[", "m", "]"}], "]"}], "=", 
        RowBox[{
         RowBox[{"Energies", "[", 
          RowBox[{"[", "m", "]"}], "]"}], "/", 
         RowBox[{"10", "^", "6"}]}]}], ";"}], "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "1", ",", "10"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Export", "[", 
     RowBox[{"\"\<groundstate_energy_305G.csv\>\"", ",", "gsenergy"}], "]"}], 
    "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<level 1 to level 10 splitting = \>\"", ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Energies", "[", 
         RowBox[{"[", "10", "]"}], "]"}], "-", 
        RowBox[{"Energies", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "/", 
      RowBox[{"10", "^", "6"}]}], ",", " ", "\"\< MHz\>\""}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"mIRbX", "=", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"0", ",", 
       RowBox[{"{", 
        RowBox[{"32", ",", "32"}], "}"}]}], "]"}]}], " ", ";"}], 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"mIRb", " ", "operator", " ", "for", " ", 
      RowBox[{"J", "''"}]}], "=", 
     RowBox[{"0", " ", "subspace"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"mICsX", "=", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"0", ",", 
       RowBox[{"{", 
        RowBox[{"32", ",", "32"}], "}"}]}], "]"}]}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"mICs", " ", "operator", " ", "for", " ", 
      RowBox[{"J", "''"}]}], "=", 
     RowBox[{"0", " ", "subspace"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"m", " ", "=", 
        RowBox[{"1", "+", 
         RowBox[{"(", 
          RowBox[{"mICs2", "-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "7"}], "/", "2"}], ")"}]}], ")"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"mIRb2", "-", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "3"}], "/", "2"}], ")"}]}], ")"}], "*", "8"}]}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"mIRbX", "[", 
         RowBox[{"[", 
          RowBox[{"m", ",", "m"}], "]"}], "]"}], "=", "mIRb2"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"mICsX", "[", 
         RowBox[{"[", 
          RowBox[{"m", ",", "m"}], "]"}], "]"}], "=", "mICs2"}], ";"}], 
      "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"mIRb2", ",", 
        RowBox[{"-", 
         SubscriptBox["i", "Rb"]}], ",", " ", 
        SubscriptBox["i", "Rb"]}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"mICs2", ",", 
        RowBox[{"-", 
         SubscriptBox["i", "Cs"]}], ",", " ", 
        SubscriptBox["i", "Cs"]}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"mIRbXs", "=", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"0", ",", "32"}], "]"}]}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
    "vector", " ", "with", " ", "mIRb", " ", "expectation", " ", "values"}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"mICsXs", "=", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"0", ",", "32"}], "]"}]}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
    "vector", " ", "with", " ", "mICs", " ", "expectation", " ", "values"}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MXs", "=", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"0", ",", "32"}], "]"}]}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
    "vector", " ", "with", " ", "M", " ", "expectation", " ", "values"}], " ",
     "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"M2Xs", "=", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"0", ",", "32"}], "]"}]}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"vector", " ", "with", " ", "M"}], "=", 
     RowBox[{"2", " ", "character"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"M3Xs", "=", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"0", ",", "32"}], "]"}]}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"vector", " ", "with", " ", "M"}], "=", 
     RowBox[{"3", " ", "character"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"M4Xs", "=", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"0", ",", "32"}], "]"}]}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"vector", " ", "with", " ", "M"}], "=", 
     RowBox[{"4", " ", "character"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"M5Xs", "=", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"0", ",", "32"}], "]"}]}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"vector", " ", "with", " ", "M"}], "=", 
     RowBox[{"5", " ", "character"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"mIRbXs", "[", 
         RowBox[{"[", "m", "]"}], "]"}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"States", "[", 
           RowBox[{"[", "m", "]"}], "]"}], ".", "mIRbX", ".", 
          RowBox[{"States", "[", 
           RowBox[{"[", "m", "]"}], "]"}]}], "/", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"States", "[", 
            RowBox[{"[", "m", "]"}], "]"}], ".", 
           RowBox[{"States", "[", 
            RowBox[{"[", "m", "]"}], "]"}]}], ")"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"mICsXs", "[", 
         RowBox[{"[", "m", "]"}], "]"}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"States", "[", 
           RowBox[{"[", "m", "]"}], "]"}], ".", "mICsX", ".", 
          RowBox[{"States", "[", 
           RowBox[{"[", "m", "]"}], "]"}]}], "/", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"States", "[", 
            RowBox[{"[", "m", "]"}], "]"}], ".", 
           RowBox[{"States", "[", 
            RowBox[{"[", "m", "]"}], "]"}]}], ")"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"mIRbXs", "[", 
            RowBox[{"[", "m", "]"}], "]"}], "+", 
           RowBox[{"mICsXs", "[", 
            RowBox[{"[", "m", "]"}], "]"}]}], "==", "2"}], ",", 
         RowBox[{
          RowBox[{"M2Xs", "[", 
           RowBox[{"[", "m", "]"}], "]"}], "=", "1"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"mIRbXs", "[", 
            RowBox[{"[", "m", "]"}], "]"}], "+", 
           RowBox[{"mICsXs", "[", 
            RowBox[{"[", "m", "]"}], "]"}]}], "==", "3"}], ",", 
         RowBox[{
          RowBox[{"M3Xs", "[", 
           RowBox[{"[", "m", "]"}], "]"}], "=", "1"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"mIRbXs", "[", 
            RowBox[{"[", "m", "]"}], "]"}], "+", 
           RowBox[{"mICsXs", "[", 
            RowBox[{"[", "m", "]"}], "]"}]}], "==", "4"}], ",", 
         RowBox[{
          RowBox[{"M4Xs", "[", 
           RowBox[{"[", "m", "]"}], "]"}], "=", "1"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"mIRbXs", "[", 
            RowBox[{"[", "m", "]"}], "]"}], "+", 
           RowBox[{"mICsXs", "[", 
            RowBox[{"[", "m", "]"}], "]"}]}], "==", "5"}], ",", 
         RowBox[{
          RowBox[{"M5Xs", "[", 
           RowBox[{"[", "m", "]"}], "]"}], "=", "1"}]}], "]"}], ";"}], 
      "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "1", ",", "32"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MXs", "=", 
     RowBox[{"mIRbXs", "+", "mICsXs"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SetDirectory", "[", 
     StyleBox["libPath", "SearchResultSummary"], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"excitedspinstate2", "=", 
     RowBox[{"<<", "\"\<stirap2_down_state_vector_305G.nb\>\""}]}], ";"}], 
   "  ", 
   RowBox[{"(*", " ", 
    RowBox[{
    "3", "x32", " ", "matrix", " ", "with", " ", "spin", " ", "states", " ", 
     "for", " ", "each", " ", "mJ", " ", "component", " ", "of", " ", 
     "STIRAP2", " ", "excited", " ", "state", " ", "at", " ", "305", "G"}], 
    " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"Print", "[", 
    RowBox[{
    "\"\<Excited mJ (row) nuc-spin (columns) STIRAP3 state (M'=4, mostly \
mJ'=+1 |1/2 5/2>) state \>\"", ",", 
     RowBox[{"MatrixForm", "[", "excitedspinstate2", "]"}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<XStates (each row is a state, in spin basis) \>\"", ",", " ", 
     RowBox[{"MatrixForm", "[", "States", "]"}]}], "]"}], "  ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "matrix", " ", "containing", " ", "all", " ", "ground", " ", "states"}], 
     ",", " ", 
     RowBox[{"in", " ", "spin", " ", "basis"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<XStates*M5Xs (each row is a state, in spin basis) \>\"", ",", 
     RowBox[{"MatrixForm", "[", 
      RowBox[{"States", "*", "M5Xs"}], "]"}]}], "]"}], "  ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"matrix", " ", "containing", " ", "M"}], "=", 
      RowBox[{"5", "  ", "ground", " ", "states"}]}], ",", " ", 
     RowBox[{"in", " ", "spin", " ", "basis"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<XStates*M4Xs (each row is a state, in spin basis) \>\"", ",", 
     RowBox[{"MatrixForm", "[", 
      RowBox[{"States", "*", "M4Xs"}], "]"}]}], "]"}], "  ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"matrix", " ", "containing", " ", "M"}], "=", 
      RowBox[{"4", "  ", "ground", " ", "states"}]}], ",", " ", 
     RowBox[{"in", " ", "spin", " ", "basis"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<XStates*M3Xs (each row is a state, in spin basis) \>\"", ",", 
     RowBox[{"MatrixForm", "[", 
      RowBox[{"States", "*", "M3Xs"}], "]"}]}], "]"}], "  ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"matrix", " ", "containing", " ", "M"}], "=", 
      RowBox[{"3", "  ", "ground", " ", "states"}]}], ",", " ", 
     RowBox[{"in", " ", "spin", " ", "basis"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"Print", "[", 
    RowBox[{
    "\"\<XStates*M5Xs.(excitedspinstate2[[1]]+excitedspinstate2[[2]]+\
excitedspinstate2[[3]]) spin overlap for STIRAP2 sigma+ transitions \>\"", 
     ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"States", "*", "M5Xs"}], ")"}], ".", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"excitedspinstate2", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "+", 
        RowBox[{"excitedspinstate2", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "+", 
        RowBox[{"excitedspinstate2", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}], ")"}]}]}], "  ", "]"}], "  ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
      "spin", " ", "overlap", " ", "of", " ", "STIRAP2", " ", "excited", " ", 
       "state", " ", "with", " ", "J"}], "=", "0"}], ",", " ", 
     RowBox[{"M", "=", 
      RowBox[{
       RowBox[{"5", " ", "ground", " ", 
        RowBox[{"states", " ", "--"}]}], "-", " ", "sigma", "+", " ", 
       "transition"}]}]}], " ", "*)"}], "  ", 
   RowBox[{"(*", " ", 
    RowBox[{
    "This", " ", "works", " ", "because", " ", "all", " ", "rot", " ", 
     "elements", " ", "are", " ", 
     RowBox[{"equal", ".", "  ", "See"}], " ", 
     RowBox[{"below", "."}]}], "  ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Print", "[", 
    RowBox[{
    "\"\<XStates*M4Xs.(excitedspinstate2[[1]]+excitedspinstate2[[2]]+\
excitedspinstate2[[3]]) spin overlap for STIRAP3 pi transitions \>\"", ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"States", "*", "M4Xs"}], ")"}], ".", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"excitedspinstate2", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "+", 
        RowBox[{"excitedspinstate2", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "+", 
        RowBox[{"excitedspinstate2", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}], ")"}]}]}], " ", "]"}], "  ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
      "spin", " ", "overlap", " ", "of", " ", "STIRAP2", " ", "excited", " ", 
       "state", " ", "with", " ", "J"}], "=", "0"}], ",", " ", 
     RowBox[{"M", "=", 
      RowBox[{
       RowBox[{"4", " ", "ground", " ", 
        RowBox[{"states", " ", "--"}]}], "-", " ", 
       RowBox[{"pi", " ", "transition"}]}]}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Print", "[", 
    RowBox[{
    "\"\<XStates*M3Xs.(excitedspinstate2[[1]]+excitedspinstate2[[2]]+\
excitedspinstate2[[3]]) spin overlap for STIRAP3 sigma- transitions \>\"", 
     ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"States", "*", "M3Xs"}], ")"}], ".", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"excitedspinstate2", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "+", 
        RowBox[{"excitedspinstate2", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "+", 
        RowBox[{"excitedspinstate2", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}], ")"}]}]}], " ", "]"}], "   ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
      "spin", " ", "overlap", " ", "of", " ", "STIRAP2", " ", "excited", " ", 
       "state", " ", "with", " ", "J"}], "=", "0"}], ",", " ", 
     RowBox[{"M", "=", 
      RowBox[{
       RowBox[{"3", " ", "ground", " ", 
        RowBox[{"states", " ", "--"}]}], "-", " ", "sigma", "-", " ", 
       "transition"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["\[Phi]", "rot"], "=", 
     RowBox[{"Sqrt", "[", 
      RowBox[{"2", "/", "3"}], "]"}]}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{"the", " ", "rotational", " ", "part", " ", 
     RowBox[{"from", " ", "'"}], 
     RowBox[{"lib", "/", "Rotational_part"}], "_of", "_E1", "_TDM", 
     RowBox[{"_GS", ".", 
      RowBox[{"nb", "'"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"uvmixingD", "=", 
     RowBox[{"-", "0.003975"}]}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{"ground", "-", 
     RowBox[{"state", " ", "elec"}], "-", 
     RowBox[{"vib", " ", "moment", " ", "calculated", " ", 
      RowBox[{"from", " ", "'"}], 
      RowBox[{"lib", "/", "Elec_vib"}], "_moment", "_", "305", 
      RowBox[{"G", ".", 
       RowBox[{"nb", "'"}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<STIRAP2 E1 moment for vh\>\"", ",", 
     RowBox[{"\[Omega]XE1h", "=", 
      RowBox[{"Abs", "[", 
       RowBox[{
        SubscriptBox["\[Phi]", "rot"], "*", "uvmixingD", "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"States", "*", "M5Xs"}], ")"}], ".", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"excitedspinstate2", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "+", 
             RowBox[{"excitedspinstate2", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "+", 
             RowBox[{"excitedspinstate2", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"States", "*", "M3Xs"}], ")"}], ".", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"excitedspinstate2", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "+", 
             RowBox[{"excitedspinstate2", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "+", 
             RowBox[{"excitedspinstate2", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], ")"}]}]}], ")"}]}], "]"}]}]}],
     "]"}], "  ", 
   RowBox[{"(*", " ", 
    RowBox[{"TDMs", " ", "for", " ", "perp", " ", "pol", " ", "Stokes"}], " ",
     "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<STIRAP2 E1 moment for vv\>\"", ",", 
     RowBox[{"\[Omega]XE1v", "=", 
      RowBox[{"Abs", "[", 
       RowBox[{
        SubscriptBox["\[Phi]", "rot"], "*", "uvmixingD", "*", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"States", "*", "M4Xs"}], ")"}], ".", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"excitedspinstate2", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "+", 
           RowBox[{"excitedspinstate2", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "+", 
           RowBox[{"excitedspinstate2", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}], ")"}]}]}], "]"}]}]}], "]"}], 
   " ", 
   RowBox[{"(*", " ", 
    RowBox[{"TDMs", " ", "for", " ", "para", " ", "pol", " ", "Stokes"}], " ",
     "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SetDirectory", "[", 
     StyleBox["outputPath", "SearchResultSummary"], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"field", "\[Equal]", "305"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ns", "=", "10"}], ";", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Considering", " ", "transition", " ", "upto", " ", "lowest", " ", 
         "10", " ", "energy", " ", "state"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"PlotXEnergy", "=", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"ns", ",", "2"}], "}"}]}], "]"}]}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{"all", " ", "lines"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"PlotXhE1", "=", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"ns", ",", "2"}], "}"}]}], "]"}]}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{"hpol", " ", "Rabi", " ", "spectrum"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"PlotXvE1", "=", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"ns", ",", "2"}], "}"}]}], "]"}]}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{"vpol", " ", "Rabi", " ", "spectrum"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"graphoffset", "=", 
        RowBox[{
         RowBox[{"Energies", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "/", 
         RowBox[{"10", "^", "6"}]}]}], ";", "  ", 
       RowBox[{"(*", " ", 
        RowBox[{
        "calculated", " ", "lines", " ", "offset", " ", "in", " ", "MHz"}], 
        " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"PlotXhE1", "[", 
             RowBox[{"[", "m", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "=", 
           RowBox[{
            RowBox[{
             RowBox[{"Energies", "[", 
              RowBox[{"[", "m", "]"}], "]"}], "/", 
             RowBox[{"10", "^", "6"}]}], "-", "graphoffset"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"PlotXvE1", "[", 
             RowBox[{"[", "m", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "=", 
           RowBox[{
            RowBox[{
             RowBox[{"Energies", "[", 
              RowBox[{"[", "m", "]"}], "]"}], "/", 
             RowBox[{"10", "^", "6"}]}], "-", "graphoffset"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"PlotXEnergy", "[", 
             RowBox[{"[", "m", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "=", 
           RowBox[{
            RowBox[{
             RowBox[{"Energies", "[", 
              RowBox[{"[", "m", "]"}], "]"}], "/", 
             RowBox[{"10", "^", "6"}]}], "-", "graphoffset"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"PlotXhE1", "[", 
             RowBox[{"[", "m", "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], "=", 
           RowBox[{
            RowBox[{"\[Omega]XE1h", "[", 
             RowBox[{"[", "m", "]"}], "]"}], "*", 
            RowBox[{"10", "^", "4"}]}]}], ";", " ", 
          RowBox[{"(*", 
           RowBox[{"*", " ", "in", " ", 
            RowBox[{"10", "^", 
             RowBox[{"-", "4"}]}], " ", "ea_", "0"}], " ", "**)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"PlotXvE1", "[", 
             RowBox[{"[", "m", "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], "=", 
           RowBox[{
            RowBox[{"\[Omega]XE1v", "[", 
             RowBox[{"[", "m", "]"}], "]"}], "*", 
            RowBox[{"10", "^", "4"}]}]}], ";", 
          RowBox[{"(*", 
           RowBox[{"*", " ", "in", " ", 
            RowBox[{"10", "^", 
             RowBox[{"-", "4"}]}], " ", "ea_", "0"}], " ", "**)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"PlotXEnergy", "[", 
             RowBox[{"[", "m", "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], "=", "1"}], ";"}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"m", ",", "1", ",", "ns"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"yoffset", "=", "0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"SetOptions", "[", 
        RowBox[{"ListPlot", ",", 
         RowBox[{"ImageSize", " ", "->", " ", 
          RowBox[{"{", 
           RowBox[{"700", ",", " ", "550"}], "}"}]}], ",", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", ".1"}], ",", "1.0"}], "}"}], ",", "Automatic"}], 
           "}"}]}], ",", 
         RowBox[{"Ticks", "\[Rule]", "Automatic"}], ",", 
         RowBox[{"AxesOrigin", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "0.1"}], ",", "Automatic"}], "}"}]}], " ", ",", 
         RowBox[{"Axes", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"True", ",", "True"}], "}"}]}], ",", 
         RowBox[{"FrameTicksStyle", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"24", ",", "24"}], "}"}]}], ",", " ", 
         RowBox[{"ImagePadding", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"100", ",", "100"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"100", ",", "100"}], "}"}]}], "}"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"p1", "=", 
        RowBox[{"ListPlot", "[", 
         RowBox[{"PlotXhE1", ",", 
          RowBox[{"Filling", "\[Rule]", "Axis"}], ",", 
          RowBox[{"PlotStyle", "\[Rule]", "Red"}], ",", 
          RowBox[{"FillingStyle", "\[Rule]", "Red"}], ",", 
          RowBox[{"Frame", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"True", ",", "True", ",", "True", ",", "True"}], "}"}]}], 
          ",", 
          RowBox[{"FrameTicks", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"All", ",", "None"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"All", ",", "None"}], "}"}]}], "}"}]}], ",", 
          RowBox[{"FrameStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
            "Automatic", ",", "Red", ",", "Automatic", ",", "Automatic"}], 
            "}"}]}], ",", 
          RowBox[{"PlotRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", ".1"}], ",", "1.0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "30"}], "}"}]}], "}"}]}], ",", " ", 
          RowBox[{"FrameLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Style", "[", 
                RowBox[{
                "\"\<TDM ( x 10^-4 ea0)\>\"", ",", "Bold", ",", "26"}], "]"}],
                ",", "\"\<\>\""}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"\"\<\>\"", ",", 
               RowBox[{"Style", "[", 
                RowBox[{
                "\"\<\!\(\*SuperscriptBox[\(\[InvisiblePrefixScriptBase]\), \
\(87\)]\)RbCs \[InvisiblePrefixScriptBase]\!\(\*SuperscriptBox[\(X\), \
\(1\)]\)\!\(\*SuperscriptBox[\(\[CapitalSigma]\), \(+\)]\) v''=0 J''=0 305G \
vh-pol \>\"", ",", "Bold", ",", "26"}], "]"}]}], "}"}]}], "}"}]}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"p2", "=", 
        RowBox[{"ListPlot", "[", 
         RowBox[{"PlotXvE1", ",", 
          RowBox[{"Filling", "\[Rule]", "Axis"}], ",", 
          RowBox[{"PlotStyle", "\[Rule]", "Green"}], ",", 
          RowBox[{"FillingStyle", "\[Rule]", "Green"}], ",", 
          RowBox[{"Frame", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"True", ",", "True", ",", "True", ",", "True"}], "}"}]}], 
          ",", 
          RowBox[{"FrameTicks", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"All", ",", "None"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"All", ",", "None"}], "}"}]}], "}"}]}], ",", 
          RowBox[{"FrameStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
            "Automatic", ",", "Green", ",", "Automatic", ",", "Automatic"}], 
            "}"}]}], ",", 
          RowBox[{"PlotRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", ".1"}], ",", "1.0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "30"}], "}"}]}], "}"}]}], ",", " ", 
          RowBox[{"FrameLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Style", "[", 
                RowBox[{
                "\"\<TDM ( x 10^-4 ea0)\>\"", ",", "Bold", ",", "26"}], "]"}],
                ",", "\"\<\>\""}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"\"\<\>\"", ",", 
               RowBox[{"Style", "[", 
                RowBox[{
                "\"\<\!\(\*SuperscriptBox[\(\[InvisiblePrefixScriptBase]\), \
\(87\)]\)RbCs \[InvisiblePrefixScriptBase]\!\(\*SuperscriptBox[\(X\), \
\(1\)]\)\!\(\*SuperscriptBox[\(\[CapitalSigma]\), \(+\)]\) v''=0 J''=0 305G \
vv-pol\>\"", ",", "Bold", ",", "26"}], "]"}]}], "}"}]}], "}"}]}]}], "]"}]}], 
       ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"Show", "[", "p1", "]"}], "\[IndentingNewLine]", 
   RowBox[{"Show", "[", "p2", "]"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"Export", "[", 
    RowBox[{"\"\<TDM_vh_305G_Stokes.csv\>\"", ",", "PlotXhE1"}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Export", "[", 
    RowBox[{"\"\<TDM_vv_305G_Stokes.csv\>\"", ",", "PlotXvE1"}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"NotebookSave", "[", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Quit", "[", "]"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.8705106823145604`*^9, 3.8705106989579163`*^9}, 
   3.8705111139145*^9, {3.8705111786608562`*^9, 3.870511255450698*^9}, {
   3.8705148025123014`*^9, 3.870514804622804*^9}, {3.8705148970171547`*^9, 
   3.8705149679298077`*^9}, {3.870515018906948*^9, 3.8705151736807194`*^9}, {
   3.8705152279430656`*^9, 3.870515273974344*^9}, 3.870515366083853*^9, {
   3.8705155661531754`*^9, 3.870515588088193*^9}, {3.870515762475386*^9, 
   3.8705157632877293`*^9}, {3.870516037916381*^9, 3.8705160506137915`*^9}, {
   3.8705162575407147`*^9, 3.870516265135002*^9}, {3.8709290808572645`*^9, 
   3.870929083450732*^9}, {3.870929113505889*^9, 3.870929116353879*^9}, {
   3.8709293402048454`*^9, 3.870929400728337*^9}, 3.8709295761256323`*^9, {
   3.8709297503653555`*^9, 3.870929769905547*^9}, {3.8709302621566963`*^9, 
   3.8709302760044656`*^9}, {3.870930320664864*^9, 3.8709304954001703`*^9}, {
   3.870931145514799*^9, 3.87093120659927*^9}, {3.8709314678939247`*^9, 
   3.870931468110197*^9}, {3.870931681909829*^9, 3.870931708821127*^9}, {
   3.8709317413244286`*^9, 3.870931741567087*^9}, {3.8709318318073654`*^9, 
   3.870931860295926*^9}, {3.8709320249167843`*^9, 3.8709320282975445`*^9}, 
   3.870932433453094*^9, {3.870932587347542*^9, 3.870932596550042*^9}, {
   3.870932703784641*^9, 3.870932707049594*^9}, {3.8709327668806753`*^9, 
   3.8709328209118185`*^9}, {3.870933003820838*^9, 3.8709330413617306`*^9}, {
   3.870933077118432*^9, 3.8709331668707957`*^9}, {3.8709332648685246`*^9, 
   3.8709333477491517`*^9}, 3.870933485294163*^9, {3.8709337342551126`*^9, 
   3.870933746805048*^9}, {3.8709337911825123`*^9, 3.870933811804056*^9}, {
   3.8709338562481184`*^9, 3.8709339180555754`*^9}, 3.870934118873764*^9, {
   3.870934837187893*^9, 3.8709348426278124`*^9}, 3.870935150460209*^9, {
   3.870937498872613*^9, 3.8709375053013334`*^9}, {3.870937556940441*^9, 
   3.870937559786424*^9}, {3.870937590591866*^9, 3.8709375914952097`*^9}, 
   3.8709379520439415`*^9, {3.8709382905399623`*^9, 3.870938294469285*^9}, {
   3.871115205850418*^9, 3.871115216540025*^9}, {3.8711153434327583`*^9, 
   3.8711154569832044`*^9}, {3.8711159137608957`*^9, 3.871115914323264*^9}, {
   3.8711388364781866`*^9, 3.8711388426597414`*^9}, {3.8711425802899914`*^9, 
   3.8711425903070345`*^9}, {3.8711427801735506`*^9, 3.871142866005243*^9}, {
   3.8711429094763136`*^9, 3.871143036489319*^9}, {3.8711431228521137`*^9, 
   3.8711433015459003`*^9}, {3.871143399857803*^9, 3.871143418098217*^9}, {
   3.871143496486483*^9, 3.8711435225390368`*^9}, {3.871143663425996*^9, 
   3.871143697392471*^9}, 3.8711437860246105`*^9, {3.8711438605193567`*^9, 
   3.8711439623996267`*^9}, {3.8711440546324434`*^9, 
   3.8711440806191287`*^9}, {3.8711442486280107`*^9, 
   3.8711442595236244`*^9}, {3.871439955383347*^9, 3.871440006413169*^9}, {
   3.8714400551976213`*^9, 3.8714400767312737`*^9}, {3.8714586193700294`*^9, 
   3.871458627111759*^9}, {3.876369227697382*^9, 3.8763692503738594`*^9}, {
   3.876472158393323*^9, 3.876472188792179*^9}, {3.8764722356342106`*^9, 
   3.8764723407858987`*^9}, {3.8764723916294923`*^9, 3.876472409362612*^9}, 
   3.87647257212991*^9, {3.8764726041616645`*^9, 3.8764726495817995`*^9}, {
   3.8764728225842824`*^9, 3.876472880115553*^9}, {3.876472959411112*^9, 
   3.8764730134727077`*^9}, {3.876473182741073*^9, 3.8764732199100885`*^9}, {
   3.876473331440055*^9, 3.8764734510105515`*^9}, {3.8764735686042957`*^9, 
   3.8764736498083925`*^9}, {3.8764742594923077`*^9, 
   3.8764742849624815`*^9}, {3.8764743363527412`*^9, 3.87647435222957*^9}, {
   3.8775072838168836`*^9, 3.8775073133175497`*^9}, {3.8775073442189245`*^9, 
   3.877507353830655*^9}, {3.8775079983476276`*^9, 3.877508131182732*^9}, {
   3.877508217136463*^9, 3.8775082223167996`*^9}, 3.877512274259432*^9, {
   3.877683433605953*^9, 3.877683458678177*^9}, {3.877683495700754*^9, 
   3.8776834958257303`*^9}, 3.8776835273771152`*^9, 3.877683557698092*^9, 
   3.8776838768506126`*^9, {3.877683921558858*^9, 3.8776839293070483`*^9}, {
   3.877684069530013*^9, 3.877684117565626*^9}, {3.8777663874944572`*^9, 
   3.8777664331091404`*^9}, {3.8781985265558004`*^9, 3.878198536800106*^9}, {
   3.8789882510935764`*^9, 3.878988253325284*^9}, {3.878988302895945*^9, 
   3.8789883164468956`*^9}, {3.878988375147209*^9, 3.878988416939107*^9}, {
   3.878988898187974*^9, 3.878988931431535*^9}, {3.878988989257063*^9, 
   3.878988994661078*^9}, {3.884087086959981*^9, 3.8840870911523275`*^9}, {
   3.8847800203899007`*^9, 3.884780027129955*^9}, {3.884780287946352*^9, 
   3.884780299015362*^9}, 3.884936147747841*^9, {3.8849362862389727`*^9, 
   3.884936288854941*^9}, 3.8849382218999825`*^9, {3.8862392933248053`*^9, 
   3.8862393019662666`*^9}, {3.8862394051532826`*^9, 
   3.8862394603113327`*^9}, {3.886239494777465*^9, 3.8862394952839403`*^9}, {
   3.8862395462071295`*^9, 3.8862395823175354`*^9}, {3.8862397022737846`*^9, 
   3.8862398527796507`*^9}, {3.8862402170861397`*^9, 
   3.8862402764628215`*^9}, {3.8862404758865643`*^9, 3.886240503145917*^9}, {
   3.8862406538082867`*^9, 3.8862407135053763`*^9}, {3.8862407535803967`*^9, 
   3.886240861781022*^9}, {3.8862410631239667`*^9, 3.886241069480061*^9}, 
   3.88726765748438*^9, 3.887267751677579*^9, {3.8872679733467846`*^9, 
   3.88726803810929*^9}, {3.90408934625288*^9, 3.904089351483412*^9}, {
   3.904089385908493*^9, 3.904089391046248*^9}, {3.904089477432457*^9, 
   3.9040894836613417`*^9}, {3.90420409164384*^9, 3.904204188142837*^9}, 
   3.904285404322475*^9, {3.9042871667807503`*^9, 3.904287201875204*^9}, {
   3.904287356409614*^9, 3.904287384128086*^9}, {3.904287527126876*^9, 
   3.9042875963740263`*^9}, {3.9042876522848063`*^9, 3.904287790636602*^9}, {
   3.904287830071412*^9, 3.904288095150969*^9}, {3.9042881777647867`*^9, 
   3.904288335280692*^9}, {3.904288378212634*^9, 3.9042884398560953`*^9}, {
   3.904288534771048*^9, 3.904288535762967*^9}, {3.9042885791866627`*^9, 
   3.904288598805171*^9}, {3.9042886568169527`*^9, 3.904288657288293*^9}, {
   3.904288720790255*^9, 3.904288733358266*^9}, {3.904288817619225*^9, 
   3.904288893950068*^9}, {3.9042889253554993`*^9, 3.904288962613625*^9}, {
   3.904289115707115*^9, 3.9042891231961603`*^9}, {3.904613932063223*^9, 
   3.904614000812036*^9}, {3.904614055664584*^9, 3.904614058919737*^9}, {
   3.9046141719235*^9, 3.9046141764905043`*^9}, {3.9046145816309843`*^9, 
   3.904614584983767*^9}, {3.904615129069296*^9, 3.904615167558399*^9}, {
   3.904615708562623*^9, 3.904615720982229*^9}, {3.904867175863853*^9, 
   3.9048671766694307`*^9}, {3.904867208462274*^9, 3.904867221795562*^9}, {
   3.904870612589493*^9, 3.904870667158379*^9}, {3.904870705327263*^9, 
   3.90487072508055*^9}, {3.9048708526976223`*^9, 3.904870859428143*^9}, {
   3.904953196513465*^9, 3.904953203430544*^9}, {3.904956690608283*^9, 
   3.904956691554521*^9}, {3.90495672894827*^9, 3.904956730002139*^9}, {
   3.904962521323794*^9, 3.904962545797435*^9}, {3.904965807279839*^9, 
   3.904965807807646*^9}, {3.9049682180242853`*^9, 3.9049682380664473`*^9}, 
   3.9053004587623453`*^9, 3.905328709755629*^9},
 Background->RGBColor[
  1, 0.925, 0.925],ExpressionUUID->"77c04f66-8e66-432c-8a76-95ead179ace1"]
}, Open  ]]
},
WindowSize->{1440, 788},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
TaggingRules-><|"TryRealOnly" -> False|>,
FrontEndVersion->"13.2 for Mac OS X ARM (64-bit) (January 30, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"b5a8e766-2b29-43f2-99c8-dfbf8806b873"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 5528, 77, 71, "Section",ExpressionUUID->"98aea7be-657c-4623-9520-6a1320fad11a"],
Cell[6111, 101, 155914, 4191, 8347, "Input",ExpressionUUID->"75106907-4c48-48ac-aa41-698a2f07545c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[162062, 4297, 7306, 100, 71, "Section",ExpressionUUID->"2a2f050d-2938-4c24-8426-bf085afe3bad"],
Cell[169371, 4399, 158374, 4237, 8368, "Input",ExpressionUUID->"77c04f66-8e66-432c-8a76-95ead179ace1"]
}, Open  ]]
}
]
*)

